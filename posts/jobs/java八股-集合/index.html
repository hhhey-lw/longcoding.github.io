<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>LongWei Blog</title>
<meta name="keywords" content="">
<meta name="description" content="6319 HashMap åŸç†
æ•°æ®ç»“æ„ï¼šæ•°ç»„ &#43; é“¾è¡¨  ï¼ˆJAVA8ä¹‹åï¼šæ•°ç»„&#43;é“¾è¡¨&#43;çº¢é»‘æ ‘ï¼‰


æ•°æ®ç»“æ„

jdk1.7ï¼šæ•°ç»„&#43;é“¾è¡¨ï¼Œæ•°ç»„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªé“¾è¡¨çš„è¡¨å¤´ï¼Œå½“å‘ç”Ÿå†²çªï¼Œå°†æ–°å…ƒç´ æ·»åŠ åœ¨å¤´éƒ¨(å¤´æ’æ³•)

hashå†²çªï¼šå¤´æ’æ³•ï¼Œâ—æ‰©å®¹æ—¶å¯èƒ½é€ æˆç¯å½¢é“¾è¡¨


jdk1.8ï¼š

å¼•å…¥çº¢é»‘æ ‘ï¼Œå½“é“¾è¡¨èŠ‚ç‚¹è¶…è¿‡8ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªé“¾è¡¨ä¼šè½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚æŸ¥è¯¢æ—¶é—´ç”± O(n) ä¼˜åŒ–ä¸º O(logn)ã€‚å½“èŠ‚ç‚¹å°äº6ä¸ªï¼Œå†è½¬æ¢ä¸ºé“¾è¡¨ã€‚
hashå†²çªï¼šå°¾æ’æ³•ï¼Œé¿å…ç¯å½¢é“¾è¡¨â—


æ‰©å®¹æœºåˆ¶

jdk1.7

æ‰©å®¹ï¼Œå…ƒç´ ä¼šé‡æ–°è®¡ç®—hashå€¼ï¼Œå¹¶åˆ†é…åˆ°æ–°çš„æ‰©å®¹æ•°ç»„ä¸­ã€‚â­æ¯”è¾ƒè€—æ—¶
æ‰©å®¹æ—¶ï¼Œå¤´æ’æ³•ï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå¯èƒ½é€ æˆç¯å½¢é“¾è¡¨


jdk1.8

æ‰©å®¹æ—¶ï¼Œåˆ©ç”¨äº†å…ƒç´ å“ˆå¸Œå€¼å’Œæ—§æ•°ç»„å®¹é‡å…³ç³»ï¼Œå‡å°‘äº†é‡æ–°è®¡ç®—çš„å“ˆå¸Œæ¬¡æ•°
æ‰©å®¹æ—¶ï¼Œå°¾æ’æ³•ï¼Œé¿å…ç¯å½¢é“¾è¡¨







ä½¿ç”¨é”®çš„hashcode()è®¡ç®—hashå€¼ï¼Œç„¶å(n-1) &amp; hashç¡®å®šæ•°ç»„ä¸­çš„ä½ç½®ã€‚">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/jobs/java%E5%85%AB%E8%82%A1-%E9%9B%86%E5%90%88/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.488b476fe12f895e41e7473bc23e9831609c74c2bdb368da996800ef083721e1.css" integrity="sha256-SItHb&#43;EviV5B50c7wj6YMWCcdMK9s2jamWgA7wg3IeE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/jobs/java%E5%85%AB%E8%82%A1-%E9%9B%86%E5%90%88/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
 <script type="text/javascript"
         async
         src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
 MathJax.Hub.Config({
   tex2jax: {
     inlineMath: [['$','$'], ['\\(','\\)']],
     displayMath: [['$$','$$'], ['\[\[','\]\]']],
     processEscapes: true,
     processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="LongWei Blog (Alt + H)">LongWei Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="LongWei Blog">
                    <span>é¦–é¡µ</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="æœç´¢">
                    <span>æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">

</div>
  </header> 
  <div class="post-content"><h3 id="6319-hashmap-åŸç†">6319 HashMap åŸç†<a hidden class="anchor" aria-hidden="true" href="#6319-hashmap-åŸç†">#</a></h3>
<p>æ•°æ®ç»“æ„ï¼šæ•°ç»„ + é“¾è¡¨  ï¼ˆJAVA8ä¹‹åï¼šæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼‰</p>
<ul>
<li>
<p>æ•°æ®ç»“æ„</p>
<ul>
<li>jdk1.7ï¼šæ•°ç»„+é“¾è¡¨ï¼Œæ•°ç»„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªé“¾è¡¨çš„è¡¨å¤´ï¼Œå½“å‘ç”Ÿå†²çªï¼Œå°†æ–°å…ƒç´ æ·»åŠ åœ¨å¤´éƒ¨(å¤´æ’æ³•)
<ul>
<li>hashå†²çªï¼šå¤´æ’æ³•ï¼Œâ—æ‰©å®¹æ—¶å¯èƒ½é€ æˆç¯å½¢é“¾è¡¨</li>
</ul>
</li>
<li>jdk1.8ï¼š
<ul>
<li>å¼•å…¥çº¢é»‘æ ‘ï¼Œå½“é“¾è¡¨èŠ‚ç‚¹è¶…è¿‡8ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªé“¾è¡¨ä¼šè½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚æŸ¥è¯¢æ—¶é—´ç”± O(n) ä¼˜åŒ–ä¸º O(logn)ã€‚å½“èŠ‚ç‚¹å°äº6ä¸ªï¼Œå†è½¬æ¢ä¸ºé“¾è¡¨ã€‚</li>
<li>hashå†²çªï¼šå°¾æ’æ³•ï¼Œé¿å…ç¯å½¢é“¾è¡¨â—</li>
</ul>
</li>
<li>æ‰©å®¹æœºåˆ¶
<ul>
<li>jdk1.7
<ul>
<li>æ‰©å®¹ï¼Œå…ƒç´ ä¼šé‡æ–°è®¡ç®—hashå€¼ï¼Œå¹¶åˆ†é…åˆ°æ–°çš„æ‰©å®¹æ•°ç»„ä¸­ã€‚â­æ¯”è¾ƒè€—æ—¶</li>
<li>æ‰©å®¹æ—¶ï¼Œå¤´æ’æ³•ï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå¯èƒ½é€ æˆç¯å½¢é“¾è¡¨</li>
</ul>
</li>
<li>jdk1.8
<ul>
<li>æ‰©å®¹æ—¶ï¼Œåˆ©ç”¨äº†å…ƒç´ å“ˆå¸Œå€¼å’Œæ—§æ•°ç»„å®¹é‡å…³ç³»ï¼Œå‡å°‘äº†é‡æ–°è®¡ç®—çš„å“ˆå¸Œæ¬¡æ•°</li>
<li>æ‰©å®¹æ—¶ï¼Œå°¾æ’æ³•ï¼Œé¿å…ç¯å½¢é“¾è¡¨</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ä½¿ç”¨é”®çš„<code>hashcode()</code>è®¡ç®—hashå€¼ï¼Œç„¶å(n-1) &amp; hashç¡®å®šæ•°ç»„ä¸­çš„ä½ç½®ã€‚</p>
<ul>
<li>n-1 =&gt; 10000 - 1 = 01111</li>
</ul>
</li>
<li>
<p>HashMapçš„åˆå§‹é»˜è®¤å®¹é‡ä¸º16ï¼Œè´Ÿè½½å› å­ä¸º0.75ã€‚å½“å­˜å‚¨çš„å…ƒç´ è¾¾åˆ°75%æ—¶ï¼Œè¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹ä¸ºåŸæ¥çš„2å€ç©ºé—´</p>
</li>
</ul>
<p><strong>æ‰©å±•çŸ¥è¯†ï¼š</strong></p>
<ul>
<li>
<p>hashmapçš„çº¢é»‘æ ‘ä¼˜åŒ–ï¼š</p>
<ul>
<li>JAVA8å¼€å§‹ï¼Œä¸ºäº†ä¼˜åŒ–hashå†²çªæ—¶çš„æŸ¥æ‰¾æ€§èƒ½ã€‚ä½†é“¾è¡¨çš„é•¿åº¦<strong>è¶…è¿‡8</strong>æ—¶ï¼Œé“¾è¡¨ä¼šè½¬å˜ä¸ºçº¢é»‘æ ‘ã€‚çº¢é»‘æ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„äºŒå‰æœç´¢æ ‘ æŸ¥æ‰¾æ—¶é—´ O(n) =&gt; O(logn)ã€‚ å½“å…ƒç´ å°‘äº6ä¸ªï¼Œåˆ‡æ¢ä¸ºé“¾è¡¨</li>
</ul>
</li>
<li>
<p>hashCode() å’Œ equals()çš„é‡è¦æ€§ï¼š</p>
<ul>
<li>hashCodeè®¡ç®—hashå€¼ï¼Œå†³å®šé”®çš„å­˜å‚¨ä½ç½®ã€‚ è€ŒhashCodeç›¸åŒ=&gt;å†²çªã€‚ equals()æ¯”è¾ƒçš„å€¼</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// HashMap Node class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">;</span><span class="w">    </span><span class="c1">// é”®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">        </span><span class="c1">// å€¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">hash</span><span class="p">;</span><span class="w"> </span><span class="c1">// è®¡ç®—åçš„å“ˆå¸Œå€¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">next</span><span class="p">;</span><span class="w"> </span><span class="c1">// æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼ˆå½¢æˆé“¾è¡¨ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>ä¸ºä»€ä¹ˆå¤´æ’æ³•&amp;å¤šçº¿ç¨‹&amp;æ‰©å®¹ä¼šé€ æˆç¯å½¢é“¾è¡¨?</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">void</span><span class="w"> </span><span class="nf">transfer</span><span class="p">(</span><span class="n">Entry</span><span class="o">[]</span><span class="w"> </span><span class="n">newTable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">Entry</span><span class="o">[]</span><span class="w"> </span><span class="n">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">table</span><span class="p">;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">newCapacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newTable</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">src</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// éå†æ—§è¡¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">src</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">;</span><span class="w">              </span><span class="c1">// å–å‡ºå½“å‰æ¡¶çš„å¤´ç»“ç‚¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                     </span><span class="c1">// æ—§æ¡¶ä¸ä¸ºç©º</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">src</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">                   </span><span class="c1">// é‡Šæ”¾æ—§æ¡¶çš„å¼•ç”¨ï¼ˆé˜²æ­¢ GC è¯¯å›æ”¶ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">do</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">next</span><span class="p">;</span><span class="w">      </span><span class="c1">// è®°å½•ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indexFor</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">hash</span><span class="p">,</span><span class="w"> </span><span class="n">newCapacity</span><span class="p">);</span><span class="w">  </span><span class="c1">// è®¡ç®—æ–°ç´¢å¼•ï¼ˆçº¿ç¨‹1æš‚åœï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="n">e</span><span class="p">.</span><span class="na">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newTable</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w">          </span><span class="c1">// å¤´æ’æ³•ï¼šå°† e è¿æ¥åˆ° newTable[i] ä¸Š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="n">newTable</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w">               </span><span class="c1">// å°† e ä½œä¸º newTable[i] çš„æ–°å¤´</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next</span><span class="p">;</span><span class="w">                      </span><span class="c1">// ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span><span class="w">               </span><span class="c1">// ç›´åˆ°æ—§é“¾è¡¨éå†å®Œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">old</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">]</span><span class="w">     </span><span class="n">old</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w">                </span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w">        </span><span class="o">=&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">new</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">]</span><span class="w">     </span><span class="k">new</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">]</span><span class="w">   </span><span class="c1">// å¤´æ’æ³•ï¼Œå°†èŠ‚ç‚¹è¿›è¡Œè½¬ç§»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ç¯çš„æƒ…å†µï¼ŒHashMapå¤šä¸ªçº¿ç¨‹å…±äº« </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">Thread1</span><span class="p">:</span><span class="w">   </span><span class="n">e</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">  </span><span class="o">[</span><span class="n">1</span><span class="o">][</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">]</span><span class="w">             </span><span class="n">Thread2</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">3</span><span class="o">][</span><span class="w"> </span><span class="o">][</span><span class="w"> </span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">next</span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w">                   </span><span class="n">æ‰©å®¹æˆåŠŸ</span><span class="w">  </span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span><span class="o">[</span><span class="n">3</span><span class="o">]</span><span class="w">                            </span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">æ‰§è¡Œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newTable</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">newTable</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">              
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">newTabel</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">1</span><span class="o">]-&gt;[</span><span class="n">3</span><span class="o">]-&gt;[</span><span class="n">2</span><span class="o">]-&gt;[</span><span class="n">1</span><span class="o">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="err">â¬†</span><span class="n">ï¸</span><span class="w">  </span><span class="err">â¬…</span><span class="n">ï¸</span><span class="w">      </span><span class="err">â¬…</span><span class="n">ï¸</span><span class="w">
</span></span></span></code></pre></div><!-- raw HTML omitted -->
<h3 id="4948-hashmapæœ‰å“ªäº›æå‡æ€§èƒ½çš„æŠ€å·§">4948 HashMapï¼Œæœ‰å“ªäº›æå‡æ€§èƒ½çš„æŠ€å·§ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#4948-hashmapæœ‰å“ªäº›æå‡æ€§èƒ½çš„æŠ€å·§">#</a></h3>
<ul>
<li>
<p>åˆç†è®¾ç½®åˆå§‹å®¹é‡ï¼Œå‡å°‘resizeï¼Œå‡å°‘æ‰©å®¹æ“ä½œã€‚é»˜è®¤16</p>
</li>
<li>
<p>è°ƒæ•´è´Ÿè½½å› å­ï¼ŒæŸ¥æ‰¾å¤šçš„è®¾ç½®å°ä¸€ç‚¹ï¼Œå‡å°‘å†²çªæƒ…å†µï¼Œå†²çªå°‘äº†(æŸ¥è¯¢æ•ˆç‡å°±é«˜äº†)ï¼Œä½†ä¼šæé«˜å†…å­˜å ç”¨æƒ…å†µï¼Œåä¹‹äº¦ç„¶ã€‚é»˜è®¤0.75</p>
</li>
<li>
<p>ç¡®ä¿hashCode(), å‡åŒ€çš„æ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œä»¥å‡å°‘hashå†²çªã€‚</p>
</li>
</ul>
<p>æ‰©å±•ï¼š</p>
<ul>
<li>å½“å…ƒç´ æ•°é‡ &gt; è£…å¡«å› å­ * æ•°ç»„å¤§å° =&gt; è¿›è¡Œæ‰©å®¹ï¼Œæ–°æ•°ç»„ä¸ºå½“å‰çš„2å€ï¼Œå¹¶æŠŠå½“å‰hashä¸­çš„æ•°æ®é‡æ–°åˆ†é…åˆ°æ–°çš„hashmapä¸­ï¼›</li>
<li>LinkedHashMapï¼Œæ‹‰é“¾æ³•ï¼Œèƒ½å¤Ÿä¿å­˜æ’å…¥é¡ºåº</li>
<li>ä¿å­˜æœ‰åº =&gt; TreeMap.</li>
<li>éœ€è¦çº¿ç¨‹å®‰å…¨ =&gt; ConcurrentHashMap</li>
</ul>
<h3 id="4947-hashç¢°æ’--è§£å†³">4947 Hashç¢°æ’ &amp; è§£å†³<a hidden class="anchor" aria-hidden="true" href="#4947-hashç¢°æ’--è§£å†³">#</a></h3>
<p>ä¸åŒkeyä½¿ç”¨hashcode()&amp;n-1å¾—åˆ°ç›¸åŒçš„å‘ï¼Œç„¶åå†²çª</p>
<ul>
<li>é“¾åœ°å€æ³•(æ‹‰é“¾æ³•)</li>
<li>å¼€æ”¾åœ°å€æ³•ï¼Œé¡ºåºå¾€ä¸‹orå·¦å³æ¨ªè·³
<ul>
<li>çº¿æ€§æ¢æµ‹</li>
<li>å¹³æ–¹æ¢æµ‹</li>
</ul>
</li>
<li>å†hashæ³•(åŒé‡hash)
<ul>
<li>å‡ºç°ç¢°æ’åï¼Œä½¿ç”¨ç¬¬äºŒä¸ªhashå‡½æ•°è®¡ç®—æ–°çš„ç´¢å¼•ä½ç½®ï¼Œå‡å°‘ç¢°æ’çš„æ¦‚ç‡ã€‚</li>
</ul>
</li>
</ul>
<h3 id="4946-copyonwritearraylist--collectionssynchronizeddlist-åŒºåˆ«">4946 CopyOnWriteArrayList &amp; Collections.synchronizeddList åŒºåˆ«<a hidden class="anchor" aria-hidden="true" href="#4946-copyonwritearraylist--collectionssynchronizeddlist-åŒºåˆ«">#</a></h3>
<p><strong>CopyOnWriteArrayList</strong> æ˜¯çº¿ç¨‹å®‰å…¨çš„Listå®ç°ï¼Œç‰¹æ€§æ˜¯å†™æ—¶å¤åˆ¶</p>
<p>æ¯æ¬¡å¯¹Listçš„ä¿®æ”¹æ“ä½œ(add, remove, set)éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åº•å±‚æ•°ç»„ã€‚ è¯»æ“ä½œä¸éœ€è¦åŠ é”ï¼Œè€Œå†™æ“ä½œéœ€è¦åŠ é”</p>
<p><em>ä¼˜ç‚¹</em>ï¼š</p>
<ul>
<li>è¯»æ“ä½œæ— é”ï¼Œå†™æ“ä½œä¼šåˆ›å»ºæ•°ç»„å‰¯æœ¬ =&gt; è¯»å†™ä¸å†²çª</li>
<li>â­è¯»æ“ä½œåœ¨å½“å‰æ•°ç»„ä¸Šæ‰§è¡Œï¼› å†™æ“ä½œ(add,set,remove)ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œæ–°æ•°ç»„ä¸Šä¿®æ”¹å†æ›¿æ¢æ—§çš„(åŠ é”)ã€‚</li>
</ul>
<p><em>ç¼ºç‚¹</em>ï¼š</p>
<ul>
<li>å†™æ“ä½œå¼€é”€å¤§ï¼šæ¯æ¬¡å†™æ“ä½œéƒ½ä¼šåˆ›å»ºå¹¶å¤åˆ¶æ–°æ•°ç»„ï¼Œå¹¶ä¸”å°†æ•°æ®å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œ<strong>å†™é¢‘ç¹çš„åœºæ™¯ä¸‹æ€§èƒ½ä¼šæ¯”è¾ƒä½</strong></li>
<li>å†…å­˜æ¶ˆè€—å¤§</li>
</ul>
<p>ğŸ‰<strong>é€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯</strong></p>
<p><strong>Collections.synchronizeddList</strong> åŒ…è£…æ–¹æ³•ï¼Œå°†ä»»ä½•æ•°ç»„è½¬æ¢ä¸ºçº¿ç¨‹å®‰å…¨çš„ç‰ˆæœ¬ï¼Œä¼šå¯¹æ¯ä¸ªè®¿é—®æ–¹æ³•(get, set, add, remove)è¿›è¡ŒåŒæ­¥(åŠ é”)ï¼Œçº¿ç¨‹å®‰å…¨ã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æ–¹ä¾¿</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å¹¶å‘æ•ˆç‡ä½</li>
</ul>
<p>ğŸ‰<strong>é€‚ç”¨äºç®€å•çš„å°†Listè½¬ä¸ºçº¿ç¨‹å®‰å…¨çš„ç‰ˆæœ¬ä½¿ç”¨ã€‚</strong></p>
<hr>
<h3 id="444-javaä¸­æœ‰å“ªäº›é›†åˆç±»">444 Javaä¸­æœ‰å“ªäº›é›†åˆç±»ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#444-javaä¸­æœ‰å“ªäº›é›†åˆç±»">#</a></h3>
<ul>
<li>
<p>Listæ¥å£</p>
<ul>
<li>ArrayList</li>
<li>LinkedList</li>
<li>Vector
<ul>
<li>åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œä¸”çº¿ç¨‹å®‰å…¨ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½æ·»åŠ äº†synchronized</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Setæ¥å£</p>
<ul>
<li>HashSet // å†²çªçš„é“¾è¡¨å…ƒç´ æ— åº</li>
<li>LinkedHashSet // ç»§æ‰¿HashSetï¼Œåº•å±‚ç”±åŒå‘é“¾è¡¨å®ç°ï¼Œä¿è¯<strong>æ’å…¥é¡ºåº</strong></li>
<li>TreeSet // åŸºäºçº¢é»‘æ ‘, <strong>è‡ªåŠ¨æ’åº</strong>ï¼Œæä¾›æ’åºåŠŸèƒ½</li>
</ul>
</li>
<li>
<p>Queueæ¥å£</p>
<ul>
<li>PriorityQueueï¼Œ ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå†…éƒ¨å…ƒç´ æŒ‰çº§åˆ«æ’åºã€‚åªèƒ½æ¯”è¾ƒå™¨</li>
<li>LinkedListï¼Œå¯ä»¥ä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨ï¼ŒFIFO</li>
</ul>
</li>
<li>
<p>Mapæ¥å£</p>
<ul>
<li>HashMap</li>
<li>LinkedHashMap</li>
<li>TreeMap</li>
<li>HashTable<!-- raw HTML omitted -->ä¸æ¨èä½¿ç”¨<!-- raw HTML omitted -->ï¼Œçº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨ã€‚**æ—©æœŸçº¿ç¨‹å®‰å…¨çš„HashMapï¼Œé”çš„ç²’åº¦ä¸ºæ•´ä¸ªè¡¨ï¼Œè¿™æ ·å¹¶å‘èƒ½åŠ›ä¸é«˜ã€‚**åº•å±‚ä½¿ç”¨synchronizedå…³é”®å­—å®ç°</li>
<li>ConcurrentHashMapï¼Œçº¿ç¨‹å®‰å…¨çš„hashmapã€‚
<ul>
<li>é«˜æ€§èƒ½çš„çº¿ç¨‹å®‰å…¨HashMap</li>
<li>æä¾›æ›´ç»†ç²’åº¦çš„é” <strong>åˆ†æ®µé”å’ŒCASæ“ä½œ</strong></li>
<li>è¯»æ“ä½œä¸åŠ é”</li>
<li>å†™æ“ä½œ =&gt; CAS + synchronizedç»†ç²’åº¦é”</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="9179-arraylistçš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆ">9179 ArrayListçš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#9179-arraylistçš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆ">#</a></h3>
<p>é»˜è®¤å®¹é‡10ï¼Œå½“å…ƒç´ æ•°é‡è¶…è¿‡å…¶å½“å‰å®¹é‡ï¼Œä¼šè§¦å‘æ‰©å®¹æœºåˆ¶ã€‚  æ‰©å®¹å¤§å°ä¸ºåŸæ•°ç»„çš„1.5å€</p>
<h3 id="449-hashset--hashmap">449 HashSet &amp; HashMap<a hidden class="anchor" aria-hidden="true" href="#449-hashset--hashmap">#</a></h3>
<p>HashSetå­˜å‚¨ä¸é‡å¤å…ƒç´  =&gt; ä¸èƒ½å†²çªçš„HashMap</p>
<p>HashMapï¼ŒK=&gt;V, é”®å”¯ä¸€ï¼Œä½†ä¸åŒé”®çš„å€¼å¯ä»¥ç›¸åŒ</p>
<h3 id="451-hashmapçš„æ‰©å®¹æœºåˆ¶">451 HashMapçš„æ‰©å®¹æœºåˆ¶<a hidden class="anchor" aria-hidden="true" href="#451-hashmapçš„æ‰©å®¹æœºåˆ¶">#</a></h3>
<p>è´Ÿè½½å› å­é»˜è®¤0.75, ä½†æ¯”ä¾‹è¶…è¿‡è´Ÿè½½å› å­ï¼Œè¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹ä¸ºåŸæ¥çš„2å€ã€‚</p>
<p>å½“å‰hashmapä¸­çš„å…ƒç´ åœ¨æ–°hashmapçš„ä½ç½®æ€ä¹ˆè®¡ç®—ï¼Ÿ å°±æ˜¯hashCode() &amp; (n-1) =&gt; hashCode() &amp; (2n-1)</p>
<p>ä¼˜åŒ–è¿‡ç¨‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// example:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">n</span><span class="p">:</span><span class="n">16</span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="n">0000</span><span class="w">    </span><span class="n">n</span><span class="o">-</span><span class="n">1</span><span class="p">:</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="n">1111</span><span class="w">      </span><span class="n">2</span><span class="o">^</span><span class="n">4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">2n</span><span class="p">:</span><span class="n">32</span><span class="o">=</span><span class="n">10</span><span class="p">,</span><span class="n">0000</span><span class="w">   </span><span class="n">2n</span><span class="o">-</span><span class="n">1</span><span class="p">:</span><span class="n">01</span><span class="p">,</span><span class="n">1111</span><span class="w">      </span><span class="n">2</span><span class="o">^</span><span class="n">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// é€šè¿‡hashå€¼ &amp; 2n-1:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// åªè¦åˆ¤æ–­æœ€é«˜ä½æ˜¯å¦å³å¯</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="n">ç¬¬5ä½</span><span class="o">==</span><span class="w"> </span><span class="n">0</span><span class="err">ï¼š</span><span class="n">then</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ä½ç½®ä¸å˜</span><span class="err">ï¼›</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">else</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ä½ç½®åç§»16ä½</span><span class="w">
</span></span></span></code></pre></div><h3 id="452-ä¸ºä»€ä¹ˆhashmapæ‰©å®¹é‡‡ç”¨2çš„næ¬¡æ–¹">452 ä¸ºä»€ä¹ˆHashMapæ‰©å®¹é‡‡ç”¨2çš„næ¬¡æ–¹ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#452-ä¸ºä»€ä¹ˆhashmapæ‰©å®¹é‡‡ç”¨2çš„næ¬¡æ–¹">#</a></h3>
<ul>
<li>è®¡ç®—æ•£åˆ—ä½ç½®å†³å®š=&gt; hashcode &amp; (n-1)   å…¶ä¸­ n-1=01111.. å¯ä»¥å°†ä½ç½®æ˜ å°„åˆ°æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ä¸Šï¼Œåˆ†å¸ƒå‡åŒ€ã€‚</li>
</ul>
<p><strong>ä½è¿ç®—æ¯”å–ä½™æ•ˆç‡é«˜</strong></p>
<h3 id="457-javaä¸­çš„linkedhashmap">457 Javaä¸­çš„LinkedhashMap<a hidden class="anchor" aria-hidden="true" href="#457-javaä¸­çš„linkedhashmap">#</a></h3>
<p>åŸºäºHashMap &amp; åŒå‘é“¾è¡¨ &amp; é¢å¤–çš„é¡ºåºæŒ‡é’ˆ</p>
<p>ğŸ·ï¸ä½œç”¨ï¼šä¿æŒæ’å…¥é¡ºåºorè®¿é—®é¡ºåº</p>
<p>ğŸ’ å®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">HashMap</span><span class="p">.</span><span class="na">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">before</span><span class="p">,</span><span class="w"> </span><span class="n">after</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Ectry</span><span class="p">(){...}</span><span class="w"> </span><span class="c1">// constructor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>ğŸ·ï¸å›¾ç¤ºï¼š</p>
<!-- raw HTML omitted -->
<p>æ„æƒ³=&gt; ç”±äºå¯ä»¥æ ¹æ®æ’å…¥æ—¶é—´æ’åºï¼Œå› æ­¤å¯ä»¥æ¨¡æ‹ŸLRU(least recently used)ç®—æ³•ï¼Œè¿›è¡Œæ·˜æ±°æœ€ä¸å¸¸ç”¨çš„èŠ‚ç‚¹ã€‚</p>
<hr>
<h3 id="461-concurrenthashmap">461 ConcurrentHashMap<a hidden class="anchor" aria-hidden="true" href="#461-concurrenthashmap">#</a></h3>
<p>ğŸ·ï¸èƒŒæ™¯ï¼šåœ¨å¤šçº¿ç¨‹å¹¶å‘æ¡ä»¶ä¸‹ï¼Œæ™®é€šçš„å…±äº«HashMapä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºæ²¡æœ‰åŠ é”ï¼Œå¯¼è‡´æ•°æ®è¢«è¦†ç›–&hellip;ï¼›</p>
<p>ğŸ·ï¸ä½œç”¨ï¼šé€šè¿‡åŒæ­¥æœºåˆ¶åŠ é”ï¼Œä½¿å¾—HashMapåœ¨èƒŒæ™¯ä¸‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸”è¿˜éœ€è¦ä¿è¯æ•ˆç‡ï¼›</p>
<p>ğŸ·ï¸å®šä¹‰ï¼š</p>
<ul>
<li>JDK1.7ä¹‹å‰ï¼Œé‡‡ç”¨<strong>åˆ†æ®µé”</strong>ï¼Œå³æ¯ä¸ª<strong>Segment</strong>æ˜¯ç‹¬ç«‹çš„ï¼Œå°†é”çš„ç²’åº¦ä¸‹æ–¹ï¼Œæé«˜çº¿ç¨‹å¹¶å‘åº¦
<ul>
<li>åˆ©ç”¨æ•°ç»„+é“¾è¡¨å®ç°</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<p>=&gt; é”çš„ç²’åº¦æ˜¯segmentï¼›</p>
<p>ç¼ºç‚¹ï¼šsegmentä¸èƒ½æ‰©å®¹ï¼Œè€ŒHashMapä¼šæ‰©å®¹</p>
<ul>
<li>JDK1.8åï¼Œç§»é™¤Segmentï¼Œé”çš„ç²’åº¦æ›´åŠ ç»†åŒ–ï¼Œé”åªåœ¨é“¾è¡¨orçº¢é»‘æ ‘<strong>èŠ‚ç‚¹çº§åˆ«</strong>ä¸Šç«äº‰é”ã€‚é€šè¿‡CASè¿›è¡Œæ’å…¥æ“ä½œï¼Œåªæœ‰åœ¨æ›´æ–°é“¾è¡¨orçº¢é»‘æ ‘æ—¶æ‰ä½¿ç”¨synchronizedå…³é”®å­—åŠ é”ï¼Œå¹¶ä¸”åªé”ä½é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚
<ul>
<li>åŒæ­¥HashMapï¼Œæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘å®ç°ï¼›</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<p>ğŸ·ï¸æ·»åŠ èŠ‚ç‚¹è¿‡ç¨‹</p>
<ul>
<li>è®¡ç®—keyçš„hashåçš„ä¸‹æ ‡ï¼Œå¦‚æœæ²¡æœ‰å…ƒç´  =&gt; åˆ©ç”¨CASæ·»åŠ å…ƒç´ ï¼›</li>
<li>å†²çª =&gt; ç»™è¿™ä¸ªèŠ‚ç‚¹ä¸Šé”ä½¿ç”¨synchronizedã€‚è¿™æ ·å…¶ä»–çº¿ç¨‹å°±æ— æ³•è®¿é—®è¯¥èŠ‚ç‚¹ä»¥åŠä¹‹åçš„èŠ‚ç‚¹äº†</li>
</ul>
<p>ğŸ·ï¸é¢å¤–æ‰©å±•ï¼ˆä¸ºä»€ä¹ˆåˆ†ä¸ºCAS&amp;Synchronizedå‘¢ï¼Ÿï¼‰</p>
<ul>
<li>æ— é”æœºåˆ¶CASï¼Œèƒ½è¿›ä¸€æ­¥æé«˜å¹¶å‘æ€§èƒ½ï¼› å› æ­¤é¦–æ¬¡æ·»åŠ èŠ‚ç‚¹æ—¶ï¼Œåˆ©ç”¨CASå¾ˆOKï¼Œåˆ¤æ–­&amp;æ’å…¥</li>
<li>è€Œåç»­å¯¹é“¾è¡¨çš„ä¿®æ”¹ï¼Œå¾ˆéš¾åŸå­åŒ–æ“ä½œorCASæ¯”è¾ƒäº¤æ¢ã€‚å› æ­¤ä½¿ç”¨Synchronizedï¼Œå®ç°äº’æ–¥ï¼Œä¸”è¯¥é”çš„ç²’åº¦å¾ˆå°ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// è‡ªæ—‹ï¼šå¦‚æœ CAS å¤±è´¥å°±é‡è¯•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">currentNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bucket</span><span class="p">.</span><span class="na">get</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentNode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å¦‚æœæ¡¶ä½ç½®ä¸ºç©ºï¼Œå°è¯•é€šè¿‡ CAS æ’å…¥æ–°èŠ‚ç‚¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bucket</span><span class="p">.</span><span class="na">compareAndSet</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">newNode</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"> </span><span class="c1">// æ’å…¥æˆåŠŸ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å¦‚æœå½“å‰ä½ç½®æœ‰èŠ‚ç‚¹ï¼Œè¿›è¡Œé“¾è¡¨éå†ï¼Œå¯»æ‰¾åˆé€‚ä½ç½®æ’å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">currentNode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// åœ¨è®¿é—®é“¾è¡¨èŠ‚ç‚¹æ—¶åŠ é”ï¼Œé˜²æ­¢å¹¶å‘ä¿®æ”¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Node</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">currentNode</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentNode</span><span class="p">.</span><span class="na">key</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// å¦‚æœæ‰¾åˆ°ç›¸åŒçš„ keyï¼Œæ›´æ–° value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">currentNode</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">currentNode</span><span class="p">.</span><span class="na">value</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentNode</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">currentNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentNode</span><span class="p">.</span><span class="na">next</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸åŒçš„ keyï¼Œåœ¨é“¾è¡¨æœ«å°¾æ·»åŠ æ–°çš„èŠ‚ç‚¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">prev</span><span class="p">.</span><span class="na">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newNode</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"> </span><span class="c1">// æ’å…¥æˆåŠŸ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><hr>
<h3 id="464-copyonwritearraylist">464 CopyOnwriteArrayList<a hidden class="anchor" aria-hidden="true" href="#464-copyonwritearraylist">#</a></h3>
<p><strong>çº¿ç¨‹å®‰å…¨çš„åŠ¨æ€æ•°ç»„</strong>ï¼Œé€šè¿‡<strong>å†™æ—¶å¤åˆ¶æœºåˆ¶</strong>ï¼Œä¿è¯æ•°æ®æœ€ç»ˆä¸€è‡´æ€§å’Œéš”ç¦»æ€§ï¼Œå¹¶ä¸ä¿è¯å¼ºä¸€è‡´æ€§ã€‚</p>
<ul>
<li>å†™æ“ä½œå’Œè¯»æ“ä½œ(Volatileä¿®é¥°)åˆ†ç¦»ï¼Œè¯»å®Œå…¨ok(å¯èƒ½è¯»åˆ°æ—§ç‰ˆæœ¬)ï¼›å†™éœ€è¦åŠ é”ä¸”å¤åˆ¶æ•°ç»„ï¼Œå†ä¿®æ”¹æ—§æ•°ç»„çš„å¼•ç”¨ã€‚</li>
</ul>
<p><em><strong>çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š</strong></em></p>
<ul>
<li>ç«äº‰æ¡ä»¶
<ul>
<li>å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œç´¯åŠ ï¼Œå¯ä»¥å¯¼è‡´ç»Ÿè®¡ä¸å¯¹</li>
</ul>
</li>
<li>æ­»é”
<ul>
<li>å¤šä¸ªçº¿ç¨‹æ“ä½œæ•°æ®æ—¶ï¼Œæ²¡æœ‰æ­£ç¡®çš„è¯·æ±‚èµ„æºå’Œé‡Šæ”¾é¡ºåºï¼Œç›¸äº’ç­‰å¾…</li>
</ul>
</li>
<li><strong>å¯è§æ€§</strong>é—®é¢˜
<ul>
<li>æŸä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå…¶ä»–çº¿ç¨‹ä¸ä¸€å®šåŠæ—¶å¯è§
<ul>
<li>=&gt; volatile å¼ºåˆ¶ä»å†…å­˜ä¸­ä¿®æ”¹&amp;è¯»å–</li>
</ul>
</li>
</ul>
</li>
<li><strong>åŸå­æ€§</strong>é—®é¢˜
<ul>
<li>é€»è¾‘ç”±å¤šä¸ªæ“ä½œæ­¥éª¤ç»„æˆï¼Œå…¶ä¸­CPUæ—¶é—´ç‰‡åˆ°æœŸäº†ï¼Œä¸­é€”å…¶ä»–çº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡ï¼Œå¯¼è‡´ä¸ä¸€è‡´ã€‚</li>
</ul>
</li>
<li>çº¿ç¨‹é¥¥é¥¿
<ul>
<li>å¤šçº¿ç¨‹äº‰æŠ¢CPUï¼Œéå…¬å¹³ï¼Œæœ‰äº›æ°¸è¿œæŠ¢ä¸åˆ°</li>
</ul>
</li>
<li><strong>ä¸ä¸€è‡´</strong>è§†å›¾
<ul>
<li>å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹ä¸€ä¸ªå…±äº«å¯¹è±¡ï¼Œå¯¼è‡´ä¸€éƒ¨åˆ†æ•°æ®ä¸ä¸€è‡´
<ul>
<li>å¼ºåˆ¶è§†å›¾ä¸€è‡´ï¼Œå°±æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ‹¿åˆ°çš„æ•°æ®ï¼Œå’Œæœ€ç»ˆçš„æ•°æ®è¦ä¸€è‡´ï¼Œå…¶ä»–çº¿ç¨‹åˆ«ç»™æˆ‘æ”¹äº†ä¸€éƒ¨åˆ†å•Š =&gt; åŠ synchronized</li>
</ul>
</li>
</ul>
</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/jobs/java%E5%85%AB%E8%82%A1-%E5%B9%B6%E5%8F%91/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span></span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">LongWei Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
