<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ECGè®ºæ–‡å’Œå®éªŒ | LongCoding&#39;s Blog</title>
<meta name="keywords" content="ECG">
<meta name="description" content="ECGå¿ƒç”µå›¾è®ºæ–‡åˆ›æ–°ç‚¹æ•´ç†å’Œåˆæ­¥å®éªŒ">
<meta name="author" content="LongWei">
<link rel="canonical" href="http://longcoding.top/posts/learning/ecg_exp/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="http://longcoding.top/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://longcoding.top/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://longcoding.top/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://longcoding.top/apple-touch-icon.png">
<link rel="mask-icon" href="http://longcoding.top/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://longcoding.top/posts/learning/ecg_exp/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://longcoding.top/posts/learning/ecg_exp/">
  <meta property="og:site_name" content="LongCoding&#39;s Blog">
  <meta property="og:title" content="ECGè®ºæ–‡å’Œå®éªŒ">
  <meta property="og:description" content="ECGå¿ƒç”µå›¾è®ºæ–‡åˆ›æ–°ç‚¹æ•´ç†å’Œåˆæ­¥å®éªŒ">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-19T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-04-19T00:00:00+00:00">
    <meta property="article:tag" content="ECG">
      <meta property="og:image" content="http://longcoding.top/papermod-cover.png">
      <meta property="og:see_also" content="http://longcoding.top/posts/learning/minibaseline_learning/">
      <meta property="og:see_also" content="http://longcoding.top/posts/learning/paper_reading1/">
      <meta property="og:see_also" content="http://longcoding.top/posts/learning/paper_reading2/">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://longcoding.top/papermod-cover.png">
<meta name="twitter:title" content="ECGè®ºæ–‡å’Œå®éªŒ">
<meta name="twitter:description" content="ECGå¿ƒç”µå›¾è®ºæ–‡åˆ›æ–°ç‚¹æ•´ç†å’Œåˆæ­¥å®éªŒ">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://longcoding.top/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ECGè®ºæ–‡å’Œå®éªŒ",
      "item": "http://longcoding.top/posts/learning/ecg_exp/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ECGè®ºæ–‡å’Œå®éªŒ",
  "name": "ECGè®ºæ–‡å’Œå®éªŒ",
  "description": "ECGå¿ƒç”µå›¾è®ºæ–‡åˆ›æ–°ç‚¹æ•´ç†å’Œåˆæ­¥å®éªŒ",
  "keywords": [
    "ECG"
  ],
  "articleBody": "è®ºæ–‡ â­IM-ECG - 2023 IM-ECG: An interpretable framework for arrhythmia detection using multi-lead ECG - Expert Systems With Applications sci-1\nåˆ›æ–°ç‚¹:\nConv2Dæ¨¡å‹ä¸Grad-CAMçš„é€‚é…æ›´å¥½ - å®æ—¶æ ‡æ³¨ç—…ç†åŒºåŸŸ è§£é‡Šæ€§\nåŒæ ¸æ®‹å·®å— - æ¨ªè½´ä¸ç«–è½´+é¢ ä¸‰ç§æ‰«ææ–¹å¼\nk * n(åŒºåŸŸæ‰«æ)å†…æ ¸æœå‘ä¸­å¿ƒå‹ç¼©ECGä»¥æ›´ç›´æ¥åœ°æ•è·å¯¼è”é—´ç‰¹å¾ï¼Œè€Œ1 * n(æ¨ªè½´æ‰«æ)å†…æ ¸æ²¿ç€æ—¶é—´ç»´åº¦å‹ç¼©ECGå¹¶ä¸”å› æ­¤æ›´å…³æ³¨å¯¼è”å†…ç‰¹å¾\næµç¨‹å›¾ç¤º\næ¨¡å‹ç»“æ„\nBlock\nLightweight Transformer - 2022 Enhancing dynamic ECG heartbeat classification with lightweight transformer model\nArtificial Intelligence In Medicine sci-1\nåˆ›æ–°ç‚¹ï¼š\nä¸¤çº§æ³¨æ„åŠ›æœºåˆ¶ï¼š å±€éƒ¨ + å…¨å±€ // å±€éƒ¨æ³¨æ„åŠ› == é€šé“æ³¨æ„åŠ› SEBlock || å…¨å±€æ³¨æ„åŠ› == Transformer Encoder\nå·ç§¯ç»“æ„æ¥ä»£æ›¿è‡ªæ³¨æ„\nInput: æ£€æµ‹Rå³°åˆ†æ®µ\næ¨¡å‹æ¡†æ¶\rCNN Block\rCNN+Attentionæ¥æå–å¿ƒè·³å†…éƒ¨çš„ç‰¹å¾\nlight-Conv Attention\rGLU: gated linear unit\nLconv: depth-wise Convolution\nSE-ECGNet - 2020 SE-ECGNet: A Multi-scale Deep Residual Network with Squeeze-and-Excitation Module for ECG Signal Classification\n2020 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)\nåˆ©ç”¨ECGä¿¡å·ä¸­çš„å¤šå¯¼è”ä¿¡æ¯ï¼Œå°†å¤šå°ºåº¦äºŒç»´å·ç§¯å—ä¸ä¸€ç»´å·ç§¯å—ç»“åˆèµ·æ¥è¿›è¡Œç‰¹å¾æå–\nåˆ›æ–°ç‚¹\næä¾›å¯¹å¿ƒç”µæ•°æ®çš„ä¸åŒè§†è§’ å°†ECGä¿¡å·è§†ä¸ºäºŒç»´å›¾ç‰‡(å•é€šé“ç°åº¦å›¾)\næ¨¡å‹æ¡†æ¶\rCNN Block\rå‰æœŸè¾ƒå¤§çš„å·ç§¯æ ¸å¯ä»¥æ‰©å¤§æ„Ÿå—é‡ï¼Œæå–æ›´åŠ å¹¿æ³›çš„ä¿¡æ¯ï¼ŒåæœŸè¿›è¡Œä¿¡æ¯æµ“ç¼©æå–\nâ­MVMS-ECG - 2023 A Multi-View Multi-Scale Neural Network for Multi-Label ECG Classification\nIEEE Transactions on Emerging Topics in Computational Intelligence sci-2\nåˆ›æ–°ç‚¹ï¼š\nå°†å¯¼è”æŒ‰ç…§è¿æ¥è§‚æµ‹è§’åº¦åˆ†ç»„ åˆ†è§†å›¾çš„èåˆç½‘ç»œä¸ºæ•™å®¤ç½‘ç»œ(å‚æ•°å¤§) =è’¸é¦\u003e å•è§†å›¾çš„å­¦ç”Ÿç½‘ç»œ\næ¨¡å‹ç»“æ„\nCNN Layers\nFusion Layer\nå¦‚æœæ˜¯å¤šè§†å›¾ï¼Œé‚£ä¹ˆå°±ä¸è¦æœ€åçš„FCå°†æœ€åç‰¹å¾æ˜ å°„ä¸ºç±»åˆ«æ•°ï¼›\næºç  =\u003e æ¯ä¸ªè§†å›¾outputéƒ½æ˜¯ [B, 128] =\u003e é‡æ–°åŠ æƒ(128=\u003e1çš„linearå……å½“è°ƒå’Œå™¨) =\u003e è¿‡å¤šè§†å›¾çš„FC(128 =\u003e num_class)\nMulti-scale Conv Block\nç½‘ç»œçš„å¤šå°ºåº¦è¡¨ç¤ºåœ¨æ›´ç»†ç²’åº¦çš„çº§åˆ«ä¸Šå¾—åˆ°å¢å¼º - é‡‡ç”¨Res2Block\nCoordinate Attention 1D\næ—¢å»ºç«‹äº†ç‰¹å¾é€šé“é—´çš„å…³ç³»ï¼Œå¯¹å„é€šé“çš„é‡è¦æ€§è¿›è¡Œé‡æ–°åŠ æƒï¼Œåˆè·å¾—äº†ç‰¹å¾ç©ºé—´ä¸­çš„ç©ºé—´ä¿¡æ¯\nMVKT-ECG - 2023 MVKT-ECG: Efficient single-lead ECG classification for multi-label arrhythmia by multi-view knowledge transferring\nComputers in Biology and Medicine sci-2\nåˆ›æ–°ç‚¹ï¼š\nâ€‹\t# å¤šå¯¼è”ä¿¡æ¯å¦‚ä½•è’¸é¦åˆ°å•å¯¼è”ä¸­\nä¸åŒå¯¼è”æ˜¯æ£€æµ‹å¿ƒè„çŠ¶å†µçš„ä¸åŒè§†è§’ï¼Œæä¾›å¯¹ç›®æ ‡ç–¾ç—…çš„å¤šç§è§‚æµ‹ç‚¹å’Œå¤šç§å¤–è²Œ\n=\u003e ç›®æ ‡ï¼šæ˜¯æ•™ä¼šç½‘ç»œä»å•å¯¼è”ECGä¿¡å·ä¸­æ¢å¤å°½å¯èƒ½å¤šçš„å…¨å¯¼è”ä¿¡æ¯\nå¯¼è”å…±åŒä¿¡æ¯çš„çŸ¥è¯†è’¸é¦ è™½ç„¶æœ‰äº›ç–¾ç—…ä¸èƒ½ä»å•å¯¼è”ECGä¿¡å·ä¸­æ¨æ–­å‡ºæ¥ï¼Œä½†æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°½å¯èƒ½ç¼©çŸ­å•å¯¼è”ECGè§£é‡Šæ¨¡å‹å’Œå¤šå¯¼è”ECGè§£é‡Šæ¨¡å‹ä¹‹é—´çš„ä¿¡æ¯å·®è·ï¼Œé¼“åŠ±å­¦ç”Ÿæ›´å¤šåœ°å…³æ³¨æŸäº›ç‰¹å®šç–¾ç—…çš„å…³é”®ç»†èŠ‚ï¼Œæœ€å¤§é™åº¦åœ°åˆ©ç”¨å•å¯¼è”ECGè§£é‡Šæ¨¡å‹å’Œå¤šå¯¼è”ECGè§£é‡Šæ¨¡å‹ä¹‹é—´çš„ç–¾ç—…ä¿¡æ¯ã€‚\n=\u003e é€šè¿‡ç¼©çŸ­å­¦ç”Ÿæ¨¡å‹å’Œæ•™å¸ˆæ¨¡å‹å¯¹ç§¯æå¯¹çš„è¡¨ç¤ºå¹¶å°†â€œæ¶ˆæ\"å¯¹ä¹‹é—´çš„è¡¨ç¤ºåˆ†å¼€æ¥å®ç°çš„\nâ­â­â­æœ€å¤§åŒ–å•å¯¼è”ECGä¿¡å·å’Œå¤šå¯¼è”ECGä¿¡å·ä¹‹é—´çš„äº’(å…±åŒ)ä¿¡æ¯æ¥ä¼ é€’æœ‰ç”¨çš„ç–¾ç—…ä¿¡æ¯ã€‚\nå› ä¸ºï¼šä»å•å¯¼è”ECGä¿¡å·ä¸­æå–çš„ç–¾ç—…ä¿¡æ¯æ¯”12å¯¼è”ECGä¿¡å·å°‘ï¼Œä½†ä»åŒ…å«éƒ¨åˆ†ç–¾ç—…ä¿¡æ¯ã€‚\nâ—â—â— å¼•å‡ºCLT-Loss å¤ªéš¾äº†ï¼Œæ²¡çœ‹\né¢å‘ç‰¹å¾ä¸ç‰¹å¾çš„ç›¸ä¼¼åº¦ ä¸ æœ€ç»ˆé¢„æµ‹å’Œæ ‡ç­¾çš„Lossç›®çš„ä¸ä¸€æ ·\nå¤šæ ‡ç­¾çŸ¥è¯†è’¸é¦çš„ä¼˜åŒ– ä»¿ç…§CE-Loss å’Œ BCE-Loss\nMulti-Modal + Instance - 2023 Multimodal multi-instance learning for long-term ECG classification - Knowledge-Based Systems\nèŠ‚æ‹ è§†ä¸º å®ä¾‹\nåŒæ¨¡æ€ï¼šä¸€ç»´ä¿¡å· + äºŒç»´å›¾ç‰‡\nå¤šæ¨¡æ€ä¿¡æ¯èåˆ ä¼ ç»Ÿï¼š\næ–°æ–¹æ³•\nâ€‹\té€šè¿‡ä½¿ç”¨æœ€å¤§æ± åŒ–æ“ä½œä»æ¯ä¸ªæ¨¡æ€çš„å®ä¾‹ç‰¹å¾ä¸­é€‰æ‹©é¡¶éƒ¨æ¿€æ´»å®ä¾‹ç‰¹å¾(ä»£è¡¨)ã€‚ç„¶åè®¡ç®—é¡¶éƒ¨æ¿€æ´»å®ä¾‹ç‰¹å¾å’Œæ‰€æœ‰å‰©ä½™å®ä¾‹ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§åˆ†æ•°ä»¥è·å¾—ç‰¹å¾å‘é‡ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ªä¸¤ç§æ¨¡æ€çš„ä¿¡æ¯ã€‚æœ€åï¼Œå°†ç‰¹å¾å‘é‡å’Œé¡¶éƒ¨æ¿€æ´»å®ä¾‹ç‰¹å¾å‘é‡èåˆï¼Œå¾—åˆ°æ¯ä¸ªæ¨¡æ€çš„bagç‰¹å¾ã€‚æ¯ç§æ¨¡æ€çš„è¢‹å­ç‰¹å¾é€šè¿‡çº¿æ€§å±‚æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¢‹å­ç‰¹å¾ã€‚\nMulti Res Trans Net - 2023 Multi-scale SE-ResBlock + Transformer Encoder\nMulti-scale SE-residual network with transformer encoder for myocardial infarction classification Applied Soft Computing sci-1\næå–å±€éƒ¨ç‰¹å¾å’Œå…¨å±€ç‰¹å¾\næ¨¡å‹ç»“æ„\nåˆ†æ®µ - ç”¨å…·æœ‰é‡å çš„æ»‘åŠ¨çª—å£\nMulti-scale sample layer\nå¤šå°ºåº¦é‡‡æ ·æ¨¡å— åç§°ä¸é”™\nSE-Resnet Block\nCPC\nGAP(å…¨å±€å¹³å‡æ± åŒ–)å®šä½çš„æ˜¯æ•´ä½“åŒºåŸŸï¼Œè€ŒGMP(å…¨å±€æœ€å¤§æ± åŒ–)å®šä½çš„æ˜¯ç›®æ ‡åŒºåŸŸä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚\nâ­Dual-Branch CNN-Trans + Select - 2023 A token selection-based multi-scale dual-branch CNN-transformer network for 12-lead ECG signal classification\nKnowledge-Based Systems sci-1\næ¨¡å‹ç»“æ„\nRRè¡¨ç¤ºè®¡ç®—ä¸¤ä¸ªåˆ†æ”¯ä¸­CLS tokenä¹‹é—´çš„ç›¸å…³ç³»æ•° =\u003e RR-Loss è¿«ä½¿ä¸¤ä¸ªåˆ†æ”¯æœç€æœ€ç»ˆé¢„æµ‹åŒå‘è€Œè¡Œ\nCNN Blocks\nâƒ+ is element-wise addition\nMSEL\nä¸€èˆ¬é‡‡ç”¨ViTä¸­çš„åµŒå…¥, Conv1Då®ç°\né€šè¿‡ä¸åŒå¤§å°çš„TokenåµŒå…¥,æˆ–è®¸å¯ä»¥æ•è·åˆ°ä¸åŒçš„æ¨¡å¼\nToken Select\nåˆ æ‰å†—ä½™çš„Token,æˆ–è®¸å¯ä»¥åœ¨è®ºæ–‡ä¸­å¯è§†åŒ–ä¸€ä¸‹è‡ªæ³¨æ„åŠ›å›¾,ç›´è§‚çš„æè¿°å†—ä½™\nECGNet - 2018 ECGNet: Deep Network for Arrhythmia Classification\nInception Block + Conv Block Ã— N\nMulti module: LSTM + CNN + AutoEncoder Multi-module Recurrent Convolutional Neural Network with Transformer Encoder for ECG Arrhythmia Classification\nECG Dual-path RNN - 2022/8 Single-lead ECG recordings modeling for end-to-end recognition of atrial fibrillation with dual-path RNN\nBiomedical Signal Processing and Control äºŒåŒº\nSegmentation:\n[batch, 1, L] =\u003e [batch, num_seg, len_seg]\né‡å 50%\nOverlap-Add:\nâ€‹\tSegmentationçš„é€†æ“ä½œï¼Œé‡å ç›¸åŠ \nRNNä¸ºBi-LSTM\nLSTM è¾“å…¥æ•°æ®æ ¼å¼ Batch, num_seq, len_seq\næ®µé—´å»ºæ¨¡ + æ®µå†…å»ºæ¨¡\nå›¾ä¾‹ï¼š\nç±»ä¼¼MLP-Mixerï¼Œç”¨RNNå»ºæ¨¡ä¿¡æ¯èåˆï¼ŒéšçŠ¶æ€ä¼ é€’æ—¶åºä¿¡æ¯\nâ­MINA - Signal Processing 2019 MINA: Multilevel Knowledge-Guided Attention for Modeling Electrocardiography Signals\nåšæ³•ï¼š\nç‰¹å¾å·¥ç¨‹ï¼šä»å¿ƒç”µå›¾æ³¢å½¢ä¸­æå–ä¿¡æ¯ç‰¹å¾ =\u003e ä¼ ç»Ÿæœºå™¨å­¦ä¹ è¿›è¡Œå¤„ç† =\u003e ç»“æœ\næ¢ç´¢P-QRS-T æ³¢çš„å„ç§å¹…åº¦å’ŒæŒç»­æ—¶é—´ç‰¹å¾ï¼ŒåŒ…æ‹¬ç”¨äºåˆ†ç±»çš„å½¢æ€å­¦ å’Œ RR é—´æœŸç‰¹å¾ // Hermiteå˜æ¢å’Œå°æ³¢å˜æ¢\nâ—â—â—ä¾èµ–äºæå–çš„ç‰¹å¾ï¼Œå¾ˆå®¹æ˜“å—åˆ°å™ªå£°å¹²æ‰°ï¼Œç‰¹å¾æ²¡æå–å¥½ï¼Œåç»­å·¥ä½œå¾ˆéš¾è¿›å±•\næ³¨æ„åŠ›å¼•å¯¼ç½‘ç»œå…³æ³¨é‡ç‚¹ ï¼ˆé€šç”¨è‡ªå­¦ä¹ æ³¨æ„åŠ›ï¼‰å’Œï¼ˆèåˆé¢†åŸŸçŸ¥è¯†çš„æ³¨æ„åŠ›ï¼‰\n3çº§æ³¨æ„åŠ›ï¼šï¼ˆèŠ‚æ‹çº§ã€èŠ‚å¾‹çº§å’Œé¢‘ç‡çº§ï¼‰é¢†åŸŸçŸ¥è¯†ç‰¹å¾\nâ­æå–ç‰¹å®šçº§åˆ«çš„é¢†åŸŸçŸ¥è¯†ç‰¹å¾å¹¶ä½¿ç”¨å®ƒä»¬æ¥å¼•å¯¼æ³¨æ„åŠ›ï¼ŒåŒ…æ‹¬å¼•å¯¼æ³¨æ„åŠ›CNNçš„èŠ‚æ‹å½¢æ€çŸ¥è¯†å’Œå¼•å¯¼æ³¨æ„åŠ›RNNçš„èŠ‚å¥çŸ¥è¯†\nâ­è·¨æ—¶åŸŸå’Œé¢‘åŸŸè¿›è¡Œæ³¨æ„åŠ›èåˆ\nèŠ‚æ‹çº§ï¼šä¸»è¦è€ƒè™‘å¼‚å¸¸çš„æ³¢å½¢æˆ–è¾¹ç¼˜ã€‚çŸ¥è¯†å¼•å¯¼çš„æ³¨æ„åŠ›æ¥èšåˆè¿™äº›ç‰¹å¾å¹¶è·å¾—èŠ‚æ‹çº§åˆ«æ³¨æ„åŠ›\nâ€‹\tå·ç§¯ç¥ç»ç½‘ç»œ (CNN) ç”¨äºå­¦ä¹ èŠ‚æ‹çº§åˆ«æ¨¡å¼\nèŠ‚å¾‹çº§ï¼šè€ƒè™‘å¼‚å¸¸èŠ‚å¾‹å˜åŒ–\nâ€‹\tå¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰é€‚åˆæ•è·èŠ‚å¾‹ç‰¹å¾\næå–ç‰¹å®šçº§åˆ«çš„é¢†åŸŸçŸ¥è¯†ç‰¹å¾å¹¶ä½¿ç”¨å®ƒä»¬æ¥å¼•å¯¼æ³¨æ„åŠ›ï¼ŒåŒ…æ‹¬æŒ‡å¯¼æ³¨æ„åŠ› CNN çš„èŠ‚æ‹å½¢æ€çŸ¥è¯†å’ŒæŒ‡å¯¼æ³¨æ„åŠ› RNN çš„èŠ‚å¥çŸ¥è¯†\nè¯†åˆ«å…³é”®èŠ‚æ‹ä½ç½®ã€æ˜¾ç€çš„èŠ‚å¾‹å˜åŒ–ã€é‡è¦çš„é¢‘ç‡åˆ†é‡\nçŸ¥è¯†ç‰¹å¾ ä½œç”¨äº ç½‘ç»œç‰¹å¾\nç‰¹å®šçº§åˆ«çš„é¢†åŸŸçŸ¥è¯†ç‰¹å¾ - å¼•å¯¼æ³¨æ„åŠ›\nBeat Level\râ€‹\tä¸»è¦è€ƒè™‘å¼‚å¸¸æ³¢å½¢æˆ–æ€¥å‰§å˜åŒ–çš„ç‚¹ =\u003e è®¡ç®—ä¸€é˜¶å·®åˆ† Î” å’Œæ¯ä¸ªç‰‡æ®µ s ä¸Šçš„å·ç§¯è¿ç®—\nâ€‹\tä¸€é˜¶å·®åˆ†ï¼š ç”¨æ¥æå–ä¿¡å·çš„å˜åŒ–è¶‹åŠ¿å’Œç‰¹å¾\nâ€‹\tRhythm Level\râ€‹\tè®¡ç®—æ¯ä¸ªç‰‡æ®µçš„æ ‡å‡†å·®ï¼Œä»¥æå–èŠ‚å¥æ°´å¹³çŸ¥è¯†ç‰¹å¾å‘é‡\nâ€‹\tæ ‡å‡†å·®ï¼šè¡¡é‡ä¿¡å·çš„ç¨³å®šæ€§ã€æ£€æµ‹å¼‚å¸¸å€¼ã€æè¿°ä¿¡å·æ³¢åŠ¨æ€§ã€æ¯”è¾ƒä¸åŒä¿¡å·ä¹‹é—´çš„æ³¢åŠ¨ç¨‹åº¦\nFrequency Level\râ€‹\tèƒ½é‡è¶Šå¤§çš„ä¿¡å·åŒ…å«çš„ä¿¡æ¯è¶Šå¤šï¼ŒåŠŸç‡è°±å¯†åº¦ï¼ˆPSDï¼‰æ¥æå–é¢‘ç‡çº§çŸ¥è¯†ç‰¹å¾å‘é‡\nâ€‹\té¢‘è°±åˆ†æå¯ä»¥è¾…åŠ©äº†è§£ä¿¡å·åœ¨ä¸åŒé¢‘ç‡ä¸‹çš„æˆåˆ†å’Œèƒ½é‡åˆ†å¸ƒæƒ…å†µ\nâ€‹\tåŠŸç‡è°±å¯†åº¦ä¼°è®¡æ˜¯è®¡ç®—ä¿¡å·åŠŸç‡åœ¨é¢‘åŸŸä¸Šçš„åˆ†å¸ƒ\nâ€‹\tä¾‹ï¼š100HzECGæ®µæ•°æ® =\u003e periodogram(ä¼°è®¡ä¿¡å·çš„åŠŸç‡è°±å¯†åº¦çš„å‡½æ•°) =\u003e è¿”å›é¢‘ç‡èŒƒå›´(0-50Hz)å’Œå¯¹åº”çš„åŠŸç‡å€¼ =\u003e sum() æ€»é¢‘è°±å¯†åº¦\næ¨¡å‹æ¡†æ¶ï¼š\nInput: å•å¯¼è”å¿ƒç”µä¿¡å·\nFrequency Transformation Layer: å°†ä¿¡å·æŒ‰ç…§é¢‘ç‡åŒºåˆ†å¼€ï¼Œåˆ©ç”¨é«˜é€šæ»¤æ³¢å™¨ã€å¸¦é€šæ»¤æ³¢å™¨ï¼› 0-0.5Hz: ä½é¢‘æ¼‚ç§»ï¼›0.5-50hzï¼šä¸»è¦æˆåˆ†; \u003e50Hz: å™ªå£°\n1### candidate channels for ECG 2P_wave = (0.67, 5) 3QRS_complex = (10, 50) 4T_wave = (1, 7) 5muscle = (5, 50)\t# è‚Œè‚‰å¹²æ‰° 6resp = (0.12, 0.5)\t# å‘¼å¸ä¿¡å· 7! 8 9ECG_preprocessed = (0.5, 50) # ï¼ï¼ï¼ ECGä¸»è¦éƒ¨åˆ† 10wander = (0.001, 0.5)\t# åŸºçº¿æ¼‚ç§» 11noise = 50 12 13# low (wander), middle (ECG_preprocessed) and high (noise) 14bandpass_list = [wander, ECG_preprocessed] 15highpass_list = [noise] Sliding Window Segmentation: å›ºå®šçª—å£ï¼Œé‡å åˆ†æ®µï¼ˆä¸ç”¨å…ˆå®šä½Rå³°å†åˆ†æ®µï¼‰\nè®¡ç®—ä¸€é˜¶å·®å•†ã€æ ‡å‡†å·®ã€åŠŸç‡è°±å¯†åº¦ä¼°è®¡ä½œä¸ºç»Ÿè®¡ç‰¹å¾\nå°†ç»Ÿè®¡ä¿¡æ¯ä½œä¸ºæ³¨æ„åŠ›å¼•å¯¼åµŒå…¥æ¨¡å‹ä¸­ï¼š\nLï¼š ç»è¿‡Convæå–æ®µå†…ä¿¡æ¯åçš„æ•°æ®\nHï¼šç»è¿‡RNNèåˆæ®µé—´ä¿¡æ¯åçš„æ•°æ®\n$$ V^{T} âˆˆ R^{1Ã—D_{Î±}} $$\nå†å°†Î±ä½œç”¨äºç‰¹å¾\næœ€åå°†ä¸åŒé¢‘ç‡åŒºåŸŸçš„è¾“å‡ºConcat é€šé“åœ¨ä¸€èµ·ï¼Œè¿‡é¢‘ç‡æ³¨æ„åŠ›é‡æ–°åŠ æƒ\nSelf-supervised - 2022 Self-supervised representation learning from 12-lead ECG data\nComputers in Biology and Medicine\né—®é¢˜ï¼š\nåŒ»å­¦é«˜è´¨é‡æ ‡ç­¾å¾ˆéš¾è·å¾—ï¼Œæˆæœ¬æ˜‚è´µ å…¬å¼€æ•°æ®é›†ä¸å¤Ÿå¤§ æœªæ ‡è®°æ•°æ®çš„æ•°é‡é€šå¸¸è¿œè¿œè¶…è¿‡æ ‡è®°æ•°æ®çš„æ•°é‡ ç»“åˆNLPã€è§†è§‰ã€è¯­éŸ³åœ¨æ— ç›‘ç£å­¦ä¹ çš„æˆåŠŸ\nâ¬‡ï¸\nåˆ›æ–°ï¼š\nä½¿ç”¨è‡ªç›‘ç£çš„æ–¹æ³•ï¼Œå®ç°ECGè¡¨å¾å­¦ä¹  å¯¹æ¯”å­¦ä¹ CPCæ¡†æ¶ç»“æ„\nä¸ºä»€ä¹ˆç”¨MLPä¸ç”¨CNNï¼Œå› ä¸ºECGé‡‡æ ·é¢‘ç‡ä¸º100Hzæ¯”éŸ³é¢‘å…¸å‹é‡‡ç”¨é¢‘ç‡10 kHzç²—ç³™ï¼Œä½¿ç”¨MLPè¿›è¡Œéçº¿æ€§æ˜ å°„\næ•°æ®é›†ï¼š\nç»“æœ\nè¯„ä»·æŒ‡æ ‡macro AUC\nçº¿æ€§è¯„ä¼°-å†»ç»“æ¨¡å‹å‚æ•°ï¼Œå°†åˆ†ç±»å¤´æ”¹ä¸ºçº¿æ€§å±‚ï¼ŒéªŒè¯æ¨¡å‹å­¦åˆ°çš„ç‰¹å¾è¡¨ç¤ºï¼›\nå¾®è°ƒ-åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šè¿›è¡Œå¾®è°ƒåˆ†ç±»å¤´å’Œéƒ¨åˆ†å‚æ•°ã€‚\né¢„è®­ç»ƒçš„è¡¨ç¤ºä¸ä¸‹æ¸¸åˆ†ç±»ä»»åŠ¡é«˜åº¦ç›¸å…³\nè‡ªç›‘ç£é¢„è®­ç»ƒæé«˜äº†ä¸‹æ¸¸åˆ†ç±»å™¨çš„ç¨³å¥æ€§\nè¡¨æ˜åœ¨å¤§æ•°æ®é›†ä¸Šé¢„è®­ç»ƒï¼Œåœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸­ï¼Œéœ€è¦æ›´å°‘çš„æ ‡ç­¾æ•°æ®å°±å¯ä»¥è¾¾åˆ°æœ‰ç›‘ç£è®­ç»ƒçš„æ•ˆæœ\nMulti-scale Progressive Gated Transformer Multi-scale Progressive Gated Transformer for Physiological Signal Classification\nåˆ†ä¸¤æ­¥ï¼š\nç»†ç²’åº¦æ•è·å±€éƒ¨æ³¢å½¢å˜åŒ– ç²—ç²’åº¦æ•è·å…¨å±€è¶‹åŠ¿å˜åŒ– æ¡†æ¶ï¼š\nä½¿ç”¨Conv-MaxPool-Conv-AvgPool å®ç°åµŒå…¥\nå †å  MHSA-FFN-TCN-FFN æ¨¡å— (Temporal Convolution Net)\nåˆ†æ”¯èåˆï¼šx1 â¨‚ sigmoid(tanh(fc(x1))) + x2\nCLOCS - ICML 2021 Contrastive Learning of Cardiac Signals Across Space, Time, and Patients\nå¯¹æ¯”ï¼šæ—¶é—´-ç©ºé—´-æ‚£è€…\nFigureï¼šï¼ˆå·¦ï¼‰å¯¹æ¯”å¤šæ®µç¼–ç ã€ï¼ˆä¸­ï¼‰å¯¹æ¯”å¤šå¯¼è”ç¼–ç å’Œï¼ˆå³ï¼‰å¯¹æ¯”å¤šæ®µå¤šå¯¼è”ç¼–ç ä¸­çš„Kä¸ªå®ä¾‹çš„å°æ‰¹é‡çš„ç›¸ä¼¼æ€§çŸ©é˜µã€‚å°†åŸºäºæ‰€æœ‰åº”ç”¨çš„å˜æ¢è¿ç®—ç¬¦TAå’ŒTBå¯¹ç”Ÿæˆé™„åŠ çŸ©é˜µã€‚æ²¿ç€è¾¹ç¼˜æ²¿ç€ç¤ºå‡ºäº†ç¤ºä¾‹æ€§å˜æ¢çš„ECGå®ä¾‹ã€‚ä¸ºäº†è¯†åˆ«é˜³æ€§å¯¹ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªå®ä¾‹ä¸å…¶æ‚£è€…IDç›¸å…³è”ã€‚é€šè¿‡è®¾è®¡ï¼Œå¯¹è§’å…ƒç´ ï¼ˆç»¿è‰²ï¼‰å¯¹åº”äºåŒä¸€æ‚£è€…ï¼Œæœ‰åŠ©äºç­‰å¼2.ç±»ä¼¼åœ°ï¼Œå®ä¾‹1å’Œå®ä¾‹50ï¼ˆé»„è‰²ï¼‰å±äºåŒä¸€æ‚£è€…ï¼Œæœ‰åŠ©äºç­‰å¼ï¼ˆ1ï¼‰ã€‚3.è“è‰²åŒºåŸŸå¯¹åº”äºé˜´æ€§ç¤ºä¾‹ï¼Œå› ä¸ºå®ƒä»¬æ¶‰åŠæ¥è‡ªä¸åŒæ‚£è€…çš„å®ä¾‹ã€‚\næ•°æ®åˆ’åˆ†ï¼š\n1frame = torch.tensor(input_frame,dtype=torch.float) 2label = torch.tensor(label,dtype=torch.float) 3frame = frame.unsqueeze(0) #(1,5000,12) #SxL = Samples x Leads 4frame_views = torch.empty(1,2500,self.nviews*2) #nviews = nleads in this case (1x2500x12*nsegments) 5nsegments = frame.shape[1]//2500 6fcount = 0 7for n in range(self.nviews): #nviews = # of leads 8 for s in range(nsegments): 9 start = s*2500 10 current_view = frame[0,start:start+2500,n] 11 current_view = self.obtain_perturbed_frame(current_view) 12 current_view = self.normalize_frame(current_view) 13 frame_views[0,:,fcount] = current_view 14 fcount += 1 15# =\u003e (1, 2500, 24) â­CMSMLC(Contrastive Multi-segment Multi-lead Coding)\nLossåˆ†æï¼š\n1pids = ['1', '2', '1', '3'] # patient id 2data = [4, feature_dim, 4] # batch, dim_feature, nviews 3 4# 1. å…ˆæ ‡è®°ç›¸åŒæ‚£è€…çš„æ ·æœ¬ 5 6# 2. è®¡ç®—å„ä¸ªè§†å›¾çš„ç›¸ä¼¼æ€§ 7view_combinations = combinations(nviews,2) 8# (0,1), (0,2), (0,3) 9# (1,2), (1,3) 10# (2,3) 11loss = 0 12ncombinations = 0 13for combination in view_combinations: 14 view1 = data[:, :, combination[0]] 15 view2 = data[:, :, combination[1]] 16 norm1_vector = view1_array.norm(dim=1).unsqueeze(0) 17 norm2_vector = view2_array.norm(dim=1).unsqueeze(0) 18 sim_matrix = torch.mm(view1,view2.transpose(0,1)) 19 norm_matrix = torch.mm(norm1_vector.transpose(0, 1), norm2_vector) 20 argument = sim_matrix / (norm_matrix * temperature) # temperature=0.1 21 sim_matrix_exp = torch.exp(argument) 22 23 # obtain element 24 triu_elements = sim_matrix_exp[rows1,cols1] # upper triangle 25 tril_elements = sim_matrix_exp[rows2,cols2] # lower triangle 26 diag_elements = torch.diag(sim_matrix_exp) # ä¸»å¯¹è§’ 27 28 triu_sum = torch.sum(sim_matrix_exp,1) 29 tril_sum = torch.sum(sim_matrix_exp,0) 30 31 loss_diag1 = -torch.mean(torch.log(diag_elements/triu_sum)) # A =\u003e B 32 loss_diag2 = -torch.mean(torch.log(diag_elements/tril_sum)) # B =\u003e A 33 34 loss_triu = -torch.mean(torch.log(triu_elements/triu_sum[rows1])) # ä¸Šä¸‰è§’å¯¹åº”çš„è¡Œ 35 loss_tril = -torch.mean(torch.log(tril_elements/tril_sum[cols2])) # ä¸‹ä¸‰è§’å¯¹åº”çš„åˆ— 36 37 loss = loss_diag1 + loss_diag2 38 loss_terms = 2 39 40 if len(rows1) \u003e 0: 41 loss += loss_triu #technically need to add 1 more term for symmetry 42 loss_terms += 1 43 44 if len(rows2) \u003e 0: 45 loss += loss_tril #technically need to add 1 more term for symmetry 46 loss_terms += 1 47 48ncombinations += 1 49loss = loss/(loss_terms*ncombinations) # loss/(4*6) æ¯ä¸ªè§†å›¾4ä»½lossï¼Œæ€»å…±ç®—6å¯¹ GUIDING MASKED REPRESENTATION LEARNING - ICLR 2024 â­å¿ƒç”µå›¾è¿›è¡Œç®€å•çš„æ•°æ®å¢å¼ºä¹Ÿå¯èƒ½ä¼šä¸¥é‡æ”¹å˜ç—…ç†ä¿¡æ¯\nâœ”ï¸åˆ©ç”¨MAEæ–¹æ³•ï¼Œç”Ÿæˆå¼è‡ªç›‘ç£å­¦ä¹ \n3ç§åµŒå…¥æ–¹å¼ï¼Œæ—¶é—´-ç©ºé—´-æ—¶ç©º\næ¨¡å‹ï¼š\nposition embeddingsï¼š ä½¿ç”¨åŒä¸€ç»„ä½ç½®-å…±äº«\nlead-embeddings: æ¯ä¸ªå¯¼è”ä¸“ç”¨-æ ‡è®°å¯¼è”ç¼–å·\n[SEP]: åŒºåˆ†å„ä¸ªå¯¼è”Patch\nä¸ºäº†å¢åŠ é‡å»ºéš¾åº¦ï¼š\nDecoderéƒ¨åˆ†åªçœ‹åŒä¸€å¯¼è”çš„Patchï¼›=\u003e ç¡®ä¿é‡å»ºæ—¶ä¸ä¼šæ˜¾å¼ä½¿ç”¨å…¶ä»–å¯¼è”çš„åµŒå…¥ =\u003e è¿«ä½¿æ¨¡å‹æœ‰æ•ˆåœ°å­¦ä¹ æ—¶ç©ºè¡¨ç¤º ä»£ç åˆ†æï¼š\n1# x: [batch, 12, 2250] 2x = series 3# === forward_encoder === 4x = patch_embedding(x) # segment-\u003eLN-\u003eLinear-\u003eLN, =\u003e [batch, 12, 30, 75] 5x = x + pos_embedding[:, 1:n + 1, :].unsqueeze(1) # lead-inter shared pos embedding 6 7# mask 8len_keep = int(n * (1 - mask_ratio)) 9ids_shuffle # [batch, 12, 30] æ®µç¼–å·æ‰“ä¹± 10ids_restore # æ®µç¼–å·åŸå§‹é¡ºåº 11 12ids_keep = ids_shuffle[:, :, :len_keep] 13x_masked = torch.gather(x, dim=2, index=ids_keep.unsqueeze(-1).repeat(1, 1, 1, d)) 14mask = torch.ones([b, num_leads, n], device=x.device) 15mask[:, :, :len_keep] = 0 16# === x_masked, mask, ids_restore === 17 18# embedding 19x = torch.cat([left_sep, x, right_sep], dim=2) 20lead_embeddings = lead_embeddings.unsqueeze(2).expand(b, -1, n_masked_with_sep, -1) 21x = x + lead_embeddings # lead-intra shared lead embedding 22 23# Transformer Encoder x 12 24x = encoder(x) 25 26# === forward_decoder === 27x = self.to_decoder_embedding(x) # ç»´åº¦æ˜ å°„ 28 29# åˆå§‹åŒ–è¢«maskæ‰çš„patch 30mask_embeddings = self.mask_embedding.unsqueeze(1) 31mask_embeddings = mask_embeddings.repeat(b, self.num_leads, n + 2 - n_masked_with_sep, 1) 32 33x_wo_sep = torch.cat([x[:, :, 1:-1, :], mask_embeddings], dim=2) # [X..,masked,..] 34x_wo_sep = torch.gather(x_wo_sep, dim=2, index=ids_restore.unsqueeze(-1).repeat(1, 1, 1, d)) # æ¢å¤ä½ç½® 35 36x_wo_sep = x_wo_sep + self.decoder_pos_embed[:, 1:n + 1, :].unsqueeze(1) # é‡æ–°æ·»åŠ ä½ç½®ä¿¡æ¯ 37left_sep = x[:, :, :1, :] + self.decoder_pos_embed[:, :1, :].unsqueeze(1) 38right_sep = x[:, :, -1:, :] + self.decoder_pos_embed[:, -1:, :].unsqueeze(1) 39x = torch.cat([left_sep, x_wo_sep, right_sep], dim=2) 40 41x_decoded = [] 42for i in range(self.num_leads): 43 x_lead = x[:, i, :, :] 44 for block in self.decoder_blocks: # Transformer Encoder x 6 45 x_lead = block(x_lead) 46 x_lead = self.decoder_norm(x_lead) 47 x_lead = self.decoder_head(x_lead) 48 x_decoded.append(x_lead[:, 1:-1, :]) 49pred = torch.stack(x_decoded, dim=1) 50 51# === loss === 52target = self.patchify(series) 53 54loss = (pred - target) ** 2 55loss = loss.mean(dim=-1) # (batch_size, num_leads, n), mean loss per patch 56 57loss = (loss * mask).sum() / mask.sum() # mean loss on removed patches 58# mask: [batch, 12, 30], å…¶ä¸­1ä»£è¡¨è¢«maskï¼Œ0è¡¨ç¤ºæ²¡æœ‰è¢«mask å¾®è°ƒæ—¶å–Encoderéƒ¨åˆ†\nå®éªŒ InceptionFormer InceptionNeXt + SMT\nå›¾ç¤ºä»¿ç…§SMTé£æ ¼ç»˜åˆ¶\nä»¿ç…§SMTçš„æ¸è¿›èåˆç½‘ç»œç»“æ„ å‰åŠéƒ¨åˆ†ä½¿ç”¨ InceptionNeXtç»“æ„å—ï¼ŒDConvå·ç§¯ä»£æ›¿MHSA 1# æ¨¡å‹ FLOPs: 2.14G 2# æ¨¡å‹å‚æ•°æ•°é‡: 12.45M 3 4cnnblock = StemConv() # 1, 12, 1000 5# æ¨¡å‹ FLOPs: 36.74M 6# æ¨¡å‹å‚æ•°æ•°é‡: 36.72K 7CNNBlock1 = getattr(model, 'block0') # 1, 64, 1000 8# æ¨¡å‹ FLOPs: 35.07M 9# æ¨¡å‹å‚æ•°æ•°é‡: 35.07K 10CNNBlock2 = getattr(model, 'block1') # 1, 128, 500 11# æ¨¡å‹ FLOPs: 135.68M 12# æ¨¡å‹å‚æ•°æ•°é‡: 271.36K 13MixBlock = getattr(model, 'block2') # 1, 256, 250 14# æ¨¡å‹ FLOPs: 793.09M 15# æ¨¡å‹å‚æ•°æ•°é‡: 3.18M 16MHSABlock = getattr(model, 'block3') # 1, 512, 125 17# æ¨¡å‹ FLOPs: 1.05G 18# æ¨¡å‹å‚æ•°æ•°é‡: 8.41M æ¨¡å‹æ¡†æ¶ æ¨¡å‹æ¡†æ¶\rStem æ¨¡å—ï¼š\nå‚è€ƒï¼šA token selection-based multi-scale dual-branch CNN-transformer ä¸€åŒºè®ºæ–‡\næ ‡å‡†ä¸€ç»´å·ç§¯ï¼Œå¤šå°ºåº¦æå–ç‰¹å¾ï¼Œæå–ECGå½¢æ€ä¿¡æ¯ã€‚å…¨é¢æå–ï¼ˆæºå¸¦å†—ä½™ä¿¡æ¯ï¼‰ # shape: 12, 1000 =\u003e 128ï¼Œ1000\nBlockï¼š\nPatch Fusion:\nâ€‹\tä½¿ç”¨Conv1Dï¼Œkernel_size=3ï¼Œstride=2, padding=1 =\u003e é‡å å¼åµŒå…¥ï¼Œå‡å°‘Tokenæ•°é‡ï¼Œå¢åŠ Tokenç»´åº¦(å¢åŠ Tokenæºå¸¦ä¿¡æ¯çš„ä¸°å¯Œåº¦)\nå›¾ç¤ºï¼š â‘ Tokené—´ â‘¡Tokenå†…\nè‡ªæ³¨æ„åŠ› åœ¨InceptionFormerä¸Šå®éªŒ\nMulti Head Self Attention 1Test\tBest F1: 0.8410 2Validate Best F1: 0.8184 SR-MHSA ä½¿ç”¨Conv1D stride=2 ç¼©å°Kï¼ŒVçš„TokenMapï¼Œå‡å°‘Tokenæ•°é‡\nsr-ratio = 2\n1Test\tBest F1: 0.8137 2Validate Best F1: 0.8216 Bi-Routing Attention â€“ SRä¸æ ‡å‡†çš„æŠ˜ä¸­\nè¶…å‚ï¼šnum_window=25ï¼Œtopk=10\n1Test\tBest F1: 0.8344 2Validate Best F1: 0.8199 Window Attention â€“ å•çº¯çª—å£çº§\tâŒå¤šä½™çš„ç‰ˆæœ¬ - ä¸å¦‚MobileViTBlock â—æ²¡åŠ CNNå…ˆå±€éƒ¨èåˆ\n1Test\tBest F1: 0.8261 2Validate Best F1: 0.8148 Shift Window Attention æ„Ÿè§‰æœ‰ç‚¹é—®é¢˜ï¼Œæ•ˆæœä¸å¦‚ WAï¼Œæ··åˆç»“æ„çš„é—®é¢˜ï¼Ÿå‰é¢è¿›è¡Œçš„äº¤é”™çš„CNNå’ŒMHSAï¼Ÿ\n1Test\tBest F1: 0.8129 2Validate Best F1: 0.8100 çº§è”åˆ é™¤Tokenå’Œä¿®å‰ªHead å»æ‰å†—ä½™çš„ â—æœªæµ‹è¯•\nä½ç½®åµŒå…¥ å‰æœŸç›´æ¥èè¿›Tokenä¸­ â€“ ViT ä»…ä¸€æ¬¡ â€‹\tä¾‹ï¼šdata: [batch, num_token, dim_token] learnable_pos_embed: [batch, num_token, dim_token]\nâ€‹\tdata + pos_embed\næ³¨æ„åŠ›è®¡ç®—ä¸­å¼•å…¥ â€“ SwinT æ¯æ¬¡ â€‹\tä¾‹ï¼š att:[num_token, num_token] + relative_pos_bias:[num_token, num_token]\nâ€‹\tè®©ç›¸å¯¹ä½ç½®ä¿¡æ¯(è‡ªå­¦ä¹ )å½±å“æ³¨æ„åŠ›æƒé‡\nDWConv å¼•å…¥å±€éƒ¨ä½ç½®ä¿¡æ¯ / åœ¨è®¡ç®—å®Œè‡ªæ³¨æ„åŠ›å‰ â€“ Bi-Routing-Attention æ¯æ¬¡ â€‹\tä¾‹ï¼š DWConv(x) + EncoderBlock(x)\nDWConvå¢å¼ºä½ç½®ä¿¡æ¯ / åœ¨è®¡ç®—å®Œè‡ªæ³¨æ„åŠ›ä¸­ â€“ Bi-Routing-Attention æ¯æ¬¡ â€‹\tä¾‹ï¼š SoftMax(Q@K.T/âˆšd)@ (V + DWConv(V) )\nç°å­˜é—®é¢˜ â­æ²¡æœ‰ä¸ºMHSAè®¡ç®—æ—¶æ·»åŠ ä½ç½®ä¿¡æ¯\nDWConv ä»£æ›¿ä½ç½®ç¼–ç  MHSAä¹‹å‰åŠ å…¥å¯å­¦ä¹ çš„ä½ç½®å‘é‡ æ¸è¿›å¼æ¨¡å—èåˆç­–ç•¥\näº¤é”™ å¹¶è¡Œï¼Ÿ æ²¡æœ‰ä¼˜åŒ–è‡ªæ³¨æ„åŠ›çš„è®¡ç®—\nDConvçš„ä¼˜åŒ–\nInceptionFormer + å·ç§¯è°ƒåˆ¶ InceptionNeXtBlock =\u003e ConvModulation =\u003e MHSA\nå·ç§¯ =\u003e å·ç§¯Ã—è°ƒåˆ¶ =\u003e è°ƒåˆ¶Ã—è‡ªæ³¨æ„åŠ› =\u003e è‡ªæ³¨æ„åŠ›\nx2 x4 x8 x4\n1acc: 0.8299, f1: 0.8418, macro_auc: 0.9679 2classes: ['I-AVB' 'AF' 'LBBB' 'RBBB' 'NORM' 'PAC' 'STD' 'STE' 'PVC'] 3test f1s: [0.9252, 0.9231, 0.902, 0.9477, 0.8261, 0.6733, 0.8161, 0.7805, 0.782] å…¨å±€å¹³å‡æ± åŒ– =\u003e CLS Token\nâ—Validate F1 score only 0.8185\t# ç¨³å¥æ€§ä¸€èˆ¬\n1acc: 0.8343, f1: 0.8488, macro_auc: 0.9677 threshold: 0.8 2classes: ['I-AVB' 'AF' 'LBBB' 'RBBB' 'NORM' 'PAC' 'STD' 'STE' 'PVC'] 3F1 Scores: [0.9028, 0.9587, 0.9412, 0.9444, 0.7861, 0.7308, 0.8046, 0.7895, 0.7813 âŒPAC ä»ç„¶æ”¹å–„ä¸äº†\næ³¨æ„åŠ›å¯è§†åŒ– InceptionFormer + Shunt Shunt Self Attention =\u003e InceptionFormer\nåœ¨å¤šå¤´éƒ¨åˆ†åµŒå…¥å¤šå°ºåº¦ã€‚8å¤´è‡ªæ³¨æ„åŠ›ï¼Œ 1/2å¤´æ‰§è¡Œåƒç´ çº§è‡ªæ³¨æ„åŠ›ï¼Œ1/4å¤´æ‰§è¡Œä¸‹é‡‡æ ·2å€çš„å—çº§è‡ªæ³¨æ„åŠ›ï¼Œ1/4å¤´æ‰§è¡Œä¸‹é‡‡æ ·4å€çš„åŸŸçº§è‡ªæ³¨æ„åŠ›\nåœ¨è®¡ç®—è‡ªæ³¨æ„åŠ›æ—¶ï¼Œå®ç°å¤šå°ºåº¦\n1acc: 0.8154, f1: 0.8389, macro_auc: 0.9682 2classes: ['I-AVB' 'AF' 'LBBB' 'RBBB' 'NORM' 'PAC' 'STD' 'STE' 'PVC'] 3F1 Scores: [0.9065, 0.9283, 0.8511, 0.9296, 0.7865, 0.6531, 0.8193, 0.8421, 0.8333] â—PAC\nInceptionFormer: MS-DWConv + MHSA\n1éªŒè¯é›†: 9-Fold, æµ‹è¯•é›†: 10-Fold. 2 3Acc: 0.8328, F1: 0.8530, Auc: 0.9701, Threshold: 0.4, Test_loss: 0.2225 4F1s: ['0.8936', '0.9219', '0.9200', '0.9505', '0.8298', '0.6972', '0.8315', '0.8000', '0.8321'] 5 6Acc: 0.7918, F1: 0.8247, Auc: 0.9564, Threshold: 0.9, Vali_loss: 0.2764 7F1s: ['0.8971', '0.9160', '1.0000', '0.9020', '0.7831', '0.6981', '0.7600', '0.6154', '0.8504'] 8 9# æ­¤å¤„ï¼Œä»…å–å¹³å‡ï¼Œæœ€ç»ˆåº”è¯¥ç»„åˆåœ¨ä¸€èµ·è¿›è¡Œæµ‹è¯•ï¼Œå› ä¸ºé˜ˆå€¼ä¸ä¸€è‡´ 10Acc: 0.8123, F1: 0.8388, Auc: 0.9633 Average Test and Validate 11F1s: ['0.8953', '0.9189', '0.9600', '0.9263', '0.8064', '0.6977', '0.7957', '0.7077', '0.8413'] 12 13# æ¨¡å‹ FLOPs: 2.14G 14# æ¨¡å‹å‚æ•°æ•°é‡: 12.45M InceptionFormer: MS-DWConv + S-MHSA\nâŒæ•°æ®æ•æ„Ÿ\n1éªŒè¯é›†: 9-Fold, æµ‹è¯•é›†: 10-Fold. 2 3Acc: 0.8125, F1: 0.8204, Auc: 0.9686, Threshold: 0.6, Test_loss: 0.2426 4F1s: ['0.8467', '0.9143', '0.8800', '0.9344', '0.8021', '0.6355', '0.8452', '0.7368', '0.7883'] 5 6Acc: 0.7918, F1: 0.8163, Auc: 0.9556, Threshold: 0.8, Vali_loss: 0.2814 7F1s: ['0.8841', '0.8934', '0.9778', '0.9091', '0.7340', '0.7037', '0.7925', '0.5946', '0.8571'] 8 9Acc: 0.8022, F1: 0.8183, Auc: 0.9621 Average Test and Validate 10F1s: ['0.8654', '0.9039', '0.9289', '0.9218', '0.7681', '0.6696', '0.8188', '0.6657', '0.8227'] InceptionFormer: MS-DWConv-SE + MHSA\nè‡ªåŠ¨é‡æ–°æ ¡å‡† - é€šé“é‡è¦æ€§\n1Validate: Acc:0.788937409\tF1:0.819458854\t2Test : Acc:0.827034884\tF1:0.835588466 InceptionFormer: MS-DWConv-CA + MHSA\nåŒæ—¶æ ¡å‡† é€šé“ + ç©ºé—´ é‡è¦æ€§\n1Validate: Acc:0.7991\tF1:0.8315 2Test : Acc:0.8096\tF1:0.8194 InceptionFormer: only front 3 stage\nåˆ é™¤ç¬¬å››stageï¼Œé™ä½å‚æ•°\n1# Best F1: 0.8395 Only front 3 layer 2# æ¨¡å‹ FLOPs: 1.04G 3# æ¨¡å‹å‚æ•°æ•°é‡: 3.64M InceptionFormer: stage depth [2, 4, 8, 4] =\u003e [2, 4, 8, 2]\nå‡å°‘stage4å±‚æ•°\n1# stage depths = [2, 4, 8, 2] 2# Best F1: 0.8422 3# æ¨¡å‹ FLOPs: 1.61G 4# æ¨¡å‹å‚æ•°æ•°é‡: 8.25M InceptionFormer + SparseSemanticToken\nå‡å°‘Token\n1# Best F1: 0.8312 sparse token -- DW-SpatialPool 2# æ¨¡å‹ FLOPs: 1.53G 3# æ¨¡å‹å‚æ•°æ•°é‡: 17.19M 4 5SparseAttentionBlock: 6# æ¨¡å‹ FLOPs: 236.95M 7# æ¨¡å‹å‚æ•°æ•°é‡: 4.74M InceptionFormerTiny\nå‡å°‘Tokené•¿åº¦ dim_token: [64, 128, 256, 512] =\u003e [32, 64, 128, 256]\n1# Best F1: 0.8265 2# æ¨¡å‹ FLOPs: 536.07M 3# æ¨¡å‹å‚æ•°æ•°é‡: 3.13M â­â­â­\nBaseline\n1# resnet18 2æ¨¡å‹ FLOPs: 176.57M 3æ¨¡å‹å‚æ•°æ•°é‡: 3.85M 4Best F1: 0.8168 5 6# resnet34 7æ¨¡å‹ FLOPs: 357.74M 8æ¨¡å‹å‚æ•°æ•°é‡: 7.23M 9Best F1: 0.8185 10 11# mobilenetv2 12æ¨¡å‹ FLOPs: 96.60M 13æ¨¡å‹å‚æ•°æ•°é‡: 2.19M 14Best F1: 0.7967\tPTB-XL - æ¨è9æŠ˜éªŒè¯ 10æŠ˜æµ‹è¯•\nCPSC - (æ¯”èµ›) 9æŠ˜éªŒè¯ 10æŠ˜æµ‹è¯•\nä¼˜åŒ–å™¨è°ƒæ•´\nAdamw + StepLR =\u003e Adamw + CosineAnnealingLR\nå›ºå®šæ­¥é•¿è¡°å‡å­¦ä¹ ç‡ =\u003e ä½™å¼¦é€€ç«è°ƒæ•´å­¦ä¹ ç‡\nAdamw + StepLRï¼š\n1# scheduler 2lr = 1e-3 3step_size = 20 4step_gamma = 0.1 Adamw + CosineAnnealingLR\nPASS\né¢‘åŸŸç‰¹å¾ æ•°æ®çš„å¦ä¸€ç§è¡¨è¾¾å½¢å¼ï¼Œæˆ–è€…åœ¨è¿™ä¸ªæ ¼å¼ä¸­ï¼ŒæŸäº›ç‰¹å¾ä¼šè¢«æ”¾å¤§ï¼Œä½¿å¾—å¯ä»¥è¢«è¯†åˆ«åˆ°\ntime domain I-AVB AF LBBB LBBB NORM PAC STD PVC STE å¹³å‡ æè¿° F1 0.8844 0.9231 0.8800 0.9500 0.7514 0.6392 0.8024 0.7692 0.7669 0.8185 æ—¶åºä¿¡å· \u0026 ä¸€ç»´æ¨¡å‹ frequency domain 1# [batch_size, num_leads, data_length] =STFT=\u003e [batch_size, num_leads, W, H] 2# =\u003e resnet34 3# =\u003e output I-AVB AF LBBB LBBB NORM PAC STD PVC STE å¹³å‡ æè¿° F1 0.7763 0.9180 0.8511 0.8889 0.7684 0.6393 0.7500 0.7671 0.7805 0.7933 æ—¶åºä¿¡å·é€šè¿‡STFTè½¬ä¸ºé¢‘è°±å›¾(æ±‰æ˜çª—å£100) two-stream: time and frequency domain I-AVB AF LBBB LBBB NORM PAC STD PVC STE å¹³å‡ æè¿° F1 0.8993 0.9255 0.9020 0.9326 0.7817 0.7040 0.8000 0.7805 0.7619 0.8319 æ—¶åºä¿¡å·é€šè¿‡STFTè½¬ä¸ºé¢‘è°±å›¾(çª—å£100) InceptionNeXt + Shunted-Self Attention ï¼ˆCross-Stackï¼‰ 1ï¸âƒ£\nInception depthwise convlution\n2ï¸âƒ£\nSelf-Attention å†…éƒ¨å®ç°ç²—ç»†ç²’åº¦\n3ï¸âƒ£\nç‰¹å¾å›¾ =\u003e é‡‘å­—å¡”ç»“æ„ ï¼ˆä¸­é—´CNNå’ŒTransformerèåˆï¼Œäº¤å‰å †å ï¼‰\n1classes: 2 ['I-AVB' 'AF' 'LBBB' 'RBBB' 'NORM' 'PAC' 'STD' 'STE' 'PVC'] 3 4 5Test set: 6Acc: 0.9706, F1: 0.8547, Auc: 0.9666, Threshold: 0.5, Test_loss: 0.1813 7Acc: ['0.9797', '0.9782', '0.9913', '0.9738', '0.9506', '0.9549', '0.9593', '0.9913', '0.9564'] 8F1s: ['0.9028', '0.9388', '0.8846', '0.9511', '0.8132', '0.7207', '0.8391', '0.8500', '0.7917'] 9 10Validate set: 11Acc: 0.9596, F1: 0.8105, Auc: 0.9657, Threshold: 0.5, Vali_loss: 0.2111 12F1s: ['0.8750', '0.9333', '0.9787', '0.9016', '0.6989', '0.6504', '0.7545', '0.6818', '0.8201'] 13Train[650 1099 212 1675 826 554 782 198 629] 14Acc: ['0.9738', '0.9767', '0.9985', '0.9476', '0.9185', '0.9374', '0.9403', '0.9796', '0.9636'] CPSC - æ‚£è€…é—´\nè®­ç»ƒé›†åŒ…å« 6,877 ä¸ªï¼ˆå¥³æ€§ï¼š3178 ä¸ª;ç”·æ€§ï¼š3699 ä¸ªï¼‰12 å¯¼è”å¿ƒç”µå›¾è®°å½•ï¼ŒæŒç»­æ—¶é—´ä» 6 ç§’åˆ° 60 ç§’ä¸ç­‰ã€‚\nè®ºæ–‡ä¸­æ˜¯ 1-8 è®­ç»ƒï¼›9 éªŒè¯ï¼›10 æµ‹è¯•ï¼›\nPTB-XL - æ‚£è€…é—´\nåŒ…å«æ¥è‡ª 18885 å 10 ç§’é•¿åº¦æ‚£è€…çš„ 21837 ä¸ªä¸´åºŠ 12 å¯¼è”å¿ƒç”µå›¾\nâ­ ç‰¹å®šæ‚£è€…çš„æ‰€æœ‰è®°å½•éƒ½åˆ†é…ç»™åŒä¸€æŠ˜ã€‚æŠ˜ 9 å’Œ 10 ä¸­çš„è®°å½•è‡³å°‘ç»è¿‡ä¸€æ¬¡äººå·¥è¯„ä¼°ï¼Œå› æ­¤å…·æœ‰ç‰¹åˆ«é«˜çš„æ ‡ç­¾è´¨é‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ 1-8 æŠ˜ ä½œä¸ºè®­ç»ƒé›†ï¼ŒæŠ˜å  9 ä½œä¸ºéªŒè¯é›†ï¼ŒæŠ˜å  10 ä½œä¸ºæµ‹è¯•é›†ã€‚\nChapman-Shaoxin ECG Data - æ‚£è€…é—´\nåŒ…å« 10,646 åæ‚£è€…çš„ 12 å¯¼è”å¿ƒç”µå›¾ï¼Œé‡‡æ ·ç‡ä¸º 500 Hzï¼Œ11 ç§å¸¸è§å¿ƒå¾‹\nç±»åˆ«åˆ†ç»„ï¼š\nResult\ndataset Task F1_macro AUC_macro CPSC arrhythmia | multi-label 0.8547 0.9666 PTB-XL arrhythmia | multi-label 0.5370 0.9552 dataset Task AUC_macro F1_macro Accuracy Recall Precision chapman arrhythmia | multi-class 0.9966 0.9660 0.9699 0.9652 0.9671 multi-label: sigmoidè½¬0-1åŒºé—´ï¼Œç”¨é˜ˆå€¼è¿›è¡Œé¢„æµ‹å€¼äºŒå€¼åŒ–ï¼Œç”Ÿæˆæ ‡ç­¾\nmulti-class: softmaxè½¬æ¦‚ç‡ï¼Œå–æ¦‚ç‡æœ€å¤§çš„ä¸‹æ ‡ä½œä¸ºé¢„æµ‹æ ‡ç­¾\næ•°æ®å¢å¼ºï¼š\néšæœºmaskæŸå¯¼è”\néšæœºmaskæŸæ®µ(ä»…å¼€å¤´æˆ–ç»“å°¾)\nå¢åŠ éšæœºå™ªå£°\næ²¡å•¥ç”¨\næ±‡æ€» å®éªŒç»“æœ 1ï¸âƒ£ CNNï¼šä¼˜åŠ¿=\u003eå¼ºå¤§çš„æå–å±€éƒ¨æ¨¡å¼çš„èƒ½åŠ›ï¼› =\u003e æå‡ºå±€éƒ¨ç»†èŠ‚ï¼Œè¾¹ç¼˜ï¼Œçº¹ç†æ¨¡å¼ä¿¡æ¯ã€‚ â­ é«˜é¢‘ä¿¡æ¯\nâ€‹ ä¸è¶³=\u003eéœ€è¦å †å å¾ˆæ·±ï¼Œæ„Ÿå—èŒƒå›´æ‰èƒ½å»¶ç”³åˆ°å…¨å±€ï¼› =\u003e æ„ŸçŸ¥å…¨å±€å¼±åŠ¿\n2ï¸âƒ£ Transformerï¼š ä¼˜åŠ¿=\u003eå…¨å±€æ„Ÿå—é‡ï¼Œä¸å¤Ÿæ•´ä½“å¤–è²Œèƒ½åŠ›å¾ˆå¼º; â­ ä½é¢‘ä¿¡æ¯\nâ€‹\tä¸è¶³=\u003eçœ‹çš„å¤ªå¤šï¼Œå¹²æ‰°å¤ªå¤šï¼Œå¯¹å±€éƒ¨ç»†èŠ‚æ¨¡å¼æ•è·èƒ½åŠ›è¾ƒå¼±ã€‚\næ¨¡å‹æ’å›¾ BlockåŸºæœ¬ç»“æ„ InceptionNext DConv: æ ¹æ®é€šé“åˆ†ç»„ï¼Œæ¯ç»„ä½¿ç”¨ä¸åŒå·ç§¯æ ¸å¤§å°çš„DWConv\nInceptionMHSALinear Local Block å’Œ Global Block çº¿æ€§æ‹¼æ¥\nInceptionFormer Local Block å’Œ Global Block äº¤å‰å †å è¿›è¡Œèåˆ\nInceptionShuntSA ä¸€åŠæ³¨æ„åŠ›å¤´æ‰§è¡Œç»†ç²’åº¦æ³¨æ„åŠ›ï¼Œå¦ä¸€åŠå¤´æ‰§è¡Œç²—ç²’åº¦æ³¨æ„åŠ›\nInceptionHiLoSA ä¸€åŠæ³¨æ„åŠ›å¤´æ‰§è¡Œã€çª—å£çº§æ³¨æ„åŠ›ã€‘ï¼Œå¦ä¸€åŠå¤´æ‰§è¡Œã€æ± åŒ–æ³¨æ„åŠ›ã€‘\nğŸ§è¦è°ƒæ•´çª—å£å¤§å° ï¼\nSandwichNet **InceptionFormer, M-DWConv åŠ å…¥å€’æ®‹å·®ç»“æ„ ** (Inverted residual block) åœ¨å¤šå°ºåº¦DWConvå‰åµŒå…¥Conv1Ã—1 æ‰©å¼ é€šé“æ•°ï¼ŒååµŒå…¥Conv1Ã—1 è¿›è¡Œé™ç»´ã€‚\né£æ ¼éå¸¸ç»Ÿä¸€ =\u003e ç®€å•\nSandwichProNet Channel Mixerï¼šGLUï¼Œ DW-FFN\nToken Mixer: ç»†ç²’åº¦å±€éƒ¨ + ç²—ç²’åº¦å…¨å±€\nå †å æ–¹å¼\næ•°æ® Arrhythmia Task\n10s + 100Hz sampling rate\nPTB-XL - Rhythm Task\n1['AFIB', 'AFLT', 'BIGU', 'PACE', 'PSVT', 'SARRH', 'SBRAD', 'SR', 'STACH', 'SVARR', 'SVTAC', 'TRIGU'] 2- 12 class 3 4[ 1362 66 74 266 22 695 573 15074 744 143 24 18] # Train 5[ 152 7 8 28 2 77 64 1674 82 14 3 2] # Test 6 7Train: 18932 8Test : 2098 9Total: 21030 Chapman\n1['AFIB', 'GSVT', 'SB', 'SR'] 2- 4 class 3 4Train [1996. 2069. 3498. 2000.] 5Test [222. 231. 389. 222. ] 6 7Train: 9563 8Test : 1064 9Total: 10627 CPSC-2018\n1['I-AVB' 'AF' 'LBBB' 'RBBB' 'NORM' 'PAC' 'STD' 'STE' 'PVC'] 2- 9 class 3 4Train [ 650 1099 212 1675 826 554 782 198 629] 5Test [ 72 122 24 181 92 61 87 22 70] 6 7Train: 6187 8Test : 688 9Total: 6875 ",
  "wordCount" : "2541",
  "inLanguage": "en",
  "image": "http://longcoding.top/papermod-cover.png","datePublished": "2024-04-19T00:00:00Z",
  "dateModified": "2024-04-19T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "LongWei"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://longcoding.top/posts/learning/ecg_exp/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "LongCoding's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://longcoding.top/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://longcoding.top/" accesskey="h" title="ğ“›ğ“¸ğ“·ğ“°ğ“’ğ“¸ğ“­ğ“²ğ“·ğ“° (Alt + H)">
                <img src="http://longcoding.top/android-icon-48x48.png" alt="" aria-label="logo"
                    height="30">ğ“›ğ“¸ğ“·ğ“°ğ“’ğ“¸ğ“­ğ“²ğ“·ğ“°</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://longcoding.top/index.html" title="ğŸ¡ Home">
                    <span>ğŸ¡ Home</span>
                </a>
            </li>
            <li>
                <a href="http://longcoding.top/archives/" title="ğŸ“ƒ Archives">
                    <span>ğŸ“ƒ Archives</span>
                </a>
            </li>
            <li>
                <a href="http://longcoding.top/tags/" title="ğŸ“‘ Tags">
                    <span>ğŸ“‘ Tags</span>
                </a>
            </li>
            <li>
                <a href="http://longcoding.top/categories/" title="ğŸ—’ï¸ Categories">
                    <span>ğŸ—’ï¸ Categories</span>
                </a>
            </li>
            <li>
                <a href="http://longcoding.top/search/" title="ğŸ” Search">
                    <span>ğŸ” Search</span>
                </a>
            </li>
            <li>
                <a href="http://longcoding.top/about/" title="ğŸ‘¨ğŸ»â€ğŸ“ About Me">
                    <span>ğŸ‘¨ğŸ»â€ğŸ“ About Me</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://longcoding.top/">Home</a>&nbsp;Â»&nbsp;<a href="http://longcoding.top/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      ECGè®ºæ–‡å’Œå®éªŒ
    </h1>
    <div class="post-description">
      ECGå¿ƒç”µå›¾è®ºæ–‡åˆ›æ–°ç‚¹æ•´ç†å’Œåˆæ­¥å®éªŒ
    </div>
    <div class="post-meta"><span title='2024-04-19 00:00:00 +0000 UTC'>April 19, 2024</span>&nbsp;Â·&nbsp;12 min&nbsp;Â·&nbsp;2541 words&nbsp;Â·&nbsp;LongWei

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e8%ae%ba%e6%96%87" aria-label="è®ºæ–‡">è®ºæ–‡</a><ul>
                        
                <li>
                    <a href="#im-ecg----2023" aria-label="â­IM-ECG  - 2023">â­IM-ECG  - 2023</a></li>
                <li>
                    <a href="#lightweight-transformer----2022" aria-label="Lightweight Transformer  - 2022">Lightweight Transformer  - 2022</a></li>
                <li>
                    <a href="#se-ecgnet----2020" aria-label="SE-ECGNet  - 2020">SE-ECGNet  - 2020</a></li>
                <li>
                    <a href="#mvms-ecg----2023" aria-label="â­MVMS-ECG  - 2023">â­MVMS-ECG  - 2023</a></li>
                <li>
                    <a href="#mvkt-ecg----2023" aria-label="MVKT-ECG  - 2023">MVKT-ECG  - 2023</a><ul>
                        
                <li>
                    <a href="#%e5%af%bc%e8%81%94%e5%85%b1%e5%90%8c%e4%bf%a1%e6%81%af%e7%9a%84%e7%9f%a5%e8%af%86%e8%92%b8%e9%a6%8f" aria-label="å¯¼è”å…±åŒä¿¡æ¯çš„çŸ¥è¯†è’¸é¦">å¯¼è”å…±åŒä¿¡æ¯çš„çŸ¥è¯†è’¸é¦</a></li>
                <li>
                    <a href="#%e5%a4%9a%e6%a0%87%e7%ad%be%e7%9f%a5%e8%af%86%e8%92%b8%e9%a6%8f%e7%9a%84%e4%bc%98%e5%8c%96" aria-label="å¤šæ ‡ç­¾çŸ¥è¯†è’¸é¦çš„ä¼˜åŒ–">å¤šæ ‡ç­¾çŸ¥è¯†è’¸é¦çš„ä¼˜åŒ–</a></li></ul>
                </li>
                <li>
                    <a href="#multi-modal--instance----2023" aria-label="Multi-Modal &#43; Instance  - 2023">Multi-Modal + Instance  - 2023</a><ul>
                        
                <li>
                    <a href="#%e5%a4%9a%e6%a8%a1%e6%80%81%e4%bf%a1%e6%81%af%e8%9e%8d%e5%90%88" aria-label="å¤šæ¨¡æ€ä¿¡æ¯èåˆ">å¤šæ¨¡æ€ä¿¡æ¯èåˆ</a></li></ul>
                </li>
                <li>
                    <a href="#multi-res-trans-net----2023" aria-label="Multi Res Trans Net  - 2023">Multi Res Trans Net  - 2023</a></li>
                <li>
                    <a href="#dual-branch-cnn-trans--select----2023" aria-label="â­Dual-Branch CNN-Trans &#43; Select  - 2023">â­Dual-Branch CNN-Trans + Select  - 2023</a></li>
                <li>
                    <a href="#ecgnet----2018" aria-label="ECGNet  - 2018">ECGNet  - 2018</a></li>
                <li>
                    <a href="#multi-module-lstm--cnn--autoencoder" aria-label="Multi module: LSTM &#43; CNN &#43; AutoEncoder">Multi module: LSTM + CNN + AutoEncoder</a></li>
                <li>
                    <a href="#ecg-dual-path-rnn---20228" aria-label="ECG Dual-path RNN - 2022/8">ECG Dual-path RNN - 2022/8</a></li>
                <li>
                    <a href="#mina----signal-processing-2019" aria-label="â­MINA  - Signal Processing 2019">â­MINA  - Signal Processing 2019</a></li>
                <li>
                    <a href="#self-supervised----2022" aria-label="Self-supervised  - 2022">Self-supervised  - 2022</a></li>
                <li>
                    <a href="#multi-scale-progressive-gated-transformer" aria-label="Multi-scale Progressive Gated Transformer">Multi-scale Progressive Gated Transformer</a></li>
                <li>
                    <a href="#clocs---icml-2021" aria-label="CLOCS - ICML 2021">CLOCS - ICML 2021</a></li>
                <li>
                    <a href="#guiding-masked-representation-learning----iclr-2024" aria-label="GUIDING MASKED REPRESENTATION LEARNING  - ICLR 2024">GUIDING MASKED REPRESENTATION LEARNING  - ICLR 2024</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%ae%9e%e9%aa%8c" aria-label="å®éªŒ">å®éªŒ</a><ul>
                        
                <li>
                    <a href="#inceptionformer" aria-label="InceptionFormer">InceptionFormer</a><ul>
                        
                <li>
                    <a href="#%e6%a8%a1%e5%9e%8b%e6%a1%86%e6%9e%b6" aria-label="æ¨¡å‹æ¡†æ¶">æ¨¡å‹æ¡†æ¶</a></li>
                <li>
                    <a href="#%e8%87%aa%e6%b3%a8%e6%84%8f%e5%8a%9b" aria-label="è‡ªæ³¨æ„åŠ›">è‡ªæ³¨æ„åŠ›</a></li>
                <li>
                    <a href="#%e4%bd%8d%e7%bd%ae%e5%b5%8c%e5%85%a5" aria-label="ä½ç½®åµŒå…¥">ä½ç½®åµŒå…¥</a></li>
                <li>
                    <a href="#%e7%8e%b0%e5%ad%98%e9%97%ae%e9%a2%98" aria-label="ç°å­˜é—®é¢˜">ç°å­˜é—®é¢˜</a></li></ul>
                </li>
                <li>
                    <a href="#inceptionformer--%e5%8d%b7%e7%a7%af%e8%b0%83%e5%88%b6" aria-label="InceptionFormer &#43; å·ç§¯è°ƒåˆ¶">InceptionFormer + å·ç§¯è°ƒåˆ¶</a><ul>
                        
                <li>
                    <a href="#%e6%b3%a8%e6%84%8f%e5%8a%9b%e5%8f%af%e8%a7%86%e5%8c%96" aria-label="æ³¨æ„åŠ›å¯è§†åŒ–">æ³¨æ„åŠ›å¯è§†åŒ–</a></li></ul>
                </li>
                <li>
                    <a href="#inceptionformer--shunt" aria-label="InceptionFormer &#43; Shunt">InceptionFormer + Shunt</a></li>
                <li>
                    <a href="#%e9%a2%91%e5%9f%9f%e7%89%b9%e5%be%81" aria-label="é¢‘åŸŸç‰¹å¾">é¢‘åŸŸç‰¹å¾</a></li>
                <li>
                    <a href="#time-domain" aria-label="time domain">time domain</a></li>
                <li>
                    <a href="#frequency-domain" aria-label="frequency domain">frequency domain</a></li>
                <li>
                    <a href="#two-stream-time-and-frequency-domain" aria-label="two-stream: time and frequency domain">two-stream: time and frequency domain</a></li>
                <li>
                    <a href="#inceptionnext--shunted-self-attention-cross-stack" aria-label="InceptionNeXt &#43; Shunted-Self Attention ï¼ˆCross-Stackï¼‰">InceptionNeXt + Shunted-Self Attention ï¼ˆCross-Stackï¼‰</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%b1%87%e6%80%bb" aria-label="æ±‡æ€»">æ±‡æ€»</a><ul>
                        
                <li>
                    <a href="#%e5%ae%9e%e9%aa%8c%e7%bb%93%e6%9e%9c" aria-label="å®éªŒç»“æœ">å®éªŒç»“æœ</a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%9e%8b%e6%8f%92%e5%9b%be" aria-label="æ¨¡å‹æ’å›¾">æ¨¡å‹æ’å›¾</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%95%b0%e6%8d%ae" aria-label="æ•°æ®">æ•°æ®</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="è®ºæ–‡">è®ºæ–‡<a hidden class="anchor" aria-hidden="true" href="#è®ºæ–‡">#</a></h2>
<h3 id="im-ecg----2023">â­IM-ECG  - 2023<a hidden class="anchor" aria-hidden="true" href="#im-ecg----2023">#</a></h3>
<p><strong>IM-ECG: An interpretable framework for arrhythmia detection using  multi-lead ECG</strong>   <em>- Expert Systems With Applications  sci-1</em></p>
<p>åˆ›æ–°ç‚¹:</p>
<ul>
<li>
<p>Conv2Dæ¨¡å‹ä¸Grad-CAMçš„é€‚é…æ›´å¥½  - å®æ—¶æ ‡æ³¨ç—…ç†åŒºåŸŸ  <strong>è§£é‡Šæ€§</strong></p>
</li>
<li>
<p>åŒæ ¸æ®‹å·®å—  - æ¨ªè½´ä¸ç«–è½´+é¢ ä¸‰ç§æ‰«ææ–¹å¼</p>
</li>
</ul>
<p><img alt="image-20231008222054322" loading="lazy" src="http://verification.longcoding.top/Fs6z6MvcLx6Jgu0ZSJQQhP_ELsED"></p>
<p><strong>k * n</strong>(åŒºåŸŸæ‰«æ)å†…æ ¸æœå‘ä¸­å¿ƒå‹ç¼©ECGä»¥æ›´ç›´æ¥åœ°æ•è·<strong>å¯¼è”é—´</strong>ç‰¹å¾ï¼Œè€Œ<strong>1 * n</strong>(æ¨ªè½´æ‰«æ)å†…æ ¸æ²¿ç€æ—¶é—´ç»´åº¦å‹ç¼©ECGå¹¶ä¸”å› æ­¤æ›´å…³æ³¨<strong>å¯¼è”å†…</strong>ç‰¹å¾</p>
<p><strong>æµç¨‹å›¾ç¤º</strong></p>
<p><img alt="image-20240327154037056" loading="lazy" src="http://verification.longcoding.top/Foik_oJeDo9NKImyPhkZ5ga6ZRKr"></p>
<p><strong>æ¨¡å‹ç»“æ„</strong></p>
<p><img alt="image-20240327153836525" loading="lazy" src="http://verification.longcoding.top/FpbYbRq6Dec9rkOSDKeD_5zMzfa5"></p>
<p><strong>Block</strong></p>
<p><img alt="image-20240327153914172" loading="lazy" src="http://verification.longcoding.top/Fv2Ky4pSh8O5sTf5Pm79Ea8BR_P6"></p>
<hr>
<h3 id="lightweight-transformer----2022">Lightweight Transformer  - 2022<a hidden class="anchor" aria-hidden="true" href="#lightweight-transformer----2022">#</a></h3>
<p><strong>Enhancing dynamic ECG heartbeat classification with lightweight transformer model</strong></p>
<p><em>Artificial Intelligence In Medicine</em>  <em>sci-1</em></p>
<p>åˆ›æ–°ç‚¹ï¼š</p>
<ul>
<li>
<p>ä¸¤çº§æ³¨æ„åŠ›æœºåˆ¶ï¼š å±€éƒ¨ + å…¨å±€ // å±€éƒ¨æ³¨æ„åŠ› == é€šé“æ³¨æ„åŠ› SEBlock  || å…¨å±€æ³¨æ„åŠ› == Transformer Encoder</p>
</li>
<li>
<p>å·ç§¯ç»“æ„æ¥ä»£æ›¿è‡ªæ³¨æ„</p>
</li>
</ul>
<p><strong>Input:</strong>   æ£€æµ‹Rå³°åˆ†æ®µ</p>
<p><img alt="image-20240327125618915" loading="lazy" src="http://verification.longcoding.top/Fp0qMCKJehhYdZfSTcGFtSLKaqda"></p>
<center style="color:red; font-weight:bolder;">æ¨¡å‹æ¡†æ¶</center>
<p><img alt="image-20240327125748959" loading="lazy" src="http://verification.longcoding.top/FqS1JmYorR7xtQKst3yYNvfUfIL9"></p>
<center style="color:blue; font-weight:bolder;">CNN Block</center>
<p><strong>CNN+Attentionæ¥æå–å¿ƒè·³å†…éƒ¨çš„ç‰¹å¾</strong></p>
<p><img alt="image-20240327125829274" loading="lazy" src="http://verification.longcoding.top/FvrU_l1mGaRqSGPnXmOWVgwqjJOY"></p>
<center style="color:blue; font-weight:bolder;">light-Conv Attention</center>
<p><strong>GLU:</strong>  <em>gated linear unit</em></p>
<p><strong>Lconv:</strong>   <em>depth-wise Convolution</em></p>
<hr>
<h3 id="se-ecgnet----2020">SE-ECGNet  - 2020<a hidden class="anchor" aria-hidden="true" href="#se-ecgnet----2020">#</a></h3>
<p><strong>SE-ECGNet: A Multi-scale Deep Residual Network with Squeeze-and-Excitation Module for ECG Signal Classification</strong></p>
<p><em>2020 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</em></p>
<p>åˆ©ç”¨ECGä¿¡å·ä¸­çš„å¤šå¯¼è”ä¿¡æ¯ï¼Œå°†å¤šå°ºåº¦äºŒç»´å·ç§¯å—ä¸ä¸€ç»´å·ç§¯å—ç»“åˆèµ·æ¥è¿›è¡Œç‰¹å¾æå–</p>
<p><em>åˆ›æ–°ç‚¹</em></p>
<ul>
<li>æä¾›å¯¹å¿ƒç”µæ•°æ®çš„ä¸åŒè§†è§’</li>
</ul>
<p><img alt="image-20231105144220615" loading="lazy" src="http://verification.longcoding.top/FplCmRZMAWQfKug99yBNAV0UkgsD"></p>
<p><em><strong>å°†ECGä¿¡å·è§†ä¸ºäºŒç»´å›¾ç‰‡(å•é€šé“ç°åº¦å›¾)</strong></em></p>
<p><img alt="image-20231105144204757" loading="lazy" src="http://verification.longcoding.top/Fv-5ITe8vMDvLK5lMcRr9eHFI6ud"></p>
<center style="color:red; font-weight:bolder;">æ¨¡å‹æ¡†æ¶</center>
<p><img alt="image-20240327131154616" loading="lazy" src="http://verification.longcoding.top/FoGGVWKihGHZdOPfwlYf0_epkxS8"></p>
<center style="color:blue; font-weight:bolder;">CNN Block</center>
<p>å‰æœŸè¾ƒå¤§çš„å·ç§¯æ ¸å¯ä»¥æ‰©å¤§æ„Ÿå—é‡ï¼Œæå–æ›´åŠ å¹¿æ³›çš„ä¿¡æ¯ï¼ŒåæœŸè¿›è¡Œä¿¡æ¯æµ“ç¼©æå–</p>
<hr>
<h3 id="mvms-ecg----2023">â­MVMS-ECG  - 2023<a hidden class="anchor" aria-hidden="true" href="#mvms-ecg----2023">#</a></h3>
<p><em><strong>A Multi-View Multi-Scale Neural Network for Multi-Label ECG Classification</strong></em></p>
<p><em>IEEE Transactions on Emerging Topics in Computational Intelligence</em>    sci-2</p>
<p>åˆ›æ–°ç‚¹ï¼š</p>
<ul>
<li>å°†å¯¼è”æŒ‰ç…§è¿æ¥è§‚æµ‹è§’åº¦åˆ†ç»„</li>
</ul>
<p><img alt="image-20240327133550908" loading="lazy" src="http://verification.longcoding.top/FnFnzWHtAv0k7IkwX0718iPNFNXB"></p>
<p>åˆ†è§†å›¾çš„èåˆç½‘ç»œä¸ºæ•™å®¤ç½‘ç»œ(å‚æ•°å¤§)  =è’¸é¦&gt; å•è§†å›¾çš„å­¦ç”Ÿç½‘ç»œ</p>
<p><strong style='color:blue'>æ¨¡å‹ç»“æ„</strong></p>
<p><img alt="image-20240327133617466" loading="lazy" src="http://verification.longcoding.top/FiNsKiKuzti5awPUyu6-R0BO2KLw"></p>
<p><strong>CNN Layers</strong></p>
<p><img alt="image-20240327133758012" loading="lazy" src="http://verification.longcoding.top/FpbH-DAtQ65hSmDoDZh15ExizCWE"></p>
<p><strong>Fusion Layer</strong></p>
<p><img alt="image-20240327133955260" loading="lazy" src="http://verification.longcoding.top/Fgwlt20ID1AFUrT32X5VPdh7OeNO"></p>
<p>å¦‚æœæ˜¯å¤šè§†å›¾ï¼Œé‚£ä¹ˆå°±ä¸è¦æœ€åçš„FCå°†æœ€åç‰¹å¾æ˜ å°„ä¸ºç±»åˆ«æ•°ï¼›</p>
<p>æºç  =&gt; æ¯ä¸ªè§†å›¾outputéƒ½æ˜¯ [B, 128]  =&gt; é‡æ–°åŠ æƒ(128=&gt;1çš„linearå……å½“è°ƒå’Œå™¨) =&gt; è¿‡å¤šè§†å›¾çš„FC(128 =&gt; num_class)</p>
<p><strong>Multi-scale Conv Block</strong></p>
<p><img alt="image-20240327134133763" loading="lazy" src="http://verification.longcoding.top/FhCurIVUjpxA5WlCZTtlMvGbdqb2"></p>
<p>ç½‘ç»œçš„å¤šå°ºåº¦è¡¨ç¤ºåœ¨æ›´ç»†ç²’åº¦çš„çº§åˆ«ä¸Šå¾—åˆ°å¢å¼º  - é‡‡ç”¨Res2Block</p>
<p><strong>Coordinate Attention 1D</strong></p>
<p><img alt="image-20240327134033425" loading="lazy" src="http://verification.longcoding.top/FsmP-vtRKCIdIuhC7CdcWzXi-2bB"></p>
<p>æ—¢å»ºç«‹äº†ç‰¹å¾é€šé“é—´çš„å…³ç³»ï¼Œå¯¹å„é€šé“çš„é‡è¦æ€§è¿›è¡Œé‡æ–°åŠ æƒï¼Œåˆè·å¾—äº†ç‰¹å¾ç©ºé—´ä¸­çš„ç©ºé—´ä¿¡æ¯</p>
<hr>
<h3 id="mvkt-ecg----2023">MVKT-ECG  - 2023<a hidden class="anchor" aria-hidden="true" href="#mvkt-ecg----2023">#</a></h3>
<p>MVKT-ECG: Efficient single-lead ECG classification for multi-label arrhythmia by multi-view knowledge transferring</p>
<p><em>Computers in Biology and Medicine</em>    <em>sci-2</em></p>
<p>åˆ›æ–°ç‚¹ï¼š</p>
<p>â€‹	# å¤šå¯¼è”ä¿¡æ¯å¦‚ä½•è’¸é¦åˆ°å•å¯¼è”ä¸­</p>
<p><img alt="image-20240327140327574" loading="lazy" src="http://verification.longcoding.top/Fi_18gQrmh7c-7go8uidNED7nf-Z"></p>
<p>ä¸åŒå¯¼è”æ˜¯æ£€æµ‹å¿ƒè„çŠ¶å†µçš„ä¸åŒè§†è§’ï¼Œæä¾›å¯¹ç›®æ ‡ç–¾ç—…çš„å¤šç§è§‚æµ‹ç‚¹å’Œå¤šç§å¤–è²Œ</p>
<p>=&gt; ç›®æ ‡ï¼šæ˜¯æ•™ä¼šç½‘ç»œä»å•å¯¼è”ECGä¿¡å·ä¸­æ¢å¤å°½å¯èƒ½å¤šçš„å…¨å¯¼è”ä¿¡æ¯</p>
<h4 id="å¯¼è”å…±åŒä¿¡æ¯çš„çŸ¥è¯†è’¸é¦">å¯¼è”å…±åŒä¿¡æ¯çš„çŸ¥è¯†è’¸é¦<a hidden class="anchor" aria-hidden="true" href="#å¯¼è”å…±åŒä¿¡æ¯çš„çŸ¥è¯†è’¸é¦">#</a></h4>
<p>è™½ç„¶æœ‰äº›ç–¾ç—…ä¸èƒ½ä»å•å¯¼è”ECGä¿¡å·ä¸­æ¨æ–­å‡ºæ¥ï¼Œä½†æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°½å¯èƒ½ç¼©çŸ­å•å¯¼è”ECGè§£é‡Šæ¨¡å‹å’Œå¤šå¯¼è”ECGè§£é‡Šæ¨¡å‹ä¹‹é—´çš„ä¿¡æ¯å·®è·ï¼Œé¼“åŠ±å­¦ç”Ÿæ›´å¤šåœ°å…³æ³¨æŸäº›ç‰¹å®šç–¾ç—…çš„å…³é”®ç»†èŠ‚ï¼Œæœ€å¤§é™åº¦åœ°åˆ©ç”¨å•å¯¼è”ECGè§£é‡Šæ¨¡å‹å’Œå¤šå¯¼è”ECGè§£é‡Šæ¨¡å‹ä¹‹é—´çš„ç–¾ç—…ä¿¡æ¯ã€‚</p>
<p>=&gt; é€šè¿‡ç¼©çŸ­å­¦ç”Ÿæ¨¡å‹å’Œæ•™å¸ˆæ¨¡å‹å¯¹ç§¯æå¯¹çš„è¡¨ç¤ºå¹¶å°†â€œæ¶ˆæ&quot;å¯¹ä¹‹é—´çš„è¡¨ç¤ºåˆ†å¼€æ¥å®ç°çš„</p>
<p>â­â­â­æœ€å¤§åŒ–å•å¯¼è”ECGä¿¡å·å’Œå¤šå¯¼è”ECGä¿¡å·ä¹‹é—´çš„äº’(å…±åŒ)ä¿¡æ¯æ¥ä¼ é€’æœ‰ç”¨çš„ç–¾ç—…ä¿¡æ¯ã€‚</p>
<p>å› ä¸ºï¼šä»å•å¯¼è”ECGä¿¡å·ä¸­æå–çš„ç–¾ç—…ä¿¡æ¯æ¯”12å¯¼è”ECGä¿¡å·å°‘ï¼Œä½†ä»åŒ…å«éƒ¨åˆ†ç–¾ç—…ä¿¡æ¯ã€‚</p>
<p>â—â—â— å¼•å‡ºCLT-Loss  å¤ªéš¾äº†ï¼Œæ²¡çœ‹</p>
<p><strong>é¢å‘ç‰¹å¾ä¸ç‰¹å¾çš„ç›¸ä¼¼åº¦ ä¸ æœ€ç»ˆé¢„æµ‹å’Œæ ‡ç­¾çš„Lossç›®çš„ä¸ä¸€æ ·</strong></p>
<h4 id="å¤šæ ‡ç­¾çŸ¥è¯†è’¸é¦çš„ä¼˜åŒ–">å¤šæ ‡ç­¾çŸ¥è¯†è’¸é¦çš„ä¼˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#å¤šæ ‡ç­¾çŸ¥è¯†è’¸é¦çš„ä¼˜åŒ–">#</a></h4>
<p><img alt="image-20240327140614683" loading="lazy" src="http://verification.longcoding.top/Fksp0kSQPFuG0pYKkHTJBL-MIpNg"></p>
<p>ä»¿ç…§CE-Loss å’Œ BCE-Loss</p>
<hr>
<h3 id="multi-modal--instance----2023">Multi-Modal + Instance  - 2023<a hidden class="anchor" aria-hidden="true" href="#multi-modal--instance----2023">#</a></h3>
<p><em><strong>Multimodal multi-instance learning for long-term ECG classification</strong></em>   <em><strong>- Knowledge-Based Systems</strong></em></p>
<p><strong>èŠ‚æ‹ è§†ä¸º å®ä¾‹</strong></p>
<p><img alt="image-20240327143559281" loading="lazy" src="http://verification.longcoding.top/Fuo85Dhw-HA8ouH_YRBCHOZYwf8r"></p>
<p><strong>åŒæ¨¡æ€ï¼šä¸€ç»´ä¿¡å· + äºŒç»´å›¾ç‰‡</strong></p>
<p><img alt="image-20240327143524604" loading="lazy" src="http://verification.longcoding.top/FjcNYGoZN1YBN3HSxnZNdM80SWYj"></p>
<h4 id="å¤šæ¨¡æ€ä¿¡æ¯èåˆ">å¤šæ¨¡æ€ä¿¡æ¯èåˆ<a hidden class="anchor" aria-hidden="true" href="#å¤šæ¨¡æ€ä¿¡æ¯èåˆ">#</a></h4>
<p><em>ä¼ ç»Ÿï¼š</em></p>
<p><img alt="image-20240327145248469" loading="lazy" src="http://verification.longcoding.top/FkVnwJp6tOwwxZ--DXo1l15fn3fh"></p>
<p><em>æ–°æ–¹æ³•</em></p>
<p><img alt="image-20240327145025906" loading="lazy" src="http://verification.longcoding.top/Fnddrqbhd0IT3RH11Xg5-YMHi-i4"></p>
<p>â€‹	é€šè¿‡ä½¿ç”¨æœ€å¤§æ± åŒ–æ“ä½œä»æ¯ä¸ªæ¨¡æ€çš„å®ä¾‹ç‰¹å¾ä¸­é€‰æ‹©<strong>é¡¶éƒ¨æ¿€æ´»å®ä¾‹ç‰¹å¾(ä»£è¡¨)</strong>ã€‚ç„¶å<strong>è®¡ç®—é¡¶éƒ¨æ¿€æ´»å®ä¾‹ç‰¹å¾å’Œæ‰€æœ‰å‰©ä½™å®ä¾‹ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§åˆ†æ•°</strong>ä»¥è·å¾—ç‰¹å¾å‘é‡ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ªä¸¤ç§æ¨¡æ€çš„ä¿¡æ¯ã€‚æœ€åï¼Œå°†<strong>ç‰¹å¾å‘é‡å’Œé¡¶éƒ¨æ¿€æ´»å®ä¾‹ç‰¹å¾å‘é‡èåˆ</strong>ï¼Œå¾—åˆ°æ¯ä¸ªæ¨¡æ€çš„bagç‰¹å¾ã€‚æ¯ç§æ¨¡æ€çš„è¢‹å­ç‰¹å¾é€šè¿‡çº¿æ€§å±‚æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¢‹å­ç‰¹å¾ã€‚</p>
<p><img alt="image-20240327145455889" loading="lazy" src="http://verification.longcoding.top/Fu86vYzeaSrjlTNJqPk50rE85aSx"></p>
<hr>
<h3 id="multi-res-trans-net----2023">Multi Res Trans Net  - 2023<a hidden class="anchor" aria-hidden="true" href="#multi-res-trans-net----2023">#</a></h3>
<p><em>Multi-scale SE-ResBlock + Transformer Encoder</em></p>
<p><strong>Multi-scale SE-residual network with transformer encoder for myocardial infarction classification</strong>    <em>Applied Soft Computing  sci-1</em></p>
<p>æå–å±€éƒ¨ç‰¹å¾å’Œå…¨å±€ç‰¹å¾</p>
<p><strong>æ¨¡å‹ç»“æ„</strong></p>
<p><em>åˆ†æ®µ</em>  - ç”¨å…·æœ‰é‡å çš„æ»‘åŠ¨çª—å£</p>
<p><img alt="image-20240327145737234" loading="lazy" src="http://verification.longcoding.top/FtU7Qr5ZWM0JAUX-n-CnwiucWtMS"></p>
<p><strong>Multi-scale sample layer</strong></p>
<p><img alt="image-20240327145938698" loading="lazy" src="http://verification.longcoding.top/Fo4R_1qJXLkbb6f0lzXD8I-jCS5l"></p>
<p>å¤šå°ºåº¦é‡‡æ ·æ¨¡å—  åç§°ä¸é”™</p>
<p><strong>SE-Resnet Block</strong></p>
<p><img alt="image-20240327150034480" loading="lazy" src="http://verification.longcoding.top/FrD7qjLSBvjRtVPqSWHmC5H6Ww-u"></p>
<p><strong>CPC</strong></p>
<p><img alt="image-20240327150132721" loading="lazy" src="http://verification.longcoding.top/Fo6jhylOIAAM38mCNeFx0PDKHeGw"></p>
<p>GAP(å…¨å±€å¹³å‡æ± åŒ–)å®šä½çš„æ˜¯æ•´ä½“åŒºåŸŸï¼Œè€ŒGMP(å…¨å±€æœ€å¤§æ± åŒ–)å®šä½çš„æ˜¯ç›®æ ‡åŒºåŸŸä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚</p>
<hr>
<h3 id="dual-branch-cnn-trans--select----2023">â­Dual-Branch CNN-Trans + Select  - 2023<a hidden class="anchor" aria-hidden="true" href="#dual-branch-cnn-trans--select----2023">#</a></h3>
<p><strong>A token selection-based multi-scale dual-branch CNN-transformer network for 12-lead ECG signal classification</strong></p>
<p><em>Knowledge-Based Systems sci-1</em></p>
<p><strong>æ¨¡å‹ç»“æ„</strong></p>
<p><img alt="image-20240327151553655" loading="lazy" src="http://verification.longcoding.top/Fh6H-Ok8KNDg1MrXuFwXNjNKiGCn"></p>
<p>RRè¡¨ç¤ºè®¡ç®—ä¸¤ä¸ªåˆ†æ”¯ä¸­CLS tokenä¹‹é—´çš„ç›¸å…³ç³»æ•°  =&gt; RR-Loss è¿«ä½¿ä¸¤ä¸ªåˆ†æ”¯æœç€æœ€ç»ˆé¢„æµ‹åŒå‘è€Œè¡Œ</p>
<p><strong>CNN Blocks</strong></p>
<p><img alt="image-20240327151939118" loading="lazy" src="http://verification.longcoding.top/FiVVTyUs1OP57irjiUK72gGSW7up"></p>
<p>âƒ+ is element-wise addition</p>
<p><strong>MSEL</strong></p>
<p><img alt="image-20240327152059740" loading="lazy" src="http://verification.longcoding.top/FsosvYLsW72QYBTqMRjVFW8yWn5h"></p>
<p>ä¸€èˆ¬é‡‡ç”¨ViTä¸­çš„åµŒå…¥, Conv1Då®ç°</p>
<p>é€šè¿‡ä¸åŒå¤§å°çš„TokenåµŒå…¥,æˆ–è®¸å¯ä»¥æ•è·åˆ°ä¸åŒçš„æ¨¡å¼</p>
<p><strong>Token Select</strong></p>
<p><img alt="image-20240327152029903" loading="lazy" src="http://verification.longcoding.top/FqJlAwMplpETb2U_cCp7-0xQH603"></p>
<p>åˆ æ‰å†—ä½™çš„Token,æˆ–è®¸å¯ä»¥åœ¨è®ºæ–‡ä¸­å¯è§†åŒ–ä¸€ä¸‹è‡ªæ³¨æ„åŠ›å›¾,ç›´è§‚çš„æè¿°å†—ä½™</p>
<hr>
<h3 id="ecgnet----2018">ECGNet  - 2018<a hidden class="anchor" aria-hidden="true" href="#ecgnet----2018">#</a></h3>
<p>ECGNet: Deep Network for Arrhythmia Classification</p>
<p><img alt="image-20240327152958835" loading="lazy" src="http://verification.longcoding.top/FriRBcj2_DfxlrlMWU-kg8yaPsjA"></p>
<p>Inception Block + Conv Block Ã— N</p>
<hr>
<h3 id="multi-module-lstm--cnn--autoencoder">Multi module: LSTM + CNN + AutoEncoder<a hidden class="anchor" aria-hidden="true" href="#multi-module-lstm--cnn--autoencoder">#</a></h3>
<p>Multi-module Recurrent Convolutional Neural Network with Transformer Encoder for ECG Arrhythmia Classification</p>
<p><img alt="image-20240327153623587" loading="lazy" src="http://verification.longcoding.top/Fkj6LwIApmG5o4N4065tHkp1O6Ar"></p>
<hr>
<h3 id="ecg-dual-path-rnn---20228">ECG Dual-path RNN - 2022/8<a hidden class="anchor" aria-hidden="true" href="#ecg-dual-path-rnn---20228">#</a></h3>
<p><strong>Single-lead ECG recordings modeling for end-to-end recognition of atrial fibrillation with dual-path RNN</strong></p>
<p><em>Biomedical Signal Processing and Control</em>  äºŒåŒº</p>
<p><img alt="image-20240227141810637" loading="lazy" src="http://verification.longcoding.top/FjwE0iqlQ1pMIPOd3hGbi57kzJb7"></p>
<p><em><strong>Segmentation:</strong></em></p>
<p><img alt="image-20240227143633528" loading="lazy" src="http://verification.longcoding.top/Fru1F4NH2dxJMIbnipQdone8UfHs"></p>
<p>[batch, 1, L]  =&gt; [batch, num_seg, len_seg]</p>
<p>é‡å 50%</p>
<p><em><strong>Overlap-Add:</strong></em></p>
<p>â€‹	Segmentationçš„é€†æ“ä½œï¼Œé‡å ç›¸åŠ </p>
<p>RNNä¸ºBi-LSTM</p>
<p>LSTM è¾“å…¥æ•°æ®æ ¼å¼ Batch, num_seq, len_seq</p>
<p>æ®µé—´å»ºæ¨¡ + æ®µå†…å»ºæ¨¡</p>
<p><em><strong>å›¾ä¾‹ï¼š</strong></em></p>
<p><img alt="image-20240228141118686" loading="lazy" src="http://verification.longcoding.top/FuGAi3WkezRO-whsi4IhnZ2AhOYm"></p>
<p><img alt="image-20240228141137134" loading="lazy" src="http://verification.longcoding.top/Fi2DDId0llMuv6ZCQELc4_3px43v"></p>
<p>ç±»ä¼¼MLP-Mixerï¼Œç”¨RNNå»ºæ¨¡ä¿¡æ¯èåˆï¼ŒéšçŠ¶æ€ä¼ é€’æ—¶åºä¿¡æ¯</p>
<hr>
<h3 id="mina----signal-processing-2019">â­MINA  - Signal Processing 2019<a hidden class="anchor" aria-hidden="true" href="#mina----signal-processing-2019">#</a></h3>
<p><em>MINA: <strong>Multilevel Knowledge-Guided Attention</strong> for Modeling Electrocardiography Signals</em></p>
<p>åšæ³•ï¼š</p>
<ul>
<li>
<p>ç‰¹å¾å·¥ç¨‹ï¼šä»å¿ƒç”µå›¾æ³¢å½¢ä¸­æå–ä¿¡æ¯ç‰¹å¾ =&gt; ä¼ ç»Ÿæœºå™¨å­¦ä¹ è¿›è¡Œå¤„ç† =&gt; ç»“æœ</p>
<p>æ¢ç´¢P-QRS-T æ³¢çš„å„ç§å¹…åº¦å’ŒæŒç»­æ—¶é—´ç‰¹å¾ï¼ŒåŒ…æ‹¬ç”¨äºåˆ†ç±»çš„å½¢æ€å­¦ å’Œ RR é—´æœŸç‰¹å¾  // Hermiteå˜æ¢å’Œå°æ³¢å˜æ¢</p>
<p>â—â—â—<strong>ä¾èµ–äºæå–çš„ç‰¹å¾ï¼Œå¾ˆå®¹æ˜“å—åˆ°å™ªå£°å¹²æ‰°ï¼Œç‰¹å¾æ²¡æå–å¥½ï¼Œåç»­å·¥ä½œå¾ˆéš¾è¿›å±•</strong></p>
</li>
<li>
<p>æ³¨æ„åŠ›å¼•å¯¼ç½‘ç»œå…³æ³¨é‡ç‚¹ ï¼ˆé€šç”¨è‡ªå­¦ä¹ æ³¨æ„åŠ›ï¼‰å’Œï¼ˆèåˆé¢†åŸŸçŸ¥è¯†çš„æ³¨æ„åŠ›ï¼‰</p>
</li>
</ul>
<p>3çº§æ³¨æ„åŠ›ï¼šï¼ˆèŠ‚æ‹çº§ã€èŠ‚å¾‹çº§å’Œé¢‘ç‡çº§ï¼‰é¢†åŸŸçŸ¥è¯†ç‰¹å¾</p>
<p><img alt="image-20240320125118402" loading="lazy" src="http://verification.longcoding.top/FhMwwXFFzXiQK-fdxywD7iQOxcpz"></p>
<p><strong>â­æå–ç‰¹å®šçº§åˆ«çš„é¢†åŸŸçŸ¥è¯†ç‰¹å¾å¹¶ä½¿ç”¨å®ƒä»¬æ¥å¼•å¯¼æ³¨æ„åŠ›ï¼ŒåŒ…æ‹¬<strong style="color:red">å¼•å¯¼æ³¨æ„åŠ›CNNçš„èŠ‚æ‹å½¢æ€çŸ¥è¯†</strong>å’Œ<strong style="color:red">å¼•å¯¼æ³¨æ„åŠ›RNNçš„èŠ‚å¥çŸ¥è¯†</strong></strong></p>
<p>â­<strong>è·¨æ—¶åŸŸå’Œé¢‘åŸŸè¿›è¡Œæ³¨æ„åŠ›èåˆ</strong></p>
<p><strong>èŠ‚æ‹çº§</strong>ï¼šä¸»è¦è€ƒè™‘å¼‚å¸¸çš„æ³¢å½¢æˆ–è¾¹ç¼˜ã€‚çŸ¥è¯†å¼•å¯¼çš„æ³¨æ„åŠ›æ¥èšåˆè¿™äº›ç‰¹å¾å¹¶è·å¾—èŠ‚æ‹çº§åˆ«æ³¨æ„åŠ›</p>
<p>â€‹				<strong>å·ç§¯ç¥ç»ç½‘ç»œ (CNN) ç”¨äºå­¦ä¹ èŠ‚æ‹çº§åˆ«æ¨¡å¼</strong></p>
<p><strong>èŠ‚å¾‹çº§</strong>ï¼šè€ƒè™‘å¼‚å¸¸èŠ‚å¾‹å˜åŒ–</p>
<p>â€‹				<strong>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰é€‚åˆæ•è·èŠ‚å¾‹ç‰¹å¾</strong></p>
<p>æå–ç‰¹å®šçº§åˆ«çš„é¢†åŸŸçŸ¥è¯†ç‰¹å¾å¹¶ä½¿ç”¨å®ƒä»¬æ¥å¼•å¯¼æ³¨æ„åŠ›ï¼ŒåŒ…æ‹¬æŒ‡å¯¼æ³¨æ„åŠ› CNN çš„èŠ‚æ‹å½¢æ€çŸ¥è¯†å’ŒæŒ‡å¯¼æ³¨æ„åŠ› RNN çš„èŠ‚å¥çŸ¥è¯†</p>
<p>è¯†åˆ«å…³é”®èŠ‚æ‹ä½ç½®ã€æ˜¾ç€çš„èŠ‚å¾‹å˜åŒ–ã€é‡è¦çš„é¢‘ç‡åˆ†é‡</p>
<p><em>çŸ¥è¯†ç‰¹å¾ ä½œç”¨äº ç½‘ç»œç‰¹å¾</em></p>
<p><strong>ç‰¹å®šçº§åˆ«çš„é¢†åŸŸçŸ¥è¯†ç‰¹å¾  - å¼•å¯¼æ³¨æ„åŠ›</strong></p>
<div style='color:red; font-weight:bolder'>Beat Level</div>
<p>â€‹	 ä¸»è¦è€ƒè™‘å¼‚å¸¸æ³¢å½¢æˆ–æ€¥å‰§å˜åŒ–çš„ç‚¹ =&gt; è®¡ç®—<strong>ä¸€é˜¶å·®åˆ†</strong> Î” å’Œæ¯ä¸ªç‰‡æ®µ s ä¸Šçš„<strong>å·ç§¯</strong>è¿ç®—</p>
<p>â€‹	ä¸€é˜¶å·®åˆ†ï¼š ç”¨æ¥æå–ä¿¡å·çš„å˜åŒ–è¶‹åŠ¿å’Œç‰¹å¾</p>
<p>â€‹	<img alt="image-20240320134815892" loading="lazy" src="http://verification.longcoding.top/FmyxGSZaakCzhtV7kNZZN0i7B-tw"></p>
<div style='color:red; font-weight:bolder'>Rhythm Level</div>
<p>â€‹	è®¡ç®—æ¯ä¸ªç‰‡æ®µçš„<strong>æ ‡å‡†å·®</strong>ï¼Œä»¥æå–èŠ‚å¥æ°´å¹³çŸ¥è¯†ç‰¹å¾å‘é‡</p>
<p>â€‹		<em><strong>æ ‡å‡†å·®</strong></em>ï¼š<strong>è¡¡é‡ä¿¡å·çš„ç¨³å®šæ€§</strong>ã€<strong>æ£€æµ‹å¼‚å¸¸å€¼</strong>ã€<strong>æè¿°ä¿¡å·æ³¢åŠ¨æ€§</strong>ã€<strong>æ¯”è¾ƒä¸åŒä¿¡å·ä¹‹é—´çš„æ³¢åŠ¨ç¨‹åº¦</strong></p>
<div style='color:red; font-weight:bolder'>Frequency Level</div>
<p>â€‹	èƒ½é‡è¶Šå¤§çš„ä¿¡å·åŒ…å«çš„ä¿¡æ¯è¶Šå¤šï¼Œ<strong>åŠŸç‡è°±å¯†åº¦</strong>ï¼ˆPSDï¼‰æ¥æå–é¢‘ç‡çº§çŸ¥è¯†ç‰¹å¾å‘é‡</p>
<p>â€‹		é¢‘è°±åˆ†æå¯ä»¥è¾…åŠ©äº†è§£ä¿¡å·åœ¨ä¸åŒé¢‘ç‡ä¸‹çš„æˆåˆ†å’Œèƒ½é‡åˆ†å¸ƒæƒ…å†µ</p>
<p>â€‹		åŠŸç‡è°±å¯†åº¦ä¼°è®¡æ˜¯è®¡ç®—ä¿¡å·åŠŸç‡åœ¨é¢‘åŸŸä¸Šçš„åˆ†å¸ƒ</p>
<p>â€‹		ä¾‹ï¼š100HzECGæ®µæ•°æ® =&gt;  periodogram(ä¼°è®¡ä¿¡å·çš„åŠŸç‡è°±å¯†åº¦çš„å‡½æ•°) =&gt; è¿”å›é¢‘ç‡èŒƒå›´(0-50Hz)å’Œå¯¹åº”çš„åŠŸç‡å€¼ =&gt; sum() æ€»é¢‘è°±å¯†åº¦</p>
<p><strong>æ¨¡å‹æ¡†æ¶ï¼š</strong></p>
<p><img alt="image-20240320130936524" loading="lazy" src="http://verification.longcoding.top/Fvm0o2A8wCetOmgRDCYiUNPBrwsA"></p>
<p><strong>Input</strong>:  å•å¯¼è”å¿ƒç”µä¿¡å·</p>
<p><strong>Frequency Transformation Layer</strong>:  å°†ä¿¡å·æŒ‰ç…§é¢‘ç‡åŒºåˆ†å¼€ï¼Œåˆ©ç”¨é«˜é€šæ»¤æ³¢å™¨ã€å¸¦é€šæ»¤æ³¢å™¨ï¼›  <em><strong>0-0.5Hz: ä½é¢‘æ¼‚ç§»ï¼›0.5-50hzï¼šä¸»è¦æˆåˆ†;  &gt;50Hz: å™ªå£°</strong></em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### candidate channels for ECG</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">P_wave</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.67</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">QRS_complex</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">T_wave</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">muscle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>	<span class="c1"># è‚Œè‚‰å¹²æ‰°</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">resp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>	<span class="c1"># å‘¼å¸ä¿¡å·</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="err">!</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">ECG_preprocessed</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="c1"># ï¼ï¼ï¼ ECGä¸»è¦éƒ¨åˆ†</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">wander</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>	<span class="c1"># åŸºçº¿æ¼‚ç§»</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">noise</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1"># low (wander), middle (ECG_preprocessed) and high (noise)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="n">bandpass_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">wander</span><span class="p">,</span> <span class="n">ECG_preprocessed</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="n">highpass_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">noise</span><span class="p">]</span>
</span></span></code></pre></div><p><img alt="image-20240320133906384" loading="lazy" src="http://verification.longcoding.top/FrR37eonOewex5q0nXqAJYTg6D4g"></p>
<p><strong>Sliding Window Segmentation</strong>:  å›ºå®šçª—å£ï¼Œé‡å åˆ†æ®µï¼ˆä¸ç”¨å…ˆå®šä½Rå³°å†åˆ†æ®µï¼‰</p>
<p><img alt="image-20240320134653351" loading="lazy" src="http://verification.longcoding.top/FmCb242aCoG5ncSbExr9MPjd-J_1"></p>
<p>è®¡ç®—ä¸€é˜¶å·®å•†ã€æ ‡å‡†å·®ã€åŠŸç‡è°±å¯†åº¦ä¼°è®¡ä½œä¸º<strong>ç»Ÿè®¡ç‰¹å¾</strong></p>
<p><strong>å°†ç»Ÿè®¡ä¿¡æ¯ä½œä¸ºæ³¨æ„åŠ›å¼•å¯¼åµŒå…¥æ¨¡å‹ä¸­ï¼š</strong></p>
<p>Lï¼š ç»è¿‡Convæå–æ®µå†…ä¿¡æ¯åçš„æ•°æ®</p>
<p>Hï¼šç»è¿‡RNNèåˆæ®µé—´ä¿¡æ¯åçš„æ•°æ®</p>
<p><img alt="image-20240320141812190" loading="lazy" src="http://verification.longcoding.top/FmGKfSedPYpDJXu9LswZJS-62TJW"></p>
<p>$$
V^{T} âˆˆ R^{1Ã—D_{Î±}}
$$</p>
<p>å†å°†Î±ä½œç”¨äºç‰¹å¾</p>
<p>æœ€åå°†ä¸åŒé¢‘ç‡åŒºåŸŸçš„è¾“å‡ºConcat é€šé“åœ¨ä¸€èµ·ï¼Œè¿‡é¢‘ç‡æ³¨æ„åŠ›é‡æ–°åŠ æƒ</p>
<hr>
<h3 id="self-supervised----2022">Self-supervised  - 2022<a hidden class="anchor" aria-hidden="true" href="#self-supervised----2022">#</a></h3>
<p><em><strong>Self-supervised representation learning from 12-lead ECG data</strong></em></p>
<p><em>Computers in Biology and Medicine</em></p>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ul>
<li>åŒ»å­¦é«˜è´¨é‡æ ‡ç­¾å¾ˆéš¾è·å¾—ï¼Œæˆæœ¬æ˜‚è´µ</li>
<li>å…¬å¼€æ•°æ®é›†ä¸å¤Ÿå¤§</li>
<li>æœªæ ‡è®°æ•°æ®çš„æ•°é‡é€šå¸¸è¿œè¿œè¶…è¿‡æ ‡è®°æ•°æ®çš„æ•°é‡</li>
</ul>
<p>ç»“åˆNLPã€è§†è§‰ã€è¯­éŸ³åœ¨æ— ç›‘ç£å­¦ä¹ çš„æˆåŠŸ</p>
<p>â¬‡ï¸</p>
<p><strong>åˆ›æ–°ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨è‡ªç›‘ç£çš„æ–¹æ³•ï¼Œå®ç°ECGè¡¨å¾å­¦ä¹ </li>
</ul>
<p><strong>å¯¹æ¯”å­¦ä¹ CPCæ¡†æ¶ç»“æ„</strong></p>
<p><img alt="image-20240416131704929" loading="lazy" src="http://verification.longcoding.top/FofvehMrA5uriBI78cbBS5YbIShM"></p>
<p>ä¸ºä»€ä¹ˆç”¨MLPä¸ç”¨CNNï¼Œå› ä¸º<strong>ECG</strong>é‡‡æ ·é¢‘ç‡ä¸º<strong>100Hz</strong>æ¯”<strong>éŸ³é¢‘</strong>å…¸å‹é‡‡ç”¨é¢‘ç‡<strong>10 kHz</strong>ç²—ç³™ï¼Œä½¿ç”¨MLPè¿›è¡Œéçº¿æ€§æ˜ å°„</p>
<p><strong>æ•°æ®é›†ï¼š</strong></p>
<p><img alt="image-20240416131354561" loading="lazy" src="http://verification.longcoding.top/FmyaN3BQaErrvtRqbXV81LJKpu8_"></p>
<p><strong>ç»“æœ</strong></p>
<p>è¯„ä»·æŒ‡æ ‡<em><strong>macro AUC</strong></em></p>
<p><strong>çº¿æ€§è¯„ä¼°</strong>-å†»ç»“æ¨¡å‹å‚æ•°ï¼Œå°†åˆ†ç±»å¤´æ”¹ä¸ºçº¿æ€§å±‚ï¼ŒéªŒè¯æ¨¡å‹å­¦åˆ°çš„ç‰¹å¾è¡¨ç¤ºï¼›</p>
<p><strong>å¾®è°ƒ</strong>-åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šè¿›è¡Œå¾®è°ƒåˆ†ç±»å¤´å’Œéƒ¨åˆ†å‚æ•°ã€‚</p>
<p><img alt="image-20240416132013141" loading="lazy" src="http://verification.longcoding.top/FkrtZdqFeWsbHP7LvJmmgjWfRd6x"></p>
<p><em><strong>é¢„è®­ç»ƒçš„è¡¨ç¤ºä¸ä¸‹æ¸¸åˆ†ç±»ä»»åŠ¡é«˜åº¦ç›¸å…³</strong></em></p>
<p><em><strong>è‡ªç›‘ç£é¢„è®­ç»ƒæé«˜äº†ä¸‹æ¸¸åˆ†ç±»å™¨çš„ç¨³å¥æ€§</strong></em></p>
<p><img alt="image-20240416134716985" loading="lazy" src="http://verification.longcoding.top/Fja8j4BZTAsa91EHE0sUcc3tte6N"></p>
<p>è¡¨æ˜åœ¨å¤§æ•°æ®é›†ä¸Šé¢„è®­ç»ƒï¼Œåœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸­ï¼Œéœ€è¦æ›´å°‘çš„æ ‡ç­¾æ•°æ®å°±å¯ä»¥è¾¾åˆ°æœ‰ç›‘ç£è®­ç»ƒçš„æ•ˆæœ</p>
<hr>
<h3 id="multi-scale-progressive-gated-transformer">Multi-scale Progressive Gated Transformer<a hidden class="anchor" aria-hidden="true" href="#multi-scale-progressive-gated-transformer">#</a></h3>
<p>Multi-scale Progressive Gated Transformer for Physiological Signal Classification</p>
<p>åˆ†ä¸¤æ­¥ï¼š</p>
<ul>
<li>ç»†ç²’åº¦æ•è·å±€éƒ¨æ³¢å½¢å˜åŒ–</li>
<li>ç²—ç²’åº¦æ•è·å…¨å±€è¶‹åŠ¿å˜åŒ–</li>
</ul>
<p>æ¡†æ¶ï¼š</p>
<img src="http://verification.longcoding.top/FgyMITh5kc3J10LomW2rU9tqJxxD" alt="image-20240615220014092" style="zoom: 67%;" />
<ul>
<li>
<p>ä½¿ç”¨Conv-MaxPool-Conv-AvgPool å®ç°åµŒå…¥</p>
</li>
<li>
<p>å †å  MHSA-FFN-TCN-FFN æ¨¡å— (Temporal Convolution Net)</p>
</li>
<li>
<p>åˆ†æ”¯èåˆï¼šx1 â¨‚ sigmoid(tanh(fc(x1))) + x2</p>
</li>
</ul>
<hr>
<h3 id="clocs---icml-2021">CLOCS - ICML 2021<a hidden class="anchor" aria-hidden="true" href="#clocs---icml-2021">#</a></h3>
<p><em>Contrastive Learning of Cardiac Signals Across Space, Time, and Patients</em></p>
<p>å¯¹æ¯”ï¼šæ—¶é—´-ç©ºé—´-æ‚£è€…</p>
<p><img alt="image-20240731153848210" loading="lazy" src="http://verification.longcoding.top/FiAKTZPKBclwcqZ5m86_plzRT0wL"></p>
<p><img alt="image-20240731153914807" loading="lazy" src="http://verification.longcoding.top/FrZOif0kPis9FnlpxevBwTlrGRXA"></p>
<p>Figureï¼šï¼ˆå·¦ï¼‰å¯¹æ¯”å¤šæ®µç¼–ç ã€ï¼ˆä¸­ï¼‰å¯¹æ¯”å¤šå¯¼è”ç¼–ç å’Œï¼ˆå³ï¼‰å¯¹æ¯”å¤šæ®µå¤šå¯¼è”ç¼–ç ä¸­çš„Kä¸ªå®ä¾‹çš„å°æ‰¹é‡çš„ç›¸ä¼¼æ€§çŸ©é˜µã€‚å°†åŸºäºæ‰€æœ‰åº”ç”¨çš„å˜æ¢è¿ç®—ç¬¦TAå’ŒTBå¯¹ç”Ÿæˆé™„åŠ çŸ©é˜µã€‚æ²¿ç€è¾¹ç¼˜æ²¿ç€ç¤ºå‡ºäº†ç¤ºä¾‹æ€§å˜æ¢çš„ECGå®ä¾‹ã€‚ä¸ºäº†è¯†åˆ«é˜³æ€§å¯¹ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªå®ä¾‹ä¸å…¶æ‚£è€…IDç›¸å…³è”ã€‚é€šè¿‡è®¾è®¡ï¼Œå¯¹è§’å…ƒç´ ï¼ˆç»¿è‰²ï¼‰å¯¹åº”äºåŒä¸€æ‚£è€…ï¼Œæœ‰åŠ©äºç­‰å¼2.ç±»ä¼¼åœ°ï¼Œå®ä¾‹1å’Œå®ä¾‹50ï¼ˆé»„è‰²ï¼‰å±äºåŒä¸€æ‚£è€…ï¼Œæœ‰åŠ©äºç­‰å¼ï¼ˆ1ï¼‰ã€‚3.è“è‰²åŒºåŸŸå¯¹åº”äºé˜´æ€§ç¤ºä¾‹ï¼Œå› ä¸ºå®ƒä»¬æ¶‰åŠæ¥è‡ªä¸åŒæ‚£è€…çš„å®ä¾‹ã€‚</p>
<p>æ•°æ®åˆ’åˆ†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">frame</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">input_frame</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">label</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#(1,5000,12) #SxL = Samples x Leads</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">frame_views</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2500</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nviews</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#nviews = nleads in this case (1x2500x12*nsegments)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">nsegments</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">//</span><span class="mi">2500</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">fcount</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nviews</span><span class="p">):</span> <span class="c1">#nviews = # of leads</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">   <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsegments</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">       <span class="n">start</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="mi">2500</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">       <span class="n">current_view</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">start</span><span class="p">:</span><span class="n">start</span><span class="o">+</span><span class="mi">2500</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">       <span class="n">current_view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obtain_perturbed_frame</span><span class="p">(</span><span class="n">current_view</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">       <span class="n">current_view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_frame</span><span class="p">(</span><span class="n">current_view</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">       <span class="n">frame_views</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="n">fcount</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_view</span>  
</span></span><span class="line"><span class="ln">14</span><span class="cl">       <span class="n">fcount</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"># =&gt; (1, 2500, 24) </span>
</span></span></code></pre></div><p>â­<em><strong>CMSMLC(Contrastive Multi-segment Multi-lead Coding)</strong></em></p>
<p>Lossåˆ†æï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">pids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>  <span class="c1"># patient id</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">feature_dim</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>   <span class="c1"># batch, dim_feature, nviews</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"># 1. å…ˆæ ‡è®°ç›¸åŒæ‚£è€…çš„æ ·æœ¬</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="c1"># 2. è®¡ç®—å„ä¸ªè§†å›¾çš„ç›¸ä¼¼æ€§</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">view_combinations</span> <span class="o">=</span> <span class="n">combinations</span><span class="p">(</span><span class="n">nviews</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1"># (0,1), (0,2), (0,3)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1">#        (1,2), (1,3)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1">#               (2,3)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">loss</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">ncombinations</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">view_combinations</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="n">view1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="n">view2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="n">norm1_vector</span> <span class="o">=</span> <span class="n">view1_array</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="n">norm2_vector</span> <span class="o">=</span> <span class="n">view2_array</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="n">sim_matrix</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">view1</span><span class="p">,</span><span class="n">view2</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="n">norm_matrix</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">norm1_vector</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">norm2_vector</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="n">argument</span> <span class="o">=</span> <span class="n">sim_matrix</span> <span class="o">/</span> <span class="p">(</span><span class="n">norm_matrix</span> <span class="o">*</span> <span class="n">temperature</span><span class="p">)</span>  <span class="c1"># temperature=0.1</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="n">sim_matrix_exp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="c1"># obtain element</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="n">triu_elements</span> <span class="o">=</span> <span class="n">sim_matrix_exp</span><span class="p">[</span><span class="n">rows1</span><span class="p">,</span><span class="n">cols1</span><span class="p">]</span>  <span class="c1"># upper triangle</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="n">tril_elements</span> <span class="o">=</span> <span class="n">sim_matrix_exp</span><span class="p">[</span><span class="n">rows2</span><span class="p">,</span><span class="n">cols2</span><span class="p">]</span>  <span class="c1"># lower triangle</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="n">diag_elements</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">sim_matrix_exp</span><span class="p">)</span>   <span class="c1"># ä¸»å¯¹è§’</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    
</span></span><span class="line"><span class="ln">28</span><span class="cl">    <span class="n">triu_sum</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sim_matrix_exp</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="n">tril_sum</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sim_matrix_exp</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            
</span></span><span class="line"><span class="ln">31</span><span class="cl">    <span class="n">loss_diag1</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">diag_elements</span><span class="o">/</span><span class="n">triu_sum</span><span class="p">))</span>  <span class="c1"># A =&gt; B</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">    <span class="n">loss_diag2</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">diag_elements</span><span class="o">/</span><span class="n">tril_sum</span><span class="p">))</span>  <span class="c1"># B =&gt; A</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">            
</span></span><span class="line"><span class="ln">34</span><span class="cl">    <span class="n">loss_triu</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">triu_elements</span><span class="o">/</span><span class="n">triu_sum</span><span class="p">[</span><span class="n">rows1</span><span class="p">]))</span>  <span class="c1"># ä¸Šä¸‰è§’å¯¹åº”çš„è¡Œ</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="n">loss_tril</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tril_elements</span><span class="o">/</span><span class="n">tril_sum</span><span class="p">[</span><span class="n">cols2</span><span class="p">]))</span>  <span class="c1"># ä¸‹ä¸‰è§’å¯¹åº”çš„åˆ—</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">    
</span></span><span class="line"><span class="ln">37</span><span class="cl">    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_diag1</span> <span class="o">+</span> <span class="n">loss_diag2</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="n">loss_terms</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">
</span></span><span class="line"><span class="ln">40</span><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">        <span class="n">loss</span> <span class="o">+=</span> <span class="n">loss_triu</span> <span class="c1">#technically need to add 1 more term for symmetry</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">        <span class="n">loss_terms</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">
</span></span><span class="line"><span class="ln">44</span><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">            <span class="n">loss</span> <span class="o">+=</span> <span class="n">loss_tril</span> <span class="c1">#technically need to add 1 more term for symmetry</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">            <span class="n">loss_terms</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">            
</span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="n">ncombinations</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span><span class="o">/</span><span class="p">(</span><span class="n">loss_terms</span><span class="o">*</span><span class="n">ncombinations</span><span class="p">)</span>  <span class="c1"># loss/(4*6) æ¯ä¸ªè§†å›¾4ä»½lossï¼Œæ€»å…±ç®—6å¯¹</span>
</span></span></code></pre></div><p><img alt="image-20240731205058921" loading="lazy" src="http://verification.longcoding.top/FjYJ_QqmCMk7qjA-ylYR4ZJlLNsj"></p>
<p><img alt="image-20240731204919944" loading="lazy" src="http://verification.longcoding.top/FqAMVPcFHZsfJvQDYfgwW3l1h1g8"></p>
<hr>
<h3 id="guiding-masked-representation-learning----iclr-2024">GUIDING MASKED REPRESENTATION LEARNING  - ICLR 2024<a hidden class="anchor" aria-hidden="true" href="#guiding-masked-representation-learning----iclr-2024">#</a></h3>
<p>â­å¿ƒç”µå›¾è¿›è¡Œç®€å•çš„æ•°æ®å¢å¼ºä¹Ÿå¯èƒ½ä¼šä¸¥é‡æ”¹å˜ç—…ç†ä¿¡æ¯</p>
<p>âœ”ï¸åˆ©ç”¨MAEæ–¹æ³•ï¼Œç”Ÿæˆå¼è‡ªç›‘ç£å­¦ä¹ </p>
<p>3ç§åµŒå…¥æ–¹å¼ï¼Œ<em><strong>æ—¶é—´-ç©ºé—´-æ—¶ç©º</strong></em></p>
<p><img alt="image-20240731152623466" loading="lazy" src="http://verification.longcoding.top/FlMb8O9N6mflZp08gDh4JC6fnKTd"></p>
<p>æ¨¡å‹ï¼š</p>
<p><img alt="image-20240731152710546" loading="lazy" src="http://verification.longcoding.top/FmsW4LnhaLoqEoKTePQMa4II-s4q"></p>
<p>position embeddingsï¼š ä½¿ç”¨åŒä¸€ç»„ä½ç½®-å…±äº«</p>
<p>lead-embeddings:   æ¯ä¸ªå¯¼è”ä¸“ç”¨-æ ‡è®°å¯¼è”ç¼–å·</p>
<p>[SEP]: åŒºåˆ†å„ä¸ªå¯¼è”Patch</p>
<p>ä¸ºäº†å¢åŠ é‡å»ºéš¾åº¦ï¼š</p>
<ol>
<li>Decoderéƒ¨åˆ†åªçœ‹åŒä¸€å¯¼è”çš„Patchï¼›=&gt; ç¡®ä¿é‡å»ºæ—¶ä¸ä¼šæ˜¾å¼ä½¿ç”¨å…¶ä»–å¯¼è”çš„åµŒå…¥ =&gt; è¿«ä½¿æ¨¡å‹æœ‰æ•ˆåœ°å­¦ä¹ æ—¶ç©ºè¡¨ç¤º</li>
</ol>
<p>ä»£ç åˆ†æï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># x: [batch, 12, 2250]</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">series</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"># === forward_encoder ===</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">patch_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># segment-&gt;LN-&gt;Linear-&gt;LN, =&gt; [batch, 12, 30, 75]</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">pos_embedding</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># lead-inter shared pos embedding</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1"># mask </span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">len_keep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mask_ratio</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">ids_shuffle</span> <span class="c1"># [batch, 12, 30] æ®µç¼–å·æ‰“ä¹±</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">ids_restore</span> <span class="c1"># æ®µç¼–å·åŸå§‹é¡ºåº</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">ids_keep</span> <span class="o">=</span> <span class="n">ids_shuffle</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="n">len_keep</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">x_masked</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">ids_keep</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="n">mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">num_leads</span><span class="p">,</span> <span class="n">n</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="n">mask</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="n">len_keep</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1"># === x_masked, mask, ids_restore === </span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"># embedding </span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">left_sep</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">right_sep</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="n">lead_embeddings</span> <span class="o">=</span> <span class="n">lead_embeddings</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_masked_with_sep</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">lead_embeddings</span>  <span class="c1"># lead-intra shared lead embedding</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="c1"># Transformer Encoder x 12</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="c1"># === forward_decoder === </span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_decoder_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># ç»´åº¦æ˜ å°„</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="c1"># åˆå§‹åŒ–è¢«maskæ‰çš„patch</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="n">mask_embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_embedding</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="n">mask_embeddings</span> <span class="o">=</span> <span class="n">mask_embeddings</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_leads</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">n_masked_with_sep</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="n">x_wo_sep</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">mask_embeddings</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># [X..,masked,..]</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="n">x_wo_sep</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">x_wo_sep</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">ids_restore</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>  <span class="c1"># æ¢å¤ä½ç½®</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="n">x_wo_sep</span> <span class="o">=</span> <span class="n">x_wo_sep</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_pos_embed</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># é‡æ–°æ·»åŠ ä½ç½®ä¿¡æ¯</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="n">left_sep</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_pos_embed</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="n">right_sep</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_pos_embed</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">left_sep</span><span class="p">,</span> <span class="n">x_wo_sep</span><span class="p">,</span> <span class="n">right_sep</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="n">x_decoded</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_leads</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">    <span class="n">x_lead</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_blocks</span><span class="p">:</span>  <span class="c1"># Transformer Encoder x 6</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">        <span class="n">x_lead</span> <span class="o">=</span> <span class="n">block</span><span class="p">(</span><span class="n">x_lead</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">        <span class="n">x_lead</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_norm</span><span class="p">(</span><span class="n">x_lead</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">        <span class="n">x_lead</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_head</span><span class="p">(</span><span class="n">x_lead</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">        <span class="n">x_decoded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_lead</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x_decoded</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">
</span></span><span class="line"><span class="ln">51</span><span class="cl"><span class="c1"># === loss ===</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patchify</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">
</span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl"><span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (batch_size, num_leads, n), mean loss per patch</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">
</span></span><span class="line"><span class="ln">57</span><span class="cl"><span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">loss</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># mean loss on removed patches</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl"><span class="c1"># mask: [batch, 12, 30], å…¶ä¸­1ä»£è¡¨è¢«maskï¼Œ0è¡¨ç¤ºæ²¡æœ‰è¢«mask</span>
</span></span></code></pre></div><p><em>å¾®è°ƒæ—¶å–Encoderéƒ¨åˆ†</em></p>
<hr>
<hr>
<h2 id="å®éªŒ">å®éªŒ<a hidden class="anchor" aria-hidden="true" href="#å®éªŒ">#</a></h2>
<h3 id="inceptionformer">InceptionFormer<a hidden class="anchor" aria-hidden="true" href="#inceptionformer">#</a></h3>
<p><em><strong>InceptionNeXt + SMT</strong></em></p>
<blockquote>
<p>å›¾ç¤ºä»¿ç…§SMTé£æ ¼ç»˜åˆ¶</p></blockquote>
<ul>
<li>ä»¿ç…§SMTçš„æ¸è¿›èåˆç½‘ç»œç»“æ„</li>
<li>å‰åŠéƒ¨åˆ†ä½¿ç”¨ InceptionNeXtç»“æ„å—ï¼ŒDConvå·ç§¯ä»£æ›¿MHSA</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c"># æ¨¡å‹ FLOPs: 2.14G</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹å‚æ•°æ•°é‡: 12.45M</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="l">cnnblock = StemConv()                 </span><span class="w"> </span><span class="c"># 1, 12, 1000</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹ FLOPs: 36.74M</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹å‚æ•°æ•°é‡: 36.72K</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w"></span><span class="l">CNNBlock1 = getattr(model, &#39;block0&#39;)  </span><span class="w"> </span><span class="c"># 1, 64, 1000</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹ FLOPs: 35.07M</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹å‚æ•°æ•°é‡: 35.07K</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w"></span><span class="l">CNNBlock2 = getattr(model, &#39;block1&#39;)  </span><span class="w"> </span><span class="c"># 1, 128, 500</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹ FLOPs: 135.68M</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹å‚æ•°æ•°é‡: 271.36K</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w"></span><span class="l">MixBlock = getattr(model, &#39;block2&#39;)   </span><span class="w"> </span><span class="c"># 1, 256, 250</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹ FLOPs: 793.09M</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹å‚æ•°æ•°é‡: 3.18M</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w"></span><span class="l">MHSABlock = getattr(model, &#39;block3&#39;)  </span><span class="w"> </span><span class="c"># 1, 512, 125</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹ FLOPs: 1.05G</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w"></span><span class="c"># æ¨¡å‹å‚æ•°æ•°é‡: 8.41M</span><span class="w">
</span></span></span></code></pre></div><h4 id="æ¨¡å‹æ¡†æ¶">æ¨¡å‹æ¡†æ¶<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å‹æ¡†æ¶">#</a></h4>
<p><img alt="image-20240307212600434" loading="lazy" src="http://verification.longcoding.top/FsNnhqajz8TUXNFuHkjNO7x2TQ6r"></p>
<center style="font-weight:bolder; color:rgb(4A,4A,4A);">æ¨¡å‹æ¡†æ¶</center>
<p><strong>Stem æ¨¡å—ï¼š</strong></p>
<blockquote>
<p>å‚è€ƒï¼šA token selection-based multi-scale dual-branch CNN-transformer  ä¸€åŒºè®ºæ–‡</p></blockquote>
<p>æ ‡å‡†ä¸€ç»´å·ç§¯ï¼Œå¤šå°ºåº¦æå–ç‰¹å¾ï¼Œæå–ECGå½¢æ€ä¿¡æ¯ã€‚<em><strong>å…¨é¢</strong></em>æå–ï¼ˆæºå¸¦å†—ä½™ä¿¡æ¯ï¼‰  # shape: 12, 1000  =&gt; 128ï¼Œ1000</p>
<p><img alt="image-20240307212809248" loading="lazy" src="http://verification.longcoding.top/Fu16qcDleveylB7vzaWnL5xUGg9d"></p>
<p><strong>Blockï¼š</strong></p>
<p><img alt="image-20240307213204707" loading="lazy" src="http://verification.longcoding.top/Fq3DUteSU_WSdplw7JfmABvNFYbc"></p>
<p><strong>Patch Fusion:</strong></p>
<p>â€‹	ä½¿ç”¨Conv1Dï¼Œkernel_size=3ï¼Œstride=2, padding=1   =&gt; é‡å å¼åµŒå…¥ï¼Œå‡å°‘Tokenæ•°é‡ï¼Œå¢åŠ Tokenç»´åº¦(å¢åŠ Tokenæºå¸¦ä¿¡æ¯çš„ä¸°å¯Œåº¦)</p>
<p><em>å›¾ç¤ºï¼š</em> â‘ Tokené—´  â‘¡Tokenå†…</p>
<p><img alt="image-20240312132746778" loading="lazy" src="http://verification.longcoding.top/FixTAltVtt8JDqNcAB9Cd44Tk2mV"></p>
<h4 id="è‡ªæ³¨æ„åŠ›">è‡ªæ³¨æ„åŠ›<a hidden class="anchor" aria-hidden="true" href="#è‡ªæ³¨æ„åŠ›">#</a></h4>
<p><em>åœ¨InceptionFormerä¸Šå®éªŒ</em></p>
<ul>
<li><strong>Multi Head Self Attention</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">Test	  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8410</span><span class="w"> 
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">Validate  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8184</span><span class="w"> 
</span></span></span></code></pre></div><ul>
<li>
<p><strong>SR-MHSA</strong>  ä½¿ç”¨Conv1D stride=2 ç¼©å°Kï¼ŒVçš„TokenMapï¼Œå‡å°‘Tokenæ•°é‡</p>
<p><em>sr-ratio = 2</em></p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">Test	  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8137</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">Validate  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8216</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>
<p><strong>Bi-Routing Attention</strong>  &ndash; SRä¸æ ‡å‡†çš„æŠ˜ä¸­</p>
<p>è¶…å‚ï¼šnum_window=25ï¼Œtopk=10</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">Test	  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8344</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">Validate  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8199</span><span class="w">
</span></span></span></code></pre></div><ul>
<li><strong>Window Attention</strong>  &ndash; å•çº¯çª—å£çº§	âŒå¤šä½™çš„ç‰ˆæœ¬ - ä¸å¦‚MobileViTBlock</li>
</ul>
<p>â—æ²¡åŠ CNNå…ˆå±€éƒ¨èåˆ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">Test	  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8261</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">Validate  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8148</span><span class="w">
</span></span></span></code></pre></div><ul>
<li><strong>Shift Window Attention</strong></li>
</ul>
<p><em><strong>æ„Ÿè§‰æœ‰ç‚¹é—®é¢˜ï¼Œæ•ˆæœä¸å¦‚ WAï¼Œæ··åˆç»“æ„çš„é—®é¢˜ï¼Ÿå‰é¢è¿›è¡Œçš„äº¤é”™çš„CNNå’ŒMHSAï¼Ÿ</strong></em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">Test	  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8129</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">Validate  Best F1</span><span class="p">:</span><span class="w"> </span><span class="m">0.8100</span><span class="w">
</span></span></span></code></pre></div><ul>
<li><strong>çº§è”åˆ é™¤Tokenå’Œä¿®å‰ªHead</strong></li>
</ul>
<p>å»æ‰å†—ä½™çš„ â—<em><strong>æœªæµ‹è¯•</strong></em></p>
<h4 id="ä½ç½®åµŒå…¥">ä½ç½®åµŒå…¥<a hidden class="anchor" aria-hidden="true" href="#ä½ç½®åµŒå…¥">#</a></h4>
<ul>
<li><strong>å‰æœŸ</strong>ç›´æ¥èè¿›Tokenä¸­  &ndash; ViT <em>ä»…ä¸€æ¬¡</em></li>
</ul>
<p>â€‹		ä¾‹ï¼šdata: [batch, num_token, dim_token]    learnable_pos_embed: [batch, num_token, dim_token]</p>
<p>â€‹		data + pos_embed</p>
<ul>
<li>æ³¨æ„åŠ›<strong>è®¡ç®—ä¸­</strong>å¼•å…¥         &ndash; SwinT  <em>æ¯æ¬¡</em></li>
</ul>
<p>â€‹		ä¾‹ï¼š att:[num_token, num_token]  + relative_pos_bias:[num_token, num_token]</p>
<p>â€‹		è®©ç›¸å¯¹ä½ç½®ä¿¡æ¯(è‡ªå­¦ä¹ )å½±å“æ³¨æ„åŠ›æƒé‡</p>
<ul>
<li>DWConv å¼•å…¥å±€éƒ¨ä½ç½®ä¿¡æ¯ / åœ¨è®¡ç®—å®Œè‡ª<strong>æ³¨æ„åŠ›å‰</strong>     &ndash; Bi-Routing-Attention  <em>æ¯æ¬¡</em></li>
</ul>
<p>â€‹		ä¾‹ï¼š DWConv(x) + EncoderBlock(x)</p>
<ul>
<li>DWConvå¢å¼ºä½ç½®ä¿¡æ¯ / åœ¨è®¡ç®—å®Œè‡ª<strong>æ³¨æ„åŠ›ä¸­</strong>     &ndash; Bi-Routing-Attention  <em>æ¯æ¬¡</em></li>
</ul>
<p>â€‹		ä¾‹ï¼š SoftMax(<a href="mailto:Q@K.T">Q@K.T</a>/âˆšd)@ (V + DWConv(V) )</p>
<h4 id="ç°å­˜é—®é¢˜"><strong>ç°å­˜é—®é¢˜</strong><a hidden class="anchor" aria-hidden="true" href="#ç°å­˜é—®é¢˜">#</a></h4>
<ul>
<li>
<p>â­æ²¡æœ‰ä¸ºMHSAè®¡ç®—æ—¶<strong>æ·»åŠ ä½ç½®ä¿¡æ¯</strong></p>
<ul>
<li>DWConv ä»£æ›¿ä½ç½®ç¼–ç </li>
<li>MHSAä¹‹å‰åŠ å…¥å¯å­¦ä¹ çš„ä½ç½®å‘é‡</li>
</ul>
</li>
<li>
<p>æ¸è¿›å¼æ¨¡å—èåˆç­–ç•¥</p>
<ul>
<li>äº¤é”™</li>
<li>å¹¶è¡Œï¼Ÿ</li>
</ul>
</li>
<li>
<p>æ²¡æœ‰ä¼˜åŒ–è‡ªæ³¨æ„åŠ›çš„è®¡ç®—</p>
</li>
<li>
<p>DConvçš„ä¼˜åŒ–</p>
</li>
</ul>
<hr>
<h3 id="inceptionformer--å·ç§¯è°ƒåˆ¶">InceptionFormer + å·ç§¯è°ƒåˆ¶<a hidden class="anchor" aria-hidden="true" href="#inceptionformer--å·ç§¯è°ƒåˆ¶">#</a></h3>
<p><em><strong>InceptionNeXtBlock =&gt; ConvModulation =&gt; MHSA</strong></em></p>
<p>å·ç§¯ =&gt; å·ç§¯Ã—è°ƒåˆ¶ =&gt; è°ƒåˆ¶Ã—è‡ªæ³¨æ„åŠ› =&gt; è‡ªæ³¨æ„åŠ›</p>
<p>x2              x4                       x8                       x4</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">acc</span><span class="p">:</span> <span class="mf">0.8299</span><span class="p">,</span> <span class="n">f1</span><span class="p">:</span> <span class="mf">0.8418</span><span class="p">,</span> <span class="n">macro_auc</span><span class="p">:</span> <span class="mf">0.9679</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">classes</span><span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;I-AVB&#39;</span>  <span class="s1">&#39;AF&#39;</span>   <span class="s1">&#39;LBBB&#39;</span>   <span class="s1">&#39;RBBB&#39;</span>  <span class="s1">&#39;NORM&#39;</span>  <span class="s1">&#39;PAC&#39;</span>   <span class="s1">&#39;STD&#39;</span>  <span class="s1">&#39;STE&#39;</span>   <span class="s1">&#39;PVC&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">test</span> <span class="n">f1s</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9252</span><span class="p">,</span> <span class="mf">0.9231</span><span class="p">,</span> <span class="mf">0.902</span><span class="p">,</span> <span class="mf">0.9477</span><span class="p">,</span> <span class="mf">0.8261</span><span class="p">,</span> <span class="mf">0.6733</span><span class="p">,</span> <span class="mf">0.8161</span><span class="p">,</span> <span class="mf">0.7805</span><span class="p">,</span> <span class="mf">0.782</span><span class="p">]</span>
</span></span></code></pre></div><p><strong>å…¨å±€å¹³å‡æ± åŒ– =&gt; CLS Token</strong></p>
<p>â—Validate F1 score only 0.8185	# ç¨³å¥æ€§ä¸€èˆ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">acc</span><span class="p">:</span> <span class="mf">0.8343</span><span class="p">,</span> <span class="n">f1</span><span class="p">:</span> <span class="mf">0.8488</span><span class="p">,</span> <span class="n">macro_auc</span><span class="p">:</span> <span class="mf">0.9677</span> <span class="n">threshold</span><span class="p">:</span> <span class="mf">0.8</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">classes</span><span class="p">:</span>   <span class="p">[</span><span class="s1">&#39;I-AVB&#39;</span>  <span class="s1">&#39;AF&#39;</span>   <span class="s1">&#39;LBBB&#39;</span>   <span class="s1">&#39;RBBB&#39;</span>  <span class="s1">&#39;NORM&#39;</span>  <span class="s1">&#39;PAC&#39;</span>   <span class="s1">&#39;STD&#39;</span>  <span class="s1">&#39;STE&#39;</span>   <span class="s1">&#39;PVC&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">F1</span> <span class="n">Scores</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9028</span><span class="p">,</span> <span class="mf">0.9587</span><span class="p">,</span> <span class="mf">0.9412</span><span class="p">,</span> <span class="mf">0.9444</span><span class="p">,</span> <span class="mf">0.7861</span><span class="p">,</span> <span class="mf">0.7308</span><span class="p">,</span> <span class="mf">0.8046</span><span class="p">,</span> <span class="mf">0.7895</span><span class="p">,</span> <span class="mf">0.7813</span>
</span></span></code></pre></div><p>âŒ<strong>PAC  ä»ç„¶æ”¹å–„ä¸äº†</strong></p>
<h4 id="æ³¨æ„åŠ›å¯è§†åŒ–">æ³¨æ„åŠ›å¯è§†åŒ–<a hidden class="anchor" aria-hidden="true" href="#æ³¨æ„åŠ›å¯è§†åŒ–">#</a></h4>
<p><img alt="image-20240321214200346" loading="lazy" src="http://verification.longcoding.top/Fr9n4nyTsCBn5iEaSrXymPMghq5e"></p>
<p><img alt="image-20240321214221728" loading="lazy" src="http://verification.longcoding.top/Fq7kGrJi1Zr4ArjVKTra1OBKCO4v"></p>
<p><img alt="image-20240321214245731" loading="lazy" src="http://verification.longcoding.top/Fpzwlg1dLDAUDaNWNS6nednn_qPs"><img alt="image-20240323153412375" loading="lazy" src="http://verification.longcoding.top/FlC1-fpMQR9PBZW4hZwHUEUYlkFw"></p>
<p><img alt="image-20240323153505140" loading="lazy" src="http://verification.longcoding.top/FqxORjFqQpnvQPjU5bw4pHZZTWkG"></p>
<h3 id="inceptionformer--shunt"><em><strong>InceptionFormer + Shunt</strong></em><a hidden class="anchor" aria-hidden="true" href="#inceptionformer--shunt">#</a></h3>
<p><em><strong>Shunt Self Attention =&gt; InceptionFormer</strong></em></p>
<p><strong>åœ¨å¤šå¤´éƒ¨åˆ†åµŒå…¥å¤šå°ºåº¦</strong>ã€‚8å¤´è‡ªæ³¨æ„åŠ›ï¼Œ 1/2å¤´æ‰§è¡Œåƒç´ çº§è‡ªæ³¨æ„åŠ›ï¼Œ1/4å¤´æ‰§è¡Œä¸‹é‡‡æ ·2å€çš„å—çº§è‡ªæ³¨æ„åŠ›ï¼Œ1/4å¤´æ‰§è¡Œä¸‹é‡‡æ ·4å€çš„åŸŸçº§è‡ªæ³¨æ„åŠ›</p>
<p><img alt="image-20240321215459046" loading="lazy" src="http://verification.longcoding.top/FjM0Qp7pfXVvJTZ7EzvwhckVNV67"></p>
<p><strong>åœ¨è®¡ç®—è‡ªæ³¨æ„åŠ›æ—¶ï¼Œå®ç°å¤šå°ºåº¦</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">acc</span><span class="p">:</span> <span class="mf">0.8154</span><span class="p">,</span> <span class="n">f1</span><span class="p">:</span> <span class="mf">0.8389</span><span class="p">,</span> <span class="n">macro_auc</span><span class="p">:</span> <span class="mf">0.9682</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">classes</span><span class="p">:</span>   <span class="p">[</span><span class="s1">&#39;I-AVB&#39;</span>  <span class="s1">&#39;AF&#39;</span>   <span class="s1">&#39;LBBB&#39;</span>   <span class="s1">&#39;RBBB&#39;</span>  <span class="s1">&#39;NORM&#39;</span>  <span class="s1">&#39;PAC&#39;</span>   <span class="s1">&#39;STD&#39;</span>  <span class="s1">&#39;STE&#39;</span>   <span class="s1">&#39;PVC&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">F1</span> <span class="n">Scores</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9065</span><span class="p">,</span> <span class="mf">0.9283</span><span class="p">,</span> <span class="mf">0.8511</span><span class="p">,</span> <span class="mf">0.9296</span><span class="p">,</span> <span class="mf">0.7865</span><span class="p">,</span> <span class="mf">0.6531</span><span class="p">,</span> <span class="mf">0.8193</span><span class="p">,</span> <span class="mf">0.8421</span><span class="p">,</span> <span class="mf">0.8333</span><span class="p">]</span>
</span></span></code></pre></div><p>â—<strong>PAC</strong></p>
<p><img alt="image-20240323152854941" loading="lazy" src="http://verification.longcoding.top/FpEiiDzmrebCmlBWg6NzE0mvsE0h"></p>
<p><img alt="image-20240321221939637" loading="lazy" src="http://verification.longcoding.top/FvS0TbuQv2iuecYcp_3YCOdaReWG"></p>
<p><img alt="image-20240321221958275" loading="lazy" src="http://verification.longcoding.top/FhOpvWHbC-0OYZbH2e3HeJfOe_0H"></p>
<p><img alt="image-20240321222022287" loading="lazy" src="http://verification.longcoding.top/Frz6qYKV9L3zNIT00capxCx2KJIN"></p>
<hr>
<p><strong>InceptionFormer: MS-DWConv + MHSA</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">éªŒè¯é›†</span><span class="p">:</span> <span class="mi">9</span><span class="o">-</span><span class="n">Fold</span><span class="p">,</span> <span class="n">æµ‹è¯•é›†</span><span class="p">:</span> <span class="mi">10</span><span class="o">-</span><span class="n">Fold</span><span class="o">.</span>                                                                               
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">                                                               
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="mf">0.8328</span><span class="p">,</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8530</span><span class="p">,</span> <span class="n">Auc</span><span class="p">:</span> <span class="mf">0.9701</span><span class="p">,</span> <span class="n">Threshold</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">Test_loss</span><span class="p">:</span> <span class="mf">0.2225</span>                                        
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">F1s</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.8936&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9219&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9200&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9505&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8298&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6972&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8315&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8000&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8321&#39;</span><span class="p">]</span>                
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">                                                                                                               
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="mf">0.7918</span><span class="p">,</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8247</span><span class="p">,</span> <span class="n">Auc</span><span class="p">:</span> <span class="mf">0.9564</span><span class="p">,</span> <span class="n">Threshold</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">Vali_loss</span><span class="p">:</span> <span class="mf">0.2764</span>                                        
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">F1s</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.8971&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9160&#39;</span><span class="p">,</span> <span class="s1">&#39;1.0000&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9020&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7831&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6981&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7600&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6154&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8504&#39;</span><span class="p">]</span>                
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">  
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"># æ­¤å¤„ï¼Œä»…å–å¹³å‡ï¼Œæœ€ç»ˆåº”è¯¥ç»„åˆåœ¨ä¸€èµ·è¿›è¡Œæµ‹è¯•ï¼Œå› ä¸ºé˜ˆå€¼ä¸ä¸€è‡´</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="mf">0.8123</span><span class="p">,</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8388</span><span class="p">,</span> <span class="n">Auc</span><span class="p">:</span> <span class="mf">0.9633</span>  <span class="n">Average</span> <span class="n">Test</span> <span class="ow">and</span> <span class="n">Validate</span>                                                
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">F1s</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.8953&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9189&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9600&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9263&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8064&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6977&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7957&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7077&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8413&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1"># æ¨¡å‹ FLOPs: 2.14G</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"># æ¨¡å‹å‚æ•°æ•°é‡: 12.45M</span>
</span></span></code></pre></div><p><strong>InceptionFormer: MS-DWConv + S-MHSA</strong></p>
<p>âŒæ•°æ®æ•æ„Ÿ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">éªŒè¯é›†</span><span class="p">:</span> <span class="mi">9</span><span class="o">-</span><span class="n">Fold</span><span class="p">,</span> <span class="n">æµ‹è¯•é›†</span><span class="p">:</span> <span class="mi">10</span><span class="o">-</span><span class="n">Fold</span><span class="o">.</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="mf">0.8125</span><span class="p">,</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8204</span><span class="p">,</span> <span class="n">Auc</span><span class="p">:</span> <span class="mf">0.9686</span><span class="p">,</span> <span class="n">Threshold</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">Test_loss</span><span class="p">:</span> <span class="mf">0.2426</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">F1s</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.8467&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9143&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8800&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9344&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8021&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6355&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8452&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7368&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7883&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="mf">0.7918</span><span class="p">,</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8163</span><span class="p">,</span> <span class="n">Auc</span><span class="p">:</span> <span class="mf">0.9556</span><span class="p">,</span> <span class="n">Threshold</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">Vali_loss</span><span class="p">:</span> <span class="mf">0.2814</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">F1s</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.8841&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8934&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9778&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9091&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7340&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7037&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7925&#39;</span><span class="p">,</span> <span class="s1">&#39;0.5946&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8571&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="mf">0.8022</span><span class="p">,</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8183</span><span class="p">,</span> <span class="n">Auc</span><span class="p">:</span> <span class="mf">0.9621</span>  <span class="n">Average</span> <span class="n">Test</span> <span class="ow">and</span> <span class="n">Validate</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">F1s</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.8654&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9039&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9289&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9218&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7681&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6696&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8188&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6657&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8227&#39;</span><span class="p">]</span>
</span></span></code></pre></div><p><strong>InceptionFormer: MS-DWConv-SE + MHSA</strong></p>
<p>è‡ªåŠ¨é‡æ–°æ ¡å‡†  - é€šé“é‡è¦æ€§</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">Validate</span><span class="p">:</span> <span class="n">Acc</span><span class="p">:</span><span class="mf">0.788937409</span>	<span class="n">F1</span><span class="p">:</span><span class="mf">0.819458854</span>	
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">Test</span>    <span class="p">:</span> <span class="n">Acc</span><span class="p">:</span><span class="mf">0.827034884</span>	<span class="n">F1</span><span class="p">:</span><span class="mf">0.835588466</span>
</span></span></code></pre></div><p><strong>InceptionFormer: MS-DWConv-CA + MHSA</strong></p>
<p>åŒæ—¶æ ¡å‡† é€šé“ + ç©ºé—´ é‡è¦æ€§</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">Validate</span><span class="p">:</span> <span class="n">Acc</span><span class="p">:</span><span class="mf">0.7991</span>	<span class="n">F1</span><span class="p">:</span><span class="mf">0.8315</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">Test</span>    <span class="p">:</span> <span class="n">Acc</span><span class="p">:</span><span class="mf">0.8096</span>	<span class="n">F1</span><span class="p">:</span><span class="mf">0.8194</span>
</span></span></code></pre></div><p><strong>InceptionFormer: only front 3 stage</strong></p>
<p>åˆ é™¤ç¬¬å››stageï¼Œé™ä½å‚æ•°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Best F1: 0.8395  Only front 3 layer</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># æ¨¡å‹ FLOPs: 1.04G</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"># æ¨¡å‹å‚æ•°æ•°é‡: 3.64M</span>
</span></span></code></pre></div><p><strong>InceptionFormer:  stage depth [2, 4, 8, 4] =&gt; [2, 4, 8, 2]</strong></p>
<p>å‡å°‘stage4å±‚æ•°</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># stage depths = [2, 4, 8, 2]</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># Best F1: 0.8422</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"># æ¨¡å‹ FLOPs: 1.61G</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"># æ¨¡å‹å‚æ•°æ•°é‡: 8.25M</span>
</span></span></code></pre></div><p><strong>InceptionFormer + SparseSemanticToken</strong></p>
<p><em>å‡å°‘Token</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Best F1: 0.8312  sparse token -- DW-SpatialPool</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># æ¨¡å‹ FLOPs: 1.53G</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"># æ¨¡å‹å‚æ•°æ•°é‡: 17.19M</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="n">SparseAttentionBlock</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="c1"># æ¨¡å‹ FLOPs: 236.95M</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="c1"># æ¨¡å‹å‚æ•°æ•°é‡: 4.74M</span>
</span></span></code></pre></div><p><strong>InceptionFormerTiny</strong></p>
<p><em>å‡å°‘Tokené•¿åº¦  dim_token: [64, 128, 256, 512] =&gt; [32, 64, 128, 256]</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Best F1: 0.8265</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># æ¨¡å‹ FLOPs: 536.07M</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"># æ¨¡å‹å‚æ•°æ•°é‡: 3.13M</span>
</span></span></code></pre></div><p>â­â­â­</p>
<p><strong>Baseline</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># resnet18</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">æ¨¡å‹</span> <span class="n">FLOPs</span><span class="p">:</span> <span class="mf">176.57</span><span class="n">M</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">æ¨¡å‹å‚æ•°æ•°é‡</span><span class="p">:</span> <span class="mf">3.85</span><span class="n">M</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">Best</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8168</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="c1"># resnet34</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">æ¨¡å‹</span> <span class="n">FLOPs</span><span class="p">:</span> <span class="mf">357.74</span><span class="n">M</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">æ¨¡å‹å‚æ•°æ•°é‡</span><span class="p">:</span> <span class="mf">7.23</span><span class="n">M</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">Best</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8185</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1"># mobilenetv2</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">æ¨¡å‹</span> <span class="n">FLOPs</span><span class="p">:</span> <span class="mf">96.60</span><span class="n">M</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">æ¨¡å‹å‚æ•°æ•°é‡</span><span class="p">:</span> <span class="mf">2.19</span><span class="n">M</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="n">Best</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.7967</span>	
</span></span></code></pre></div><hr>
<p><strong>PTB-XL</strong>  - æ¨è9æŠ˜éªŒè¯ 10æŠ˜æµ‹è¯•</p>
<p><strong>CPSC</strong>  - (æ¯”èµ›) 9æŠ˜éªŒè¯ 10æŠ˜æµ‹è¯•</p>
<hr>
<p><strong>ä¼˜åŒ–å™¨è°ƒæ•´</strong></p>
<p>Adamw + StepLR  =&gt; Adamw + CosineAnnealingLR</p>
<p>å›ºå®šæ­¥é•¿è¡°å‡å­¦ä¹ ç‡  =&gt; ä½™å¼¦é€€ç«è°ƒæ•´å­¦ä¹ ç‡</p>
<p>Adamw + StepLRï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># scheduler</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">step_size</span> <span class="o">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="n">step_gamma</span> <span class="o">=</span> <span class="mf">0.1</span>
</span></span></code></pre></div><p>Adamw + CosineAnnealingLR</p>
<p><em><strong>PASS</strong></em></p>
<hr>
<h3 id="é¢‘åŸŸç‰¹å¾">é¢‘åŸŸç‰¹å¾<a hidden class="anchor" aria-hidden="true" href="#é¢‘åŸŸç‰¹å¾">#</a></h3>
<p>æ•°æ®çš„å¦ä¸€ç§è¡¨è¾¾å½¢å¼ï¼Œæˆ–è€…åœ¨è¿™ä¸ªæ ¼å¼ä¸­ï¼ŒæŸäº›ç‰¹å¾ä¼šè¢«æ”¾å¤§ï¼Œä½¿å¾—å¯ä»¥è¢«è¯†åˆ«åˆ°</p>
<h3 id="time-domain">time domain<a hidden class="anchor" aria-hidden="true" href="#time-domain">#</a></h3>
<p><img alt="image-20240422221233452" loading="lazy" src="http://verification.longcoding.top/Fh5jqjyTnEuzDskq6BThKTGZmZD6"></p>
<table>
  <thead>
      <tr>
          <th style="text-align: center"></th>
          <th>I-AVB</th>
          <th>AF</th>
          <th>LBBB</th>
          <th>LBBB</th>
          <th>NORM</th>
          <th>PAC</th>
          <th>STD</th>
          <th>PVC</th>
          <th>STE</th>
          <th>å¹³å‡</th>
          <th>æè¿°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center"><strong>F1</strong></td>
          <td>0.8844</td>
          <td>0.9231</td>
          <td>0.8800</td>
          <td>0.9500</td>
          <td>0.7514</td>
          <td>0.6392</td>
          <td>0.8024</td>
          <td>0.7692</td>
          <td>0.7669</td>
          <td><strong>0.8185</strong></td>
          <td>æ—¶åºä¿¡å· &amp; ä¸€ç»´æ¨¡å‹</td>
      </tr>
  </tbody>
</table>
<h3 id="frequency-domain">frequency domain<a hidden class="anchor" aria-hidden="true" href="#frequency-domain">#</a></h3>
<p><img alt="image-20240422221515722" loading="lazy" src="http://verification.longcoding.top/FhOazUABP1FEUBFSsm73IMKpRG1U"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># [batch_size, num_leads, data_length]  =STFT=&gt; [batch_size, num_leads, W, H]</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># =&gt; resnet34</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"># =&gt; output</span>
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th style="text-align: center"></th>
          <th>I-AVB</th>
          <th>AF</th>
          <th>LBBB</th>
          <th>LBBB</th>
          <th>NORM</th>
          <th>PAC</th>
          <th>STD</th>
          <th>PVC</th>
          <th>STE</th>
          <th>å¹³å‡</th>
          <th>æè¿°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center"><strong>F1</strong></td>
          <td>0.7763</td>
          <td>0.9180</td>
          <td>0.8511</td>
          <td>0.8889</td>
          <td>0.7684</td>
          <td>0.6393</td>
          <td>0.7500</td>
          <td>0.7671</td>
          <td>0.7805</td>
          <td><strong>0.7933</strong></td>
          <td>æ—¶åºä¿¡å·é€šè¿‡STFTè½¬ä¸ºé¢‘è°±å›¾(æ±‰æ˜çª—å£100)</td>
      </tr>
  </tbody>
</table>
<h3 id="two-stream-time-and-frequency-domain">two-stream: time and frequency domain<a hidden class="anchor" aria-hidden="true" href="#two-stream-time-and-frequency-domain">#</a></h3>
<p><img alt="image-20240422214551861" loading="lazy" src="http://verification.longcoding.top/FqxAImdtxGqN53vY_GDxfwBhxXMO"></p>
<table>
  <thead>
      <tr>
          <th style="text-align: center"></th>
          <th>I-AVB</th>
          <th>AF</th>
          <th>LBBB</th>
          <th>LBBB</th>
          <th>NORM</th>
          <th>PAC</th>
          <th>STD</th>
          <th>PVC</th>
          <th>STE</th>
          <th>å¹³å‡</th>
          <th>æè¿°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center"><strong>F1</strong></td>
          <td>0.8993</td>
          <td>0.9255</td>
          <td>0.9020</td>
          <td>0.9326</td>
          <td>0.7817</td>
          <td>0.7040</td>
          <td>0.8000</td>
          <td>0.7805</td>
          <td>0.7619</td>
          <td><strong>0.8319</strong></td>
          <td>æ—¶åºä¿¡å·é€šè¿‡STFTè½¬ä¸ºé¢‘è°±å›¾(çª—å£100)</td>
      </tr>
  </tbody>
</table>
<h3 id="inceptionnext--shunted-self-attention-cross-stack">InceptionNeXt + Shunted-Self Attention ï¼ˆCross-Stackï¼‰<a hidden class="anchor" aria-hidden="true" href="#inceptionnext--shunted-self-attention-cross-stack">#</a></h3>
<p>1ï¸âƒ£</p>
<p><img alt="image-20240511210910969" loading="lazy" src="http://verification.longcoding.top/FkLWFrtOPtNHBGo55bV9mAsYVCbv"></p>
<p><em><strong>Inception depthwise convlution</strong></em></p>
<p>2ï¸âƒ£</p>
<p><img alt="image-20240511211011416" loading="lazy" src="http://verification.longcoding.top/Fjr6plVqNa0GART9yPBiBdJMP-c7"></p>
<p><em><strong>Self-Attention å†…éƒ¨å®ç°ç²—ç»†ç²’åº¦</strong></em></p>
<p>3ï¸âƒ£</p>
<p><img alt="image-20240511211237019" loading="lazy" src="http://verification.longcoding.top/FiKUcUVgiO_MBNzz1xtBXICK4OCN"></p>
<p><em><strong>ç‰¹å¾å›¾  =&gt; é‡‘å­—å¡”ç»“æ„</strong></em>  ï¼ˆä¸­é—´CNNå’ŒTransformerèåˆï¼Œäº¤å‰å †å ï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">classes</span><span class="p">:</span>  
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">     <span class="p">[</span><span class="s1">&#39;I-AVB&#39;</span>   <span class="s1">&#39;AF&#39;</span>      <span class="s1">&#39;LBBB&#39;</span>    <span class="s1">&#39;RBBB&#39;</span>    <span class="s1">&#39;NORM&#39;</span>    <span class="s1">&#39;PAC&#39;</span>     <span class="s1">&#39;STD&#39;</span>     <span class="s1">&#39;STE&#39;</span>     <span class="s1">&#39;PVC&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">        
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">Test</span> <span class="nb">set</span><span class="p">:</span>  
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="mf">0.9706</span><span class="p">,</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8547</span><span class="p">,</span> <span class="n">Auc</span><span class="p">:</span> <span class="mf">0.9666</span><span class="p">,</span> <span class="n">Threshold</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">Test_loss</span><span class="p">:</span> <span class="mf">0.1813</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.9797&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9782&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9913&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9738&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9506&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9549&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9593&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9913&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9564&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">F1s</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.9028&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9388&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8846&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9511&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8132&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7207&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8391&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8500&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7917&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">Validate</span> <span class="nb">set</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="mf">0.9596</span><span class="p">,</span> <span class="n">F1</span><span class="p">:</span> <span class="mf">0.8105</span><span class="p">,</span> <span class="n">Auc</span><span class="p">:</span> <span class="mf">0.9657</span><span class="p">,</span> <span class="n">Threshold</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">Vali_loss</span><span class="p">:</span> <span class="mf">0.2111</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">F1s</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.8750&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9333&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9787&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9016&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6989&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6504&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7545&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6818&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8201&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">Train</span><span class="p">[</span><span class="mi">650</span>        <span class="mi">1099</span>      <span class="mi">212</span>       <span class="mi">1675</span>      <span class="mi">826</span>       <span class="mi">554</span>       <span class="mi">782</span>       <span class="mi">198</span>       <span class="mi">629</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="n">Acc</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;0.9738&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9767&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9985&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9476&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9185&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9374&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9403&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9796&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9636&#39;</span><span class="p">]</span>
</span></span></code></pre></div><p><em><strong>CPSC</strong></em>  - <strong>æ‚£è€…é—´</strong></p>
<p>è®­ç»ƒé›†åŒ…å« 6,877 ä¸ªï¼ˆå¥³æ€§ï¼š3178 ä¸ª;ç”·æ€§ï¼š3699 ä¸ªï¼‰12 å¯¼è”å¿ƒç”µå›¾è®°å½•ï¼ŒæŒç»­æ—¶é—´ä» 6 ç§’åˆ° 60 ç§’ä¸ç­‰ã€‚</p>
<p><img alt="image-20240511213646105" loading="lazy" src="http://verification.longcoding.top/FhIixT4TQjVJ9B1r2ZEnuln2pA5b"></p>
<p>è®ºæ–‡ä¸­æ˜¯ 1-8 è®­ç»ƒï¼›9 éªŒè¯ï¼›10 æµ‹è¯•ï¼›</p>
<p><em><strong>PTB-XL</strong></em>  - æ‚£è€…é—´</p>
<p>åŒ…å«æ¥è‡ª 18885 å 10 ç§’é•¿åº¦æ‚£è€…çš„ 21837 ä¸ªä¸´åºŠ 12 å¯¼è”å¿ƒç”µå›¾</p>
<p><img alt="image-20240511214058996" loading="lazy" src="http://verification.longcoding.top/FiBLlDeJjXN_q5PJnTh5NOaZXFEL"></p>
<p>â­ ç‰¹å®šæ‚£è€…çš„æ‰€æœ‰è®°å½•éƒ½åˆ†é…ç»™åŒä¸€æŠ˜ã€‚æŠ˜ 9 å’Œ 10 ä¸­çš„è®°å½•è‡³å°‘ç»è¿‡ä¸€æ¬¡äººå·¥è¯„ä¼°ï¼Œå› æ­¤å…·æœ‰ç‰¹åˆ«é«˜çš„æ ‡ç­¾è´¨é‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ 1-8 æŠ˜ ä½œä¸ºè®­ç»ƒé›†ï¼ŒæŠ˜å  9 ä½œä¸ºéªŒè¯é›†ï¼ŒæŠ˜å  10 ä½œä¸ºæµ‹è¯•é›†ã€‚</p>
<p><em><strong>Chapman-Shaoxin ECG Data</strong></em>  - æ‚£è€…é—´</p>
<p>åŒ…å« 10,646 åæ‚£è€…çš„ 12 å¯¼è”å¿ƒç”µå›¾ï¼Œé‡‡æ ·ç‡ä¸º 500 Hzï¼Œ11 ç§å¸¸è§å¿ƒå¾‹</p>
<p><img alt="image-20240513120253717" loading="lazy" src="http://verification.longcoding.top/Fgm3PAj0mAdD6TRZ_ykzlYyXSOMJ"></p>
<p>ç±»åˆ«åˆ†ç»„ï¼š</p>
<p><img alt="image-20240513195732015" loading="lazy" src="http://verification.longcoding.top/Fk_uTCl4aFYJqgBY6Be9yjLslIL_"></p>
<p><strong>Result</strong></p>
<table>
  <thead>
      <tr>
          <th>dataset</th>
          <th>Task</th>
          <th>F1_macro</th>
          <th>AUC_macro</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>CPSC</td>
          <td>arrhythmia | multi-label</td>
          <td>0.8547</td>
          <td>0.9666</td>
      </tr>
      <tr>
          <td>PTB-XL</td>
          <td>arrhythmia | multi-label</td>
          <td>0.5370</td>
          <td>0.9552</td>
      </tr>
  </tbody>
</table>
<table>
  <thead>
      <tr>
          <th>dataset</th>
          <th>Task</th>
          <th>AUC_macro</th>
          <th>F1_macro</th>
          <th>Accuracy</th>
          <th>Recall</th>
          <th>Precision</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>chapman</td>
          <td>arrhythmia | multi-class</td>
          <td>0.9966</td>
          <td>0.9660</td>
          <td>0.9699</td>
          <td>0.9652</td>
          <td>0.9671</td>
      </tr>
  </tbody>
</table>
<p>multi-label:  sigmoidè½¬0-1åŒºé—´ï¼Œç”¨<strong>é˜ˆå€¼</strong>è¿›è¡Œé¢„æµ‹å€¼äºŒå€¼åŒ–ï¼Œç”Ÿæˆæ ‡ç­¾</p>
<p>multi-class:  softmaxè½¬æ¦‚ç‡ï¼Œå–æ¦‚ç‡æœ€å¤§çš„ä¸‹æ ‡ä½œä¸ºé¢„æµ‹æ ‡ç­¾</p>
<p>æ•°æ®å¢å¼ºï¼š</p>
<ol>
<li>
<p>éšæœºmaskæŸå¯¼è”</p>
</li>
<li>
<p>éšæœºmaskæŸæ®µ(ä»…å¼€å¤´æˆ–ç»“å°¾)</p>
</li>
<li>
<p>å¢åŠ éšæœºå™ªå£°</p>
<p><em>æ²¡å•¥ç”¨</em></p>
</li>
</ol>
<hr>
<h2 id="æ±‡æ€»">æ±‡æ€»<a hidden class="anchor" aria-hidden="true" href="#æ±‡æ€»">#</a></h2>
<h3 id="å®éªŒç»“æœ">å®éªŒç»“æœ<a hidden class="anchor" aria-hidden="true" href="#å®éªŒç»“æœ">#</a></h3>
<img src="http://verification.longcoding.top/FlNas9rDgTfpFaQkuM2RTtL4qJGn" alt="image-20240603201428685" style="zoom:80%;" />
<p>1ï¸âƒ£ CNNï¼šä¼˜åŠ¿=&gt;å¼ºå¤§çš„æå–å±€éƒ¨æ¨¡å¼çš„èƒ½åŠ›ï¼› =&gt; æå‡ºå±€éƒ¨ç»†èŠ‚ï¼Œè¾¹ç¼˜ï¼Œçº¹ç†æ¨¡å¼ä¿¡æ¯ã€‚  â­ é«˜é¢‘ä¿¡æ¯</p>
<p>â€‹                  ä¸è¶³=&gt;éœ€è¦å †å å¾ˆæ·±ï¼Œæ„Ÿå—èŒƒå›´æ‰èƒ½å»¶ç”³åˆ°å…¨å±€ï¼› =&gt; æ„ŸçŸ¥å…¨å±€å¼±åŠ¿</p>
<p>2ï¸âƒ£ Transformerï¼š ä¼˜åŠ¿=&gt;å…¨å±€æ„Ÿå—é‡ï¼Œä¸å¤Ÿæ•´ä½“å¤–è²Œèƒ½åŠ›å¾ˆå¼º;                                              â­ ä½é¢‘ä¿¡æ¯</p>
<p>â€‹								  ä¸è¶³=&gt;çœ‹çš„å¤ªå¤šï¼Œå¹²æ‰°å¤ªå¤šï¼Œå¯¹å±€éƒ¨ç»†èŠ‚æ¨¡å¼æ•è·èƒ½åŠ›è¾ƒå¼±ã€‚</p>
<h3 id="æ¨¡å‹æ’å›¾">æ¨¡å‹æ’å›¾<a hidden class="anchor" aria-hidden="true" href="#æ¨¡å‹æ’å›¾">#</a></h3>
<ul>
<li><strong>BlockåŸºæœ¬ç»“æ„</strong></li>
</ul>
<img src="http://verification.longcoding.top/FrM-MsmNgETP653AMr5X6U3uZeqD" alt="image-20240603173800170" style="zoom:67%;" />
<ul>
<li><strong>InceptionNext</strong></li>
</ul>
<p><img alt="image-20240603173849448" loading="lazy" src="http://verification.longcoding.top/FnoK7APToyLRLSNOXXRpdQD5webA"></p>
<p><em>DConv: æ ¹æ®é€šé“åˆ†ç»„ï¼Œæ¯ç»„ä½¿ç”¨ä¸åŒå·ç§¯æ ¸å¤§å°çš„DWConv</em></p>
<ul>
<li><strong>InceptionMHSALinear</strong></li>
</ul>
<p><img alt="image-20240603140051484" loading="lazy" src="http://verification.longcoding.top/FjOQLnqM8UaLfoCO-p21jBmkb8my"></p>
<p><em>Local Block å’Œ Global Block çº¿æ€§æ‹¼æ¥</em></p>
<ul>
<li><strong>InceptionFormer</strong></li>
</ul>
<p><img alt="image-20240603140214408" loading="lazy" src="http://verification.longcoding.top/Fo31v6MWxV47NjR4fvosmD_-NzCh"></p>
<p><em>Local Block å’Œ Global Block äº¤å‰å †å è¿›è¡Œèåˆ</em></p>
<ul>
<li><strong>InceptionShuntSA</strong></li>
</ul>
<p><img alt="image-20240603163710962" loading="lazy" src="http://verification.longcoding.top/Fuv6HWHKdoVULmpy0H2qcFMfaK-C"></p>
<img src="http://verification.longcoding.top/Fk8GpNJFjqD7ISe9cjShaklzAOXx" alt="image-20240603163728815" style="zoom:80%;" />
<img src="http://verification.longcoding.top/Fp25ZJWBfu-R4-2-AZe_RoRAkYmg" alt="image-20240603163748074" style="zoom:80%;" />
<p><em>ä¸€åŠæ³¨æ„åŠ›å¤´æ‰§è¡Œç»†ç²’åº¦æ³¨æ„åŠ›ï¼Œå¦ä¸€åŠå¤´æ‰§è¡Œç²—ç²’åº¦æ³¨æ„åŠ›</em></p>
<ul>
<li><strong>InceptionHiLoSA</strong></li>
</ul>
<p><img alt="image-20240603172844194" loading="lazy" src="http://verification.longcoding.top/Fg2w7c8N-CkizyyzMEuICS2x0JKa"></p>
<img src="http://verification.longcoding.top/FomolO0EP8QM7lp00ZEgOwJgKP0F" alt="image-20240603172708413" style="zoom: 67%;" />
<p><em>ä¸€åŠæ³¨æ„åŠ›å¤´æ‰§è¡Œã€çª—å£çº§æ³¨æ„åŠ›ã€‘ï¼Œå¦ä¸€åŠå¤´æ‰§è¡Œã€æ± åŒ–æ³¨æ„åŠ›ã€‘</em></p>
<p>ğŸ§è¦è°ƒæ•´çª—å£å¤§å° ï¼</p>
<ul>
<li><strong>SandwichNet</strong></li>
</ul>
<img src="http://verification.longcoding.top/FvjbaounpDcp9XcvNUi0Xcctym7X" alt="image-20240603164045740" style="zoom:80%;" />
<ul>
<li>**InceptionFormer, M-DWConv åŠ å…¥å€’æ®‹å·®ç»“æ„ ** <em><strong>(Inverted residual block)</strong></em></li>
</ul>
<img src="http://verification.longcoding.top/Foj-NHXzzmFBZgXmB_JEIfmvb1Wc" alt="image-20240603202132653" style="zoom:50%;" />
<p><em>åœ¨å¤šå°ºåº¦DWConvå‰åµŒå…¥Conv1Ã—1 æ‰©å¼ é€šé“æ•°ï¼ŒååµŒå…¥Conv1Ã—1 è¿›è¡Œé™ç»´ã€‚</em></p>
<p><em><strong>é£æ ¼éå¸¸ç»Ÿä¸€</strong></em>  <em><strong>=&gt; ç®€å•</strong></em></p>
<ul>
<li><strong>SandwichProNet</strong></li>
</ul>
<img src="http://verification.longcoding.top/Fgs-6JEzvvush1Voc2ORJeK1KHtO" alt="image-20240611122337229" style="zoom:67%;" />
<ul>
<li>
<p><strong>Channel Mixer</strong>ï¼šGLUï¼Œ DW-FFN</p>
</li>
<li>
<p><strong>Token Mixer:</strong>  ç»†ç²’åº¦å±€éƒ¨ + ç²—ç²’åº¦å…¨å±€</p>
</li>
<li>
<p><strong>å †å æ–¹å¼</strong></p>
</li>
</ul>
<h2 id="æ•°æ®">æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®">#</a></h2>
<p><em><strong>Arrhythmia Task</strong></em></p>
<p><em>10s + 100Hz sampling rate</em></p>
<p><em><strong>PTB-XL  - Rhythm Task</strong></em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">[</span><span class="s1">&#39;AFIB&#39;</span><span class="p">,</span> <span class="s1">&#39;AFLT&#39;</span><span class="p">,</span> <span class="s1">&#39;BIGU&#39;</span><span class="p">,</span> <span class="s1">&#39;PACE&#39;</span><span class="p">,</span> <span class="s1">&#39;PSVT&#39;</span><span class="p">,</span> <span class="s1">&#39;SARRH&#39;</span><span class="p">,</span> <span class="s1">&#39;SBRAD&#39;</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;STACH&#39;</span><span class="p">,</span> <span class="s1">&#39;SVARR&#39;</span><span class="p">,</span> <span class="s1">&#39;SVTAC&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIGU&#39;</span><span class="p">]</span> 
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="o">-</span> <span class="mi">12</span> <span class="k">class</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err">[ 1362  66  74  266  22  695  573  15074  744  143  24  18]  # </span><span class="nc">Train</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">[</span> <span class="mi">152</span>    <span class="mi">7</span>   <span class="mi">8</span>   <span class="mi">28</span>   <span class="mi">2</span>   <span class="mi">77</span>   <span class="mi">64</span>   <span class="mi">1674</span>   <span class="mi">82</span>   <span class="mi">14</span>   <span class="mi">3</span>   <span class="mi">2</span><span class="p">]</span>  <span class="c1"># Test</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="n">Train</span><span class="p">:</span> <span class="mi">18932</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="n">Test</span> <span class="p">:</span> <span class="mi">2098</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="n">Total</span><span class="p">:</span> <span class="mi">21030</span>
</span></span></code></pre></div><p><em><strong>Chapman</strong></em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">[</span><span class="s1">&#39;AFIB&#39;</span><span class="p">,</span> <span class="s1">&#39;GSVT&#39;</span><span class="p">,</span> <span class="s1">&#39;SB&#39;</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">]</span> 
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="o">-</span> <span class="mi">4</span> <span class="k">class</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nc">Train</span> <span class="p">[</span><span class="mf">1996.</span> <span class="mf">2069.</span> <span class="mf">3498.</span> <span class="mf">2000.</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="n">Test</span>  <span class="p">[</span><span class="mf">222.</span>  <span class="mf">231.</span>  <span class="mf">389.</span>  <span class="mf">222.</span> <span class="p">]</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="n">Train</span><span class="p">:</span> <span class="mi">9563</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="n">Test</span> <span class="p">:</span> <span class="mi">1064</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="n">Total</span><span class="p">:</span> <span class="mi">10627</span>
</span></span></code></pre></div><p><em><strong>CPSC-2018</strong></em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">[</span><span class="s1">&#39;I-AVB&#39;</span>  <span class="s1">&#39;AF&#39;</span>  <span class="s1">&#39;LBBB&#39;</span>  <span class="s1">&#39;RBBB&#39;</span>  <span class="s1">&#39;NORM&#39;</span>  <span class="s1">&#39;PAC&#39;</span>  <span class="s1">&#39;STD&#39;</span>  <span class="s1">&#39;STE&#39;</span>  <span class="s1">&#39;PVC&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="o">-</span> <span class="mi">9</span> <span class="k">class</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nc">Train</span> <span class="p">[</span> <span class="mi">650</span> <span class="mi">1099</span> <span class="mi">212</span> <span class="mi">1675</span> <span class="mi">826</span> <span class="mi">554</span> <span class="mi">782</span> <span class="mi">198</span> <span class="mi">629</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="n">Test</span>  <span class="p">[</span>  <span class="mi">72</span>  <span class="mi">122</span>  <span class="mi">24</span>  <span class="mi">181</span>  <span class="mi">92</span>  <span class="mi">61</span>  <span class="mi">87</span>  <span class="mi">22</span>  <span class="mi">70</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="n">Train</span><span class="p">:</span> <span class="mi">6187</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="n">Test</span> <span class="p">:</span> <span class="mi">688</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="n">Total</span><span class="p">:</span> <span class="mi">6875</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://longcoding.top/tags/ecg/">ECG</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://longcoding.top/posts/learning/minibaseline_learning/">
    <span class="title">Â« Prev</span>
    <br>
    <span>DLåŸºå‡†æ¨¡å‹è®­ç»ƒä¼ªä»£ç </span>
  </a>
  <a class="next" href="http://longcoding.top/posts/learning/java_learning/">
    <span class="title">Next Â»</span>
    <br>
    <span>Javaå­¦ä¹ ç¬”è®°</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://longcoding.top/">LongCoding&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
